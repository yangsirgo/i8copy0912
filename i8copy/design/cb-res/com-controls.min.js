function echo() {
    alert("hello world")
}
define("default/javascripts/common/util", [], function (require, exports, module) {
    var _white_list = /^[【】（），；。：、‘’“”？《》——·;￥……！~=@#%`,;_/\?\{\}\[\]\!\$\^\*\(\)\+\.\|\-\u4e00-\u9fa5a-zA-Z0-9\s]+$/gi;
    String.prototype.toDate = function () {
        return new Date(this.replace(/-/g, "/"))
    }, Array.prototype.indexOf || (Array.prototype.indexOf = function (a) {
        for (var b = 0; b < this.length; b++)if (this[b] == a)return b;
        return -1
    });
    var _workflowInputVerify = function (a) {
        var b = {}, c = !1;
        return _white_list.lastIndex = 0, _white_list.test(a) && (c = !0), b.result = c, b.tips = '输入名带非法字符，只允许输入中英文,空格,数字,_."%@,：:', b
    }, util = function () {
        function _loadsinglejs(a, b) {
            var c = document.getElementsByTagName("head")[0], d = document.createElement("script");
            d.onload = d.onreadystatechange = d.onerror = function () {
                d && d.readyState && /^(?!(?:loaded|complete)$)/.test(d.readyState) || (d.onload = d.onreadystatechange = d.onerror = null, d.src = "", d.parentNode.removeChild(d), d = null, b && b())
            }, d.charset = "utf-8", d.src = a;
            try {
                c.appendChild(d)
            } catch (e) {
            }
        }

        function _loadjs(a, b) {
            if ("[object Array]" === Object.prototype.toString.call(a)) {
                this.suc = 0, this.len = a.length;
                for (var c = this, d = 0; d < a.length; d++)_loadsinglejs(a[d], function () {
                    if (c.suc++, c.suc == c.len)try {
                        b()
                    } catch (a) {
                    }
                })
            } else"string" == typeof a && _loadsinglejs(a, b)
        }

        function _sizeFormat(a) {
            for (var b = 0; Math.abs(a) >= 1024 && (a /= 1024, b++, 4 != b););
            return $units = new Array("Bytes", "KB", "MB", "GB", "TB"), $newsize = Math.round(a, 2), $newsize + $units[b]
        }

        function _dateConverter(a) {
            var b = a.replace(/\-/g, "/"), c = new Date(b), d = (1 == c.getHours().toString().length ? "0" + c.getHours().toString() : c.getHours().toString()) + ":" + (1 == c.getMinutes().toString().length ? "0" + c.getMinutes().toString() : c.getMinutes().toString()), e = c.getYear().toString().substr(1, 3) + "年" + (c.getMonth() + 1) + "月" + c.getDate() + "日 " + d;
            return e
        }

        var _setCookie = function (a, b, c) {
            if (_delCookie(a), !c)return void(document.cookie = a + "=" + encodeURIComponent(b) + ";path=/;");
            var d = new Date;
            d.setTime(d.getTime() + 24 * c * 60 * 60 * 1e3), document.cookie = a + "=" + encodeURIComponent(b) + ";path=/; expires=" + d.toGMTString()
        }, _setCookie2 = function (a, b, c) {
            if (_delCookie(a), !c)return void(document.cookie = a + "=" + encodeURIComponent(b) + ";path=/;");
            var d = new Date;
            d.setTime(d.getTime() + 1e3 * c), document.cookie = a + "=" + encodeURIComponent(b) + ";path=/; expires=" + d.toGMTString()
        }, _getCookie = function (a) {
            for (var b = document.cookie.split("; "), c = 0; c < b.length; c++) {
                var d = b[c].split("=");
                if (a == d[0])return decodeURIComponent(d[1])
            }
        }, _delCookie = function (a) {
            var b = new Date(2e3, 11, 10, 19, 30, 30);
            document.cookie = a + "= ; expires=" + b.toGMTString() + "; path=/"
        }, _toJsonString = function (a) {
            var b = typeof a;
            if ("object" != b || null === a)return "string" == b && (a = '"' + a + '"'), String(a);
            var c, d, e = [], f = a && a.constructor == Array;
            for (c in a)d = a[c], b = typeof d, "function" != b && ("string" == b ? d = '"' + d + '"' : "object" == b && null !== d && (d = _toJsonString(d)), e.push((f ? "" : '"' + c + '":') + String(d)));
            return (f ? "[" : "{") + String(e) + (f ? "]" : "}")
        }, _urlParamToJson = function (a, b) {
            a = a.replace(/^[^?=]*\?/gi, "").split("#")[0];
            var c = {};
            return a.replace(/(^|&)([^&=]+)=([^&]*)/g, function (a, b, d, e) {
                d in c ? c[d]instanceof Array ? c[d].push(e) : c[d] = [c[d], e] : c[d] = /\[\]$/.test(d) ? [e] : e
            }), b ? c[b] : c
        }, stringifyParam = function (a, b) {
            var c = "";
            return a instanceof String || a instanceof Number || a instanceof Boolean ? c += "&" + b + "=" + encodeURIComponent(a) : $.each(a, function (d) {
                var e = null == b ? d : b + (a instanceof Array ? "[" + d + "]" : "." + d);
                c += "&" + stringifyParam(this, e)
            }), c.substr(1)
        }, i8alert = function (a) {
            var b = 2e3, c = " #FF690E", d = "";
            a.type || (a.type = 1), 1 != a.type && (c = " #717276"), a.stype && (d = '<span class="lg_fm_close cl000 heit cur" style="font-size: 18px; padding: 0px 5px;">x</span>'), a.time && (b = a.time);
            var e = document.getElementById("js_lg_tp_div");
            if (e)e = $(document.getElementById("js_lg_tp_div")), e.html('<i class="lg_fm_' + a.type + '"></i>' + a.str + d); else {
                var f = '<div id="js_lg_tp_div" style="position:absolute; z-index:11111; left:50%; top:50%;font-size:12px;color:' + c + '; border:1px solid #CFD0D0; padding:4px 10px 5px 10px; background:#fff;box-shadow:2px 2px 2px -1px #C5C6C7; line-height:25px; display:none;"><i class="lg_fm_' + a.type + '"></i>' + a.str + d + "</div>";
                $("body").append(f), e = $(document.getElementById("js_lg_tp_div"))
            }
            if (e.css({
                    "margin-left": 0 - e.width() / 2,
                    "margin-top": 0 - e.height() / 2,
                    color: c,
                    position: "fixed"
                }), a.btnobj) {
                var g = a.btnobj.offset().left, h = a.btnobj.offset().top - e.outerHeight() - 10;
                0 > h && (h = 1);
                var i = "auto", j = $(window).width(), k = e.width();
                g > j - k && (g = "auto", i = 0), e.css({margin: 0, left: g, top: h, right: i, position: "absolute"})
            }
            return e.show(), a.stype ? void $(".lg_fm_close").click(function () {
                $(this).parent().hide()
            }) : void setTimeout(function () {
                e.hide(), a.cbk && a.cbk()
            }, b)
        }, formGuid = function (a) {
            if (a && 36 == a.length) {
                var b = new RegExp("[a-z|A-Z|0-9]{8}-[a-z|A-Z|0-9]{4}-[a-z|A-Z|0-9]{4}-[a-z|A-Z|0-9]{4}-[a-z|A-Z|0-9]{12}");
                return b.test(a)
            }
            return !1
        }, fnStringCut = function (a, b) {
            var c = a || "";
            return c.length < b ? a : c.substr(0, b - 2) + ".."
        }, replaceSpecial = function (a, b) {
            var c = new RegExp("[\\ ,\\。,\\`,\\~,\\!,\\@,\\#,\\$,\\%,\\^,\\+,\\*,\\&,\\\\,\\/,\\?,\\|,\\:,\\.,\\<,\\>,\\{,\\},\\(,\\),\\'',\\;,\\=,\"]", "gi");
            return a.replace(c, function (a) {
                return "\\" + a
            })
        }, i8closeloading = function () {
            $("#js_lg_tp_div").hide(), $("#fw_nomaskzhezhao").hide()
        }, oneDay = 864e5, oneHour = 36e5, oneMinute = 6e4, week = ["周一", "周二", "周三", "周四", "周五", "周六", "周日"], fMinuteHandle = function (a) {
            return 10 > a ? "0" + a : a
        }, fDayHandle = function (a) {
            return 10 > a ? "0" + a : a
        }, fDateHandle = function (a, b) {
            var c = null;
            if (b)if ("string" == typeof b)try {
                c = b.toDate()
            } catch (d) {
                c = new Date
            } else c = c || new Date;
            c = c || new Date;
            var e = null;
            try {
                e = a.toDate()
            } catch (d) {
                return void alert(d)
            }
            var f = c - e;
            return 0 >= f ? "刚刚" : f / oneDay >= 1 || Math.abs(c.getDate() - e.getDate()) >= 1 ? e.getFullYear() + "年" + (e.getMonth() + 1) + "月" + e.getDate() + "日 " + (e.getHours() + ":" + fMinuteHandle(e.getMinutes())) : f / oneHour > 1 ? "今天 " + e.getHours() + ":" + fMinuteHandle(e.getMinutes()) : f / oneMinute > 1 ? Math.ceil(f / oneMinute) + "分钟前" : "刚刚"
        }, _dateDiff = function (interval, date1, date2) {
            var objInterval = {D: 864e5, H: 36e5, M: 6e4, S: 1e3, T: 1};
            interval = interval.toUpperCase(), "Object" == typeof data1 && (date1 = date1.toDate(), date2 = date2.toDate());
            try {
                return Math.round((date2 - date1) / eval("(objInterval." + interval + ")"))
            } catch (e) {
                return e.message
            }
        }, fw_request = function (a) {
            var b = location.href.indexOf("#") > 0 ? location.href.substring(0, location.href.indexOf("#")) : location.href, c = b.substring(b.indexOf("?") + 1, b.length).split("&"), d = {};
            for (i = 0; j = c[i]; i++)d[j.substring(0, j.indexOf("=")).toLowerCase()] = j.substring(j.indexOf("=") + 1);
            var e = d[a.toLowerCase()];
            return "undefined" == typeof e ? "" : e
        }, _subString = function (a, b) {
            var c = /[^\x00-\xff]/g;
            if (a.replace(c, "mm").length <= b)return a;
            for (var d = Math.floor(b / 2), e = d; e < a.length; e++)if (a.substr(0, e).replace(c, "mm").length >= b)return a.substr(0, e) + "...";
            return a
        }, TxtBoxWarn = function (a) {
            var b = ["rgb(255,255,255)", "rgb(255,238,238)", "rgb(255,221,221)", "rgb(255,204,204)", "rgb(255,187,187)", "rgb(255,255,255)", "rgb(255,238,238)", "rgb(255,221,221)", "rgb(255,204,204)", "rgb(255,187,187)", "rgb(255,255,255)"], c = function (b) {
                var d = null;
                b.length > 0 ? d = setTimeout(function () {
                    a.css({"background-color": b.shift()}), c(b)
                }, 100) : clearTimeout(d)
            };
            c(b)
        }, _strFormat = function () {
            var a = arguments[0], b = arguments;
            return a ? a.replace(/\{(\d+)\}/gi, function (a, c) {
                var d = b[(0 | c) + 1];
                return null == d ? "" : d
            }) : ""
        }, _strLength = function (a) {
            for (var b = 0, c = 0; c < a.length; c++) {
                var d = a.charCodeAt(c);
                d >= 1 && 126 >= d || d >= 65376 && 65439 >= d ? b++ : b += 2
            }
            return b
        };
        window._alert = window.alert, window.alert = function (a) {
            i8alert({str: a})
        };
        var dateformat = function (a, b) {
            var c = new Date(a);
            return ("Invalid Date" == c || isNaN(c)) && (c = new Date(a.replace(/-/g, "/"))), c.format(b)
        };
        Date.prototype.format = function (a, b) {
            var c = ["日", "一", "二", "三", "四", "五", "六"], d = {
                "M+": this.getMonth() + 1,
                "d+": this.getDate(),
                "h+": this.getHours(),
                "m+": this.getMinutes(),
                "s+": this.getSeconds(),
                "q+": Math.floor((this.getMonth() + 3) / 3),
                S: this.getMilliseconds(),
                D: "cn" == b ? c[this.getDay()] : this.getDay()
            };
            /(y+)/.test(a) && (a = a.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length)));
            for (var e in d)new RegExp("(" + e + ")").test(a) && (a = a.replace(RegExp.$1, 1 == RegExp.$1.length ? d[e] : ("00" + d[e]).substr(("" + d[e]).length)));
            return a
        };
        var _HtmlUtil = {
            htmlEncodeByRegExp: function (a) {
                var b = "";
                return 0 == a.length ? "" : (b = a.replace(/&/g, "&amp;"), b = b.replace(/</g, "&lt;"), b = b.replace(/>/g, "&gt;"), b = b.replace(/ /g, "&nbsp;"), b = b.replace(/\'/g, "&#39;"), b = b.replace(/\"/g, "&quot;"))
            }, htmlDecodeByRegExp: function (a) {
                var b = "";
                return 0 == a.length ? "" : (b = a.replace(/&amp;/g, "&"), b = b.replace(/&lt;/g, "<"), b = b.replace(/&gt;/g, ">"), b = b.replace(/&nbsp;/g, " "), b = b.replace(/&#39;/g, "'"), b = b.replace(/&quot;/g, '"'))
            }
        }, _fLoadCss = function (a) {
            var b = document.getElementsByTagName("head")[0] || document.documentElement, c = document.createElement("link");
            c.rel = "stylesheet", c.type = "text/css", c.href = a, b.insertBefore(c, b.firstChild)
        }, faceLib = [["微笑", "weixiao.gif"], ["大笑", "ciya.gif"], ["花痴", "se.gif"], ["傲慢", "aoman.gif"], ["拜拜", "zaijian.gif"], ["悲剧", "ai.gif"], ["鄙视", "bishi.gif"], ["发呆", "fadai.gif"], ["闭嘴", "bizui.gif"], ["大哭", "daku.gif"], ["大骂", "zhouma.gif"], ["点头笑", "hanxiao.gif"], ["汗", "liuhan.gif"], ["惊恐", "jingkong.gif"], ["敲打", "qiaoda.gif"], ["抓狂", "zhuakuang.gif"], ["奋斗", "fengdou.gif"], ["鼓掌", "guzhang.gif"], ["打哈欠", "haqian.gif"], ["擦汗", "cahan.gif"], ["尴尬", "ganga.gif"], ["怒", "fanu.gif"], ["困", "kun.gif"], ["白眼", "baiyan.gif"], ["吃惊", "jingyan.gif"], ["哼", "nanguo.gif"], ["可怜", "kelian.gif"], ["泪", "liulei.gif"], ["害羞", "haixiu.gif"], ["坏笑", "huaixiao.gif"], ["左哼哼", "zuohenhen.gif"], ["右哼哼", "youhenhen.gif"], ["亲亲", "qinqin.gif"], ["吓", "xia.gif"], ["大兵", "dabin.gif"], ["酷", "ku.gif"], ["得意", "deyi.gif"], ["睡觉", "shui.gif"], ["疑问", "yiwen.gif"], ["偷笑", "touxiao.gif"], ["吐", "tu.gif"], ["调皮", "tiaopi.gif"], ["挖鼻屎", "koubi.gif"], ["无奈", "piezui.gif"], ["快哭了", "kuaikule.gif"], ["冷汗", "lenghan.gif"], ["可爱", "keai.gif"], ["糗大了", "qiudale.gif"], ["嘘", "xun.gif"], ["晕", "yun.gif"], ["阴险", "yinxian.gif"], ["委屈", "weiqu.gif"], ["美味", "jie.gif"], ["骷髅", "kulou.gif"], ["猪头", "zhutou.gif"], ["抱拳", "baoquan.gif"], ["胜利", "shengli.gif"], ["爱你", "aini.gif"], ["顶你", "qiang.gif"], ["弱", "ruo.gif"], ["不", "no.gif"], ["勾引", "gouying.gif"], ["握手", "woshou.gif"], ["拳头", "quantou.gif"], ["差劲", "chajing.gif"], ["好的", "ok.gif"], ["太阳", "taiyang.gif"], ["月亮", "yueliang.gif"]], faceBpath = i8_session.resHost + "default/images/face/", atUserFormate = function (a) {
            return a ? (a.length > 0 && (a = a.replace(/\$%\$([\w\-\,\u4E00-\ufa2d\.\|]+)\$%\$/g, function (a, b) {
                var c = b.split(","), d = c[2], e = '<a class="k-a" href="users/' + c[1] + '">@' + c[0] + "</a>";
                switch (d) {
                    case"1":
                        e = '<a class="k-g" href="group/home?id=' + c[1] + '">@' + c[0] + "</a>";
                        break;
                    case"2":
                        e = "<a>@" + c[0] + "</a>"
                }
                return e
            }), a = a.replace(/\[[\u4E00-\ufa2d]+\]/gi, function (a) {
                for (var b = 0; b < faceLib.length; b++) {
                    var c = a.replace(/[\[\]]/gi, "");
                    if (faceLib[b][0] == c)return '<img src="' + faceBpath + faceLib[b][1] + '" alt="' + c + '" />'
                }
                return a
            }), a = a.replace(/%\$%(\S+),(\w{6,7})%\$%/gi, function (a, b, c) {
                return b && c ? '<a href="http://i8xs.cn/' + c + '" target="_blank" title="' + b + '">http://i8xs.cn/' + c + "</a>" : a
            }), a = a.replace(/\[url="([\S^"]+)";txt="([^"]+)";target="([_\w]+)"\]/gi, function (a, b, c, d) {
                return b && c ? '<a href="' + b + '"  target="' + d + '">' + c + "</a>" : a
            }), a = a.replace(/#(.+?)#/g, function (a, b) {
                return '<a href="search?keyword=' + encodeURIComponent(b.replace(/<[^>]+\/?>/g, "")) + '#dynamic" target="_blank">#' + b.replace(/<[^>]+\/?>/g, "") + "#</a>"
            }), a = a.replace(/[\r|\n]/g, "<br/>")), a) : ""
        }, _getLastUrlName = function () {
            var a = window.location.href, b = a.substr(a.lastIndexOf("/") + 1, a.length).split("?")[0];
            return b
        }, _copyToClipboard = function (a) {
            if (window.clipboardData)window.clipboardData.clearData(), window.clipboardData.setData("Text", a); else if (-1 != navigator.userAgent.indexOf("Opera"))window.location = a; else if (window.netscape) {
                try {
                    netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")
                } catch (b) {
                    alert("被浏览器拒绝！\n请在浏览器地址栏输入'about:config'并回车\n然后将'signed.applets.codebase_principal_support'设置为'true'")
                }
                var c = Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);
                if (!c)return;
                var d = Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);
                if (!d)return;
                d.addDataFlavor("text/unicode");
                var e = new Object, e = (new Object, Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString)), f = a;
                e.data = f, d.setTransferData("text/unicode", e, 2 * f.length);
                var g = Components.interfaces.nsIClipboard;
                if (!c)return !1;
                c.setData(d, null, g.kGlobalClipboard)
            }
        }, _render_no_data = function (a, b) {
            var b = b || "没有找到任何数据~";
            $(a).html('<div class="noresult">                        <div class="no-resulticon noresult-icon"></div>                            <div class="noresult-title">' + b + "</div>                        </div>")
        };
        return {
            getLastUrlName: _getLastUrlName,
            atkkContent: atUserFormate,
            htmlUtil: _HtmlUtil,
            strLength: _strLength,
            bgFlicker: TxtBoxWarn,
            setCookies: _setCookie,
            setCookies2: _setCookie2,
            getCookies: _getCookie,
            delCookies: _delCookie,
            toJsonString: _toJsonString,
            urlParamToJson: _urlParamToJson,
            i8alert: i8alert,
            formateDate: fDateHandle,
            dateformat: dateformat,
            getUrlParam: fw_request,
            i8closeloading: i8closeloading,
            i8loadjs: _loadjs,
            dateDiff: _dateDiff,
            sizeFormat: _sizeFormat,
            dateConverter: _dateConverter,
            subString: _subString,
            strFormat: _strFormat,
            workflowInputVerify: _workflowInputVerify,
            workflowWhiteList: _white_list,
            stringCut: fnStringCut,
            loadCss: _fLoadCss,
            replaceSpecial: replaceSpecial,
            formGuid: formGuid,
            copyToClipboard: _copyToClipboard,
            render_no_data: _render_no_data,
            stringifyParam: stringifyParam
        }
    }();
    module.exports = util
}), define("default/javascripts/common/i8ui", [], function (require, exports) {
    function disabledcheck() {
        document.unselectable = "on", document.onselectstart = function () {
            return !1
        }, $("body").css("-moz-user-select", "none")
    }

    function huifucheck() {
        document.unselectable = "off", document.onselectstart = null, $("body").css("-moz-user-select", "text")
    }

    function accAdd(a, b) {
        var c, d, e;
        try {
            c = a.toString().split(".")[1].length
        } catch (f) {
            c = 0
        }
        try {
            d = b.toString().split(".")[1].length
        } catch (f) {
            d = 0
        }
        return e = Math.pow(10, Math.max(c, d)), (a * e + b * e) / e
    }

    function accSubtr(a, b) {
        var c, d, e, f;
        try {
            c = a.toString().split(".")[1].length
        } catch (g) {
            c = 0
        }
        try {
            d = b.toString().split(".")[1].length
        } catch (g) {
            d = 0
        }
        return e = Math.pow(10, Math.max(c, d)), f = c >= d ? c : d, ((a * e - b * e) / e).toFixed(f)
    }

    function accMult(a, b) {
        var c = 0, d = a.toString(), e = b.toString();
        try {
            c += d.split(".")[1].length
        } catch (f) {
        }
        try {
            c += e.split(".")[1].length
        } catch (f) {
        }
        return Number(d.replace(".", "")) * Number(e.replace(".", "")) / Math.pow(10, c)
    }

    function accDivide(arg1, arg2) {
        var r1, r2, t1 = 0, t2 = 0;
        try {
            t1 = arg1.toString().split(".")[1].length
        } catch (e) {
        }
        try {
            t2 = arg2.toString().split(".")[1].length
        } catch (e) {
        }
        with (Math)return r1 = Number(arg1.toString().replace(".", "")), r2 = Number(arg2.toString().replace(".", "")), r1 / r2 * pow(10, t2 - t1)
    }

    var maskArr = [], showMask = function () {
        var a = "js_msk" + (new Date).valueOf(), b = document.createElement("div");
        b.style.zIndex = 999 + maskArr.length, b.id = a, b.className = "ct-msk", maskArr.push(a), document.body.appendChild(b)
    }, closeMask = function () {
        if (maskArr && maskArr.length > 0) {
            var a = document.getElementById(maskArr.splice(maskArr.length - 1, 1)[0]);
            a && (a.style.display = "none")
        }
    }, expendUI = function (a, b) {
        if (a.length > 1)return void a.each(function (a, c) {
            expendUI($(c), b)
        });
        var b = $.extend({max_height: 116, height: 116, bottom: 10, right: 5}, b), c = a.height();
        c > b.height && (a.css("height", b.max_height + "px"), a.append($('<span class="expend-content-line" style="display:block;bottom:' + b.bottom + "px;right:" + b.right + 'px"><a class="expend-switch es-close" style="display: inline;"><span>展开</span><i></i></a></span>')).on("click", ".expend-switch", function () {
            var d = $(this);
            d.hasClass("es-close") ? (a.css("overflow", "visible"), a.animate({
                height: c + "px",
                "padding-bottom": "20px"
            }), d.removeClass("es-close").html("<span>收起</span><i></i>")) : (a.css("overflow", "hidden"), a.animate({
                height: b.max_height + "px",
                "padding-bottom": "0px"
            }), d.addClass("es-close").html("<span>展开</span><i></i>"))
        }))
    };
    exports.expendUI = expendUI;
    var _drag = function (a, b, c) {
        c = c || {}, $(a).on("mousedown", b, function (b) {
            disabledcheck();
            var d = $(a), e = b.pageX, f = b.pageY, g = parseInt(d.css("left")), h = parseInt(d.css("top"));
            Ileft = g, Itop = h, $("body").attr("onselectstart", "return false").css("user-select", "none"), $(document).mousemove(function (a) {
                Ileft = a.pageX - e + g, Itop = a.pageY - f + h;
                var b = c.imaxLeft || $(document).width() - d.outerWidth();
                if (c.imaxT || 0 == c.imaxT)if ($.isNumeric(parseInt(c.imaxT)))var i = parseInt(c.imaxT); else if ("parent" == c.imaxT)var i = d.parent().height() - d.height(); else var i = $(c.imaxT).height() - d.height();
                0 >= Ileft && (Ileft = 0), Ileft >= b && (Ileft = b), 0 >= Itop && (Itop = 0), (c.imaxT || 0 == i) && Itop >= i && (Itop = i), d.css({
                    top: Itop,
                    left: Ileft
                }), $(document).css("cursor", "move")
            }), $(document).mouseup(function () {
                c.upcbk && c.upcbk(), d.css({
                    top: Itop,
                    left: Ileft,
                    margin: 0
                }), $(document).css("cursor", "auto").unbind("mousemove").unbind("mouseup"), huifucheck()
            })
        })
    }, showbox = function (a) {
        var b = document.title, c = "", d = "";
        a.title && (c = '<span class="ct-close">×</span><div class="ct-ly-h1">' + a.title + "</div>"), a.isalert && (d = " is-alert");
        var e = document.createElement("div"), f = $("#js_fj_id").css("z-index") || 0;
        return e.style.zIndex = a.zIndex || 1e3 + maskArr.length, e.style.zIndex = parseInt(f) + parseInt(e.style.zIndex), e.id = (new Date).valueOf(), e.className = "ct-ly" + d, e.innerHTML = c + a.cont, document.body.appendChild(e), a.btnDom && (a.noMask = !0), a.noMask || showMask(), "function" == typeof a.success && a.success(), "function" == typeof a.error && a.error(), e.close = function () {
            (navigator.userAgent.indexOf("MSIE") >= 0 || navigator.userAgent.indexOf("Mozilla") >= 0) && $(e).find("iframe").remove(), $(e).remove(), a.noMask || closeMask(), $("#js_lg_tp_div").hide()
        }, e.againShow = function () {
            var a = $(e), b = $(window).width() / 2 - a.width() / 2, c = $(window).height() / 2 - a.height() / 2;
            a.css({top: c, left: b, margin: 0, position: "fixed"})
        }, e.position = function () {
            var b = $(e), c = $(window).width(), d = $(window).height(), f = $(window).scrollTop();
            location != top.location && (d = $(window.parent).height(), f = $(window.parent).scrollTop());
            var g = c / 2 - b.width() / 2, h = d / 2 - b.height() / 2 + f;
            a.btnDom && (g = a.btnDom.offset().left, g + b.width() >= c && (g = c - b.width()), $(window).scrollTop() > a.btnDom.offset().top - 100 && $(window).scrollTop(a.btnDom.offset().top - 100), h = a.btnDom.offset().top - b.height() - 5), 0 > h && (h = 0), 0 > g && (g = 0), b.css({
                left: parseInt(g),
                top: parseInt(h)
            })
        }, e.position(), $(e).on("click", ".ct-close,.gray96x32,.gray94x32,.btn-gray96x32", function () {
            $(this).hasClass("confirm") || e.close(), document.title = b
        }), document.title = b, _drag(e, ".ct-ly-h1"), e
    }, i8Confirm = function (a, b, c) {
        var d = (a.body ? a.body : "") + '<div class="ct-ly-msg">' + a.title + '</div><div class="tcenter"><span class="ct-confirm ct-ly-btn col-blue">确定</span><span class="ct-cancel ct-ly-btn col-f1">取消</span></div>', e = showbox({
            cont: d,
            btnDom: a.btnDom ? a.btnDom : null,
            title: a.bodytitle ? a.bodytitle : null
        });
        return $(e).delegate(".ct-confirm", "click", function () {
            b(e), e.close()
        }), $(e).delegate(".ct-cancel", "click", function () {
            c && c(), e.close()
        }), e
    }, i8alert = function (a) {
        $("div.is-alert").remove(), a.type || (a.type = 1);
        var b = '<div class="ct-alert ct-at-' + a.type + '"><i></i>' + a.title + "</div>", c = showbox({
            noMask: void 0 == a.noMask ? !0 : a.noMask,
            isalert: !0,
            btnDom: a.btnDom ? a.btnDom : null,
            cont: b,
            zIndex: 1e4
        });
        setTimeout(function () {
            c.close(), a.cbk && a.cbk()
        }, a.time || 2e3)
    }, i9alert = function (a) {
        var b = 2e3, c = " #FF690E", d = "";
        a.type || (a.type = 1), 1 != a.type && (c = " #717276"), a.stype && (d = '<span class="lg_fm_close"></span>'), a.time && (b = a.time);
        var e = document.getElementById("js_lg_tp_div");
        if (e)e = $(document.getElementById("js_lg_tp_div")), e.html('<i class="lg_fm_' + a.type + '"></i>' + a.title + d); else {
            var f = '<div id="js_lg_tp_div" style="position:absolute; z-index:10000; left:50%; top:50%;font-size:12px;color:' + c + '; padding:2px 2px;line-height:20px; display:none;"><i class="lg_fm_' + a.type + '"></i>' + a.title + d + "</div>";
            $("body").append(f), e = $(document.getElementById("js_lg_tp_div"))
        }
        if (e.css({
                "margin-left": 0 - e.width() / 2,
                "margin-top": 0 - e.height() / 2,
                color: c,
                position: "fixed"
            }), a.btnDom) {
            var g = a.btnDom.offset().left, h = a.btnDom.offset().top + a.btnDom.outerHeight() + 2;
            0 > h && (h = 1);
            var i = "auto", j = $(window).width(), k = e.width();
            g > j - k && (g = "auto", i = 0), e.css({margin: 0, left: g, top: h, right: i, position: "absolute"})
        }
        return e.show(), a.stype ? void $(".lg_fm_close").click(function () {
            $(this).parent().hide()
        }) : void setTimeout(function () {
            e.hide(), a.cbk && a.cbk()
        }, b)
    }, rightalert = function (a) {
        var b = 2e3, c = " #FF690E", d = "";
        a.type || (a.type = 1), 1 != a.type && (c = " #717276"), a.stype && (d = '<span class="lg_fm_close"></span>'), a.time && (b = a.time);
        var e = document.getElementById("js_lg_tp_div");
        if (e)e = $(document.getElementById("js_lg_tp_div")), e.html('<i class="lg_fm_' + a.type + '"></i>' + a.title + d); else {
            var f = '<div id="js_lg_tp_div" style="position:absolute; z-index:10000; left:50%; top:50%;font-size:12px;color:' + c + '; display:none;"><i class="lg_fm_' + a.type + '"></i>' + a.title + d + "</div>";
            $("body").append(f), e = $(document.getElementById("js_lg_tp_div"))
        }
        if (e.css({
                "margin-left": 0 - e.width() / 2,
                "margin-top": 0 - e.height() / 2,
                color: c,
                position: "fixed"
            }), a.btnDom) {
            var g = a.btnDom.offset().left + 5 + a.btnDom.outerWidth(), h = a.btnDom.offset().top;
            0 > h && (h = 1);
            var i = "auto", j = $(window).width(), k = e.width();
            g > j - k && (g = "auto", i = 0), e.css({
                margin: 0,
                left: g,
                top: h,
                right: i,
                position: "absolute",
                lineHeight: a.btnDom.outerHeight() + "px"
            })
        }
        return e.show(), a.stype ? void $(".lg_fm_close").click(function () {
            $(this).parent().hide()
        }) : void setTimeout(function () {
            e.hide(), a.cbk && a.cbk()
        }, b)
    }, listLoading = function (a) {
        a.html('<span style="line-height: 30px; text-align: center; display: block;">加载中...</span>')
    }, Ileft = 0, Itop = 0;
    !function (a) {
        a.fn.setSelect = function (b) {
            if (!(a(this).length <= 0)) {
                var b = b || {}, c = a(this).find("option"), d = a(this).html(), e = b.width || a(this).width(), f = "", g = "--请选择--", h = "", i = a(this).find("option:selected");
                b.showdef || (i.length > 0 ? (g = i.html(), f = a(this).val()) : c.length > 0 && (g = c[0].innerHTML, f = a(c[0]).attr("value")));
                var j = document.createElement("label");
                j.className = "i8-select " + b.newi8select, j.id = a(this).attr("id") || "i8select" + 1e17 * Math.random();
                var k = '<i class="i8-select-drop ' + b.dropstyle + '"></i><span class="i8-select-cked ' + b.ckedstyle + '" value="' + f + '">' + g + '</span><span class="i8-sel-options">', l = d.replace(/<option/g, "<em").replace(/<\/option>/g, "</em>").replace(/<OPTION/g, "<em").replace(/<\/OPTION>/g, "</em>");
                k += l + "</span>", j.innerHTML = k, a(this).replaceWith(j);
                var m = a(j);
                m.setValue(h), m.css({width: e, lineHeight: n + 2 + "px"}), b && b.style && m.attr("style", b.style);
                var n = m.outerHeight();
                m.find(".i8-sel-options").css("top", n), m.delegate("em", "click", function () {
                    var c = a(this);
                    return m.find("span.i8-select-cked").html(c.html()).attr("value", c.attr("value")), m.find("span.i8-sel-options").hide(), b && b.cbk && b.cbk(c), !1
                }), m.click(function () {
                    var b = a("label.i8-select");
                    return b.each(function () {
                        this != j && a(this).find("span.i8-sel-options").hide()
                    }), m.find("span.i8-sel-options").toggle(function () {
                        m.mCustomScrollbar && o(m)
                    }), !1
                });
                var o = function (a) {
                    var b = a.find('em[value="' + a.getValue() + '"]').index() * (n + 2);
                    a.find(".i8-sel-options").mCustomScrollbar("scrollTo", -b + "px")
                };
                return window.i8selbind || (window.i8selbind = !0, a(document).on("click", function () {
                    a("span.i8-sel-options").hide()
                })), this
            }
        }, a.fn.getValue = function () {
            return a(this).find("span.i8-select-cked").attr("value")
        }, a.fn.setValueByIndex = function (b) {
            var c = a(this).find("span.i8-select-cked"), d = a(this).find("span.i8-sel-options option").eq(b);
            c.attr("value", d.attr("value")).html(d.html())
        }, a.fn.setValue = function (b) {
            var c = !1, d = a(this).find("span.i8-select-cked");
            a(this).find("span.i8-sel-options em").each(function () {
                return a(this).attr("value") == b || a.trim(a(this).text()) == a.trim(b) ? (d.attr("value", a(this).attr("value")).html(a(this).html()), void(c = !0)) : void 0
            }), c || a(this).setValueByIndex(0)
        }, a.fn.setKey = function (b) {
            var c = a(this).find("span.i8-select-cked");
            a(this).find("span.i8-sel-options em").each(function () {
                return a.trim(a(this).html()) == b ? void c.attr("value", a(this).attr("value")).html(a(this).html()) : void 0
            })
        }, a.fn.updateSelect = function (b) {
            var c = b.showdef, d = b.$sel, e = b.data, f = b.key, g = b.value, h = '<i class="i8-select-drop newselecti"></i>';
            c && (h += '<span class="i8-select-cked ' + (b.ckedstyle || "") + '" value="">--请选择--</span>'), h += '<span class="i8-sel-options">', g ? a.each(e, function (a, b) {
                h += '<em value="' + b[f || g] + '">' + b[g] + "</em>"
            }) : a.each(e, function (a, c) {
                h += b.valueByIndex ? '<em value="' + a + '">' + c + "</em>" : '<em value="' + c + '">' + c + "</em>"
            }), d.html(h)
        }, a.fn.getKey = function () {
            return a(this).find("span.i8-select-cked").html()
        }, a.fn.getDom = function () {
            return a(this).find("span.i8-select-cked")
        }, a.fn.setTime = function (b) {
            return b = b || {}, this.addClass("date-bg checked"), this.on("click", function () {
                b.enableKeyboard = !1, WdatePicker(b);
                var c = a(this), d = c.val();
                c.val("").val(d)
            }), this.on("keydown", function () {
                return !1
            }), this
        }, a.fn.setTextArea = function (b) {
            var b = a.extend({l_height: "22", m_height: "36", color: "#f00", width: "698"}, b || {}), c = this.parent();
            c.hasClass("textareaparent") || (this.css({
                "line-height": b.l_height + "px",
                position: "absolute",
                height: "100%",
                width: b.width + "px"
            }), this.wrap('<div class="textareaparent rel" style="line-height: ' + b.l_height + 'px"></div>'), c = this.parent(), c.append('<div class="textplace" style="word-break: break-all; min-height: ' + b.m_height + "px; width:" + b.width + 'px;"></div>'), this.on("input propertychange", function () {
                var b = a(this);
                b.parent().find(".textplace").html(b[0].value)
            }))
        }
    }(jQuery), function (a) {
        a.fn.placeholder = function (b) {
            if (b)var c = !1; else var c = !/msie [6,7,8,9]/.test(navigator.userAgent.toLowerCase());
            return this.each(function () {
                var b = a(this);
                c || (b.placeVal = b.attr("placeholder"), b.val(b.placeVal), b.focus(function () {
                    b.val() == b.placeVal && b.val("")
                }).blur(function () {
                    ("" == b.val() || null == b.val()) && b.val(b.placeVal)
                }))
            }), this
        }
    }(jQuery), function (a) {
        a.fn.initAddAndDel = function (b) {
            var c = b.tpl, d = b.lineClass, e = b.addClass || ".add", f = b.delClass || ".del", g = a(this), h = (f.substr(1), function (a) {
                a.addClass("noadd"), a.length > 1 ? (a.last().removeClass("noadd"), a.first().removeClass("onlyone")) : a.last().addClass("onlyone")
            });
            h(g.find(d)), g.on("click", f, function () {
                (!b.beforedel || b.beforedel && 0 != b.beforedel(a(this))) && (a(this).parents(d).remove(), b.afterdel && b.afterdel(a(this)), h(g.find(d)))
            }), g.on("click", e, function () {
                (!b.beforeadd || b.beforeadd && 0 != b.beforeadd(a(this))) && (a(d).last().after(c), b.afteradd && b.afteradd(a(this)), h(g.find(d)))
            })
        }
    }(jQuery), function (a) {
        a.fn.scrollFixed = function (b, c) {
            function d() {
                var a = document.body.scrollTop || document.documentElement.scrollTop;
                a > g ? (e.removeClass("rel"), e.addClass("fix"), b && b.call(f)) : (e.removeClass("fix"), e.addClass("rel"), c && c.call(f))
            }

            var e = a(this), f = this, g = this.offset().top;
            return a(window).scroll(function () {
                d()
            }), d(), this
        }
    }(jQuery), function (a) {
        a.fn.i8searchEvent = function (b) {
            b = b || {}, b = a.extend({
                init: function () {
                },
                content: "body",
                doms: {
                    clearbtn: ".app_clear_txt_btn",
                    nodata: ".nodata",
                    searchdd: ".search-dd",
                    items: ".search-dd li a"
                },
                callbacks: {
                    onChange: function () {
                    }, onNoDate: function () {
                    }, onEmptyInput: function () {
                    }
                },
                htmls: {nodata: '<li class="nodata">未找到匹配的信息</li>'},
                keydownDelay: 60
            }, b);
            {
                var c = b.callbacks, d = this, e = b.doms, f = b.htmls;
                b.times, a(b.content).find(b.clearbtn)
            }
            for (var g in e)e[g] = a(b.content).find(e[g]);
            return e.searchdd.noItem = !1, f.nodata && e.searchdd.append(f.nodata), b.init(), d.keydown(function () {
                d.keyDownVal = d.val()
            }).keyup(function (a) {
                var f = a.keyCode;
                clearTimeout(d.timer), d.timer = setTimeout(function () {
                    return e.searchdd.noItem = !1, e.items.show(), d.keyUpVal = d.val(), "" == d.keyUpVal ? void c.onEmptyInput() : void(d.keyDownVal != d.keyUpVal && (c.onChange(f), e.searchdd.noItem && c.onNoDate()))
                }, b.keydownDelay)
            }), this
        }
    }(jQuery);
    var TxtBoxWarn = function (a) {
        var b = ["rgb(255,255,255)", "rgb(255,238,238)", "rgb(255,221,221)", "rgb(255,204,204)", "rgb(255,187,187)", "rgb(255,255,255)", "rgb(255,238,238)", "rgb(255,221,221)", "rgb(255,204,204)", "rgb(255,187,187)", "rgb(255,255,255)"], c = function (b) {
            var d = null;
            b.length > 0 ? d = setTimeout(function () {
                a.css({"background-color": b.shift()}), c(b)
            }, 100) : clearTimeout(d)
        };
        c(b)
    }, render_loading_mid_w = function (a) {
        var b = $(a);
        b.html("tbody" == b.get(0).tagName.toLowerCase() ? '<td colspan="999"><div class="ld-64-write" style="width:64px;height: 64px;"></div></td>' : '<div class="ld-64-write" style="width:64px;height: 64px;"></div>')
    }, render_loading = function (a, b) {
        var c = "";
        b && "write" != b && "gray" != b ? c = b : (b = b || "write", c = "ld-64-" + b);
        var d = c.split("-")[1], e = $(a);
        e.html("tbody" == e.get(0).tagName.toLowerCase() ? '<td colspan="999"><div class="' + c + '" style="width:' + d + "px;height: " + d + 'px;"></div></td>' : '<div class="' + c + '" style="width:' + d + "px;height: " + d + 'px;"></div>')
    }, render_no_data = function (a, b, c) {
        var b = b || "没有找到任何数据~", c = c || 999, d = $(a);
        d.html("tbody" == d.get(0).tagName.toLowerCase() ? '<tr><td colspan="' + c + '"><div class="noresult">                        <div class="no-resulticon noresult-icon"></div>                            <div class="noresult-title">' + b + "</div>                        </div></td></tr>" : '<div class="noresult">                        <div class="no-resulticon noresult-icon"></div>                            <div class="noresult-title">' + b + "</div>                        </div>"), $(a).attr("panl") ? $($(a).attr("panl")).html("") : $("#js_cement_page_panl").html("")
    }, showDielog = function (a, b, c) {
        var d = "height=" + c + ",width=" + b + ",top=50,left=50,toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,fullscreen=0";
        return window.showModalDialog ? window.open(a, "_blank", d) : window.open(a, window, d)
    };
    Number.prototype.accAdd = function (a) {
        return accAdd(this, a)
    }, Number.prototype.accSubtr = function (a) {
        return accSubtr(this, a)
    }, Number.prototype.accMult = function (a) {
        return accMult(this, a)
    }, Number.prototype.accDivide = function (a) {
        return accDivide(this, a)
    }, exports.showNoTitle = showbox, exports.showbox = showbox, exports.confirm = i8Confirm, exports.alert = i8alert, exports.formalert = i9alert, exports.loading = listLoading, exports.txterror = function (a, b) {
        i9alert({title: a, stype: !0, btnDom: b}), setTimeout(function () {
            $("#js_lg_tp_div").fadeOut(500)
        }, 3e3)
    }, exports.trterror = function (a, b) {
        rightalert({title: a, stype: !0, btnDom: b}), setTimeout(function () {
            $("#js_lg_tp_div").fadeOut(500)
        }, 3e3)
    }, exports.wlding32 = function () {
    }, exports.error = function (a, b) {
        i8alert({title: a, btnDom: b})
    }, exports.write = function (a) {
        i8alert({title: a, type: 2})
    }, exports.simpleWrite = function (a, b) {
        i8alert({title: a, type: 2, btnDom: b})
    }, exports.successMask = function (a) {
        i8alert({title: a, type: 2, noMask: !1})
    }, exports.simpleAlert = function (a, b) {
        i8alert({title: a, type: 1, btnDom: b})
    }, exports.render_loading_mid_w = render_loading_mid_w, exports.render_loading = render_loading, exports.render_no_data = render_no_data, exports.txtError = TxtBoxWarn, exports.showDielog = showDielog, exports.drag = _drag
}), define("default/javascripts/plugins/i8selector/fw_selector", [], function (a, b) {
    function c(a) {
        this.elem = a.elem, this.at = {}, this.opt = {}, this.searched = "", this.url = a.url, this.index = 0, this.timeout = 0, this.sType = a.sType || "user,", this.isAjax = !0, this.maxSelected = a.maxSelected || 100, this.readonly = a.readonly || !1, this.isEnable = a.isEnable || !0, this.model = a.model, this.sugListID = a.sugListID, this.selectedGuid = new Array, this.selectorExitsGuid = a.exitsGuid || [], this.seletedCallback = function () {
        }, this.deleteItemCallBack = function () {
        }, this.deleteItemBefore = function () {
        }, this.tWarp = a.tArea || "tWarp", this.convertUser = a.convertUser, this.showp = a.showPname, this.tipword = a.tipword || "可以@同事、部门、群组"
    }

    function d(a) {
        var b = /([^\/]+\/[^\/]+)$/g.exec(a);
        return b && 2 == b.length ? b[1] : a
    }

    Array.prototype.getIndex = function (a) {
        if (a)for (var b = 0; b < this.length; b++)if (this[b].ID == a || this[b].OrgID == a)return b;
        return -1
    }, Array.prototype.getUniqueList = function (a) {
        for (var b = 0; b < a.length; b++)-1 == this.getIndex(a[b].OrgID) && -1 == this.getIndex(a[b].ID) && this.push(a[b]);
        return this
    };
    var e = function (a) {
        $(document).on("focus", a.element, function () {
            var b = $(this);
            b.attr("disabled") || 1 == a.model && b.prev(".fw_ksninput_slted").attr("data-uid") || b.parents(".fw_ksntxtbox").addClass("ksner-focus")
        }).on("blur", a.element, function () {
            $(this).parents(".fw_ksntxtbox").removeClass("ksner-focus")
        }), a = i8_session.avip > 0 ? void 0 == a.isAbox || a.isAbox ? $.extend(a, {isAbox: !0}) : $.extend(a, {isAbox: !1}) : $.extend(a, {isAbox: !0}), a = $.extend({
            model: 1,
            element: null,
            width: 250,
            maxSelected: 100,
            isShowQuit: !1,
            readonly: !1,
            showIco: !1,
            isAbox: !1,
            selectPSNode: !1,
            convertUser: !1,
            showPname: !1,
            searchType: {org: !1, user: !0, grp: !1},
            loadItem: {
                itemReadonly: !1, items: [], loadedCallBack: function () {
                }
            },
            selectCallback: function () {
            },
            deleteCallback: function () {
            },
            deleteBefore: function () {
            }
        }, a);
        var b = null, d = {}, e = function (b) {
            if (1 == a.model || 2 == a.model)if ($("#" + b).parents(".fw_ksntxtbox").length > 0 && $("#" + b).parents(".fw_ksninput").length > 0)a.showIco ? $("#" + b).parents(".fw_ksninput").removeClass("fw_ksntxtbox_ksi1").removeClass("fw_ksntxtbox_ksi2").addClass("fw_ksntxtbox_ksi" + a.model) : $("#" + b).parents(".fw_ksninput").removeClass("fw_ksntxtbox_ksi1").removeClass("fw_ksntxtbox_ksi2"), $("#" + b).attr("placeholder") && ($("#" + b).parents(".fw_ksntxtbox").append($('<div class="fw_ksnplaceholder">' + $("#" + b).attr("placeholder") + "</div>")), $("#" + b).removeAttr("placeholder")), $("#" + b).parents(".fw_ksntxtbox").find(".fw_ksntxtbox_alert_ico").remove(), a.isAbox && $.detectAboxer($("#" + b).parents(".fw_ksntxtbox"), a); else if (0 == $("#" + b).parents(".fw_ksntxtbox").length || 0 == $("#" + b).parents(".fw_ksninput").length) {
                var d = "";
                a.showIco && (d = "fw_ksntxtbox_ksi" + a.model);
                var e = $('<div class="fw_ksninput ' + d + '"></div>').append($("#" + b).clone()), f = $('<div class="fw_ksntxtbox" style="width:' + a.width + (a.width > 0 ? "px;min-width:inherit" : "") + '"></div>').append(e).click(function () {
                    var a = $(this);
                    a.find("input").focus(), a.find(".fw_ksnplaceholder").hide()
                });
                $("#" + b).attr("placeholder") && f.append($('<div class="fw_ksnplaceholder">' + $("#" + b).attr("placeholder") + "</div>")), a.isAbox && $.detectAboxer(f, a), $("#" + b).parents(".fw_ksntxtbox,.fw_ksninput").length > 0 ? $("#" + b).parents(".fw_ksntxtbox,.fw_ksninput").replaceWith(f) : $("#" + b).replaceWith(f), $("#" + b).removeAttr("placeholder")
            }
            var g = "";
            for (var h in a.searchType)a.searchType[h] && (g += h + ",");
            var i = {
                elem: document.getElementById(b),
                url: "/webajax/i8plugins/selector/selectentity?r=t&status=" + (a.isShowQuit ? "2" : "1"),
                model: a.model,
                readonly: a.readonly,
                maxSelected: a.maxSelected,
                exitsGuid: a.exitsGuid,
                sType: g,
                showPname: a.showPname,
                convertUser: a.convertUser,
                sugListID: "mutiSugList" + Math.random().toString().replace(".", "")
            };
            0 == a.searchType.org && 0 == a.searchType.grp && (i.tipword = "可以@同事");
            var j = new c(i);
            return 0 == a.model ? (j.init(), j.seletedCallback = function (b, c, d, e) {
                return a.selectCallback(b, c, d, e)
            }) : (j.KIInit(), a.loadItem.items.length > 0 && (2 == a.model ? j.KISetDataLoad(a.loadItem.items, a.loadItem.loadedCallBack) : 1 == a.model && j.KISetDataLoad(a.loadItem.items.slice(0, 1), a.loadItem.loadedCallBack)), j.deleteItemCallBack = function (b) {
                a.deleteCallback(b, i.elem)
            }, j.deleteItemBefore = function (b) {
                return a.deleteBefore(b, i.elem)
            }, j.seletedCallback = function (b, c, d, e, f) {
                return a.selectCallback(b, c, d, e, f)
            }), a.readonly && i.elem.setAttribute("disabled", !0), $(i.elem).unbind("keyup").bind("keyup", _.debounce(function (b) {
                $(".fw_boxerContainer").remove(), 0 == a.model ? j.getAt(b) : (1 == a.model || 2 == a.model) && j.KIshow(b)
            }, 200)), $(i.elem).blur(function () {
                var a = $(this).parents(".fw_ksntxtbox");
                0 == a.find(".fw_ksninput_slted").length && $(this).parents(".fw_ksntxtbox").find(".fw_ksnplaceholder").show()
            }), $(i.elem).on("input propertychange", function () {
                var a = $(this), b = a.parents(".fw_ksntxtbox");
                (b.find(".fw_ksninput_slted").length > 0 || a.val().length > 0) && b.find(".fw_ksnplaceholder").hide()
            }), j
        };
        return a.element && (1 == $(a.element).length ? b = e($(a.element).attr("id")) : $(a.element).each(function () {
            var a = e($(this).attr("id"));
            a.selectedData = a.KISelectedData, a.loadData = a.KISetDataLoad, a.clearData = a.KIClearData, a.getAllselectedData = a.KIGetAllSelectedData, a.setAllselectedData = a.KISetSelectedData, d[this.id] = a
        })), new function () {
            this.getAllMutiKsnObjs = function () {
                return d
            }, this.getMultiKsnObjById = function (a) {
                return d[a]
            }, this.selectedData = function () {
                return null != b ? b.KISelectedData() : void 0
            }, this.loadData = function (a) {
                return null != b ? b.KISetDataLoad(a) : void 0
            }, this.clearData = function () {
                return null != b ? b.KIClearData() : void 0
            }, this.getAllselectedData = function () {
                return null != b ? b.KIGetAllSelectedData() : void 0
            }, this.setAllselectedData = function (a) {
                return null != b ? b.KISetSelectedData(a) : void 0
            }
        }
    };
    !function (a) {
        a.extend({
            JSONString: function (b) {
                var c = typeof b;
                if ("object" != c || null === b)return "string" == c && (b = '"' + b + '"'), String(b);
                var d, e, f = [], g = b && b.constructor == Array;
                for (d in b)e = b[d], c = typeof e, "function" != c && ("string" == c ? e = '"' + e + '"' : "object" == c && null !== e && (e = a.JSONString(e)), f.push((g ? "" : '"' + d + '":') + String(e)));
                return (g ? "[" : "{") + String(f) + (g ? "]" : "}")
            }, includePath: i8_session.resHost, include: function (b) {
                for (var c = "string" == typeof b ? [b] : b, d = 0; d < c.length; d++) {
                    var e = c[d].replace(/^\s|\s$/g, ""), f = e.split("."), g = f[f.length - 1].toLowerCase(), h = "css" == g, i = a.includePath + e;
                    if (h) {
                        if (0 == a("link[href='" + i + "']").length) {
                            var j = document.createElement("link");
                            j.rel = "StyleSheet", j.type = "text/css", j.href = i, j.media = "screen";
                            var k = document.getElementsByTagName("head")[0];
                            k.appendChild(j)
                        }
                    } else if (0 == a("script[src='" + i + "']").length) {
                        var l = document.createElement("script");
                        l.language = "javascript", l.type = "text/javascript", l.src = i;
                        var m = document.getElementsByTagName("head")[0];
                        m.appendChild(l)
                    }
                }
            }, detectAboxer: function (b, c) {
                var e = b, f = c.searchType, g = c.model, h = c.isShowQuit, i = a('<div class="fw_sboxer ' + (f.org || f.grp ? "ksn-muti-ico" : "fw_ksntxtbox_alert_ico") + '"></div>');
                i.click(function () {
                    function j(a) {
                        var b, d, e = {};
                        for (d in a) {
                            var f = a[d];
                            f.OrgID == f.RootID && (b = f.OrgID), e[f.OrgID] || (e[f.OrgID] = {}), e[f.OrgID].text = f.Name, e[f.OrgID].name = f.Name, e[f.OrgID].OrgID = f.OrgID, e[f.OrgID].isParent = !0, e[f.OrgID].RootID = f.RootID, e[f.OrgID].isExpand = !1, e[f.OrgID].fName = f.DisplayName, e[f.OrgID].nocheck = !c.searchType.org, e[f.OrgID].checked = c.selecteditems.getIndex(f.OrgID) >= 0, e[f.OrgID].nodeType = r.org ? "org" : "none", "children"in e[f.OrgID] || (e[f.OrgID].children = []), f.OrgID != f.ParentID && (e[f.ParentID] ? e[f.ParentID].children.push(e[f.OrgID]) : e[f.ParentID] = {children: [e[f.OrgID]]})
                        }
                        return e[b]
                    }

                    function k(b) {
                        for (var e = 0; e < b.length; e++) {
                            var f = "", h = {datatype: ""};
                            "user" == b[e].nodeType ? h.datatype = "user" : "org" == b[e].nodeType ? (h.datatype = "org", f = "[组织]", b[e].ID = b[e].OrgID, c.showPname && (b[e].name = b[e].fName || b[e].name)) : "grp" == b[e].nodeType && (h.datatype = "grp", f = "[群组]"), h.uname = b[e].name, h.uid = b[e].ID, h.email = b[e].email, h.headimg = b[e].headimg, h.department = b[e].department;
                            var i = '<img src="' + b[e].headimg + '" class="sbox-usr-img"/>';
                            "grp" == h.datatype || "org" == h.datatype && (i = '<span class="ksn-org-grp-ico ksn-org-pos"></span>');
                            var j = a('<span class="item_slted" title="' + b[e].name + '" tagid="' + b[e].ID + '" tagname="' + b[e].name + '" tagtype="' + b[e].nodeType + '" u-readonly="false" email="' + b[e].email + '" f-data="' + encodeURIComponent(a.JSONString(h)) + '">' + i + "<em>" + f + d(b[e].name) + "</em><a></a></span>");
                            if (1 == g && a("#con_selectorItemList span.item_slted").length > 0)return alert("单选框模式只能待选一项"), void a(this).removeData().addClass("disable_add");
                            a("#con_selectorItemList span[tagid='" + b[e].ID + "']", s).length > 0 ? a(this).removeData().addClass("disable_add") : (a("#con_selectorItemList", s).append(j), a(this).removeData().addClass("disable_add"))
                        }
                    }

                    a(".fw_boxerContainer").remove(), a(".fw_agtlist").hide(), a("input", e).val("");
                    var l = a('<div class="fw_boxerContainer"><div class="bc_loading"><img src="' + i8_session.resHost + 'default/images/32loading_white.gif"/><span>加载中...</span></div></div>').click(function () {
                        return e.find(".fw_ksnplaceholder").hide(), !1
                    });
                    a("body").append(l), l.drag();
                    var m = a(this).parents(".fw_ksntxtbox"), n = m.offset().left, o = m.offset().top + m.outerHeight(), p = a("body").width();
                    n + 592 > p && (n = p - 592 - 5), l.css({position: "absolute", "z-index": "9999", left: n, top: o});
                    var q = "", n = 0, r = {user: !0, org: !0};
                    f.org && f.user ? (q += '<span id="tab_span_org_select" style="left:0px">组织/同事</span>', n = 75) : f.org ? (q += '<span id="tab_span_org_select" style="left:0px">组织</span>', n = 47, r.user = !1) : f.user && (q += '<span id="tab_span_org_select" style="left:0px">同事</span>', n = 47, r.org = !1), f.grp && (q += '<span id="tab_span_grp_select" style="left:' + n + 'px">群组</span>');
                    var s = a('<div class="list_tab">' + q + '</div><div class="bcon_center"><div class="bcc_left"><div class="bcl_srchbox" style="display:none"><input type="text" class="searchkeyword" placeholder="姓名、拼音可检索"/><span class="span_act_search"></span><span class="span_act_delete"></span></div><div class="bcl_list"><div id="tab_list_container" class="list_details"><div id="tbls_org_box" style="display:none" class="tb_refence_box" dataload="0"><ul id="cropOrgTree" class="ztree"><img class="loading-ico" src="/default/images/32loading_white.gif"/></ul></div><div id="tbls_grp_box" style="display:none" class="tb_refence_box" dataload="0">加载中...</div><div id="tbls_clg_box" style="display:none" class="tb_refence_box" dataload="0">加载中...</div></div></div></div><div class="bcc_ctr"><input type="button" id="btn_addselecteditemforls" class="btn_add_item disable_add"/></div><div class="bcc_right"><div id="bccr_selectedItem_container" class="bccr_selectedItem"><div id="con_selectorItemList"></div></div></div></div>'), t = a('<div class="bcon_footer"><input type="button" class="btn_submit_select" value="确定"/>　<a class="btn_cancel_select">取消</a></div>');
                    l.empty().append(s).append(t).append(a('<a title="关闭" class="i8selector-popu-closed">×</a>').click(function () {
                        return l.remove(), c.cancelCbk && c.cancelCbk(), !1
                    })), b.click(function () {
                        return !1
                    }), window.document.onclick = function () {
                        a(".fw_boxerContainer").remove()
                    };
                    var u = function () {
                        a("#con_selectorItemList").height() > 240 && a("#bccr_selectedItem_container").mCustomScrollbar("update")
                    };
                    if (m.find(".fw_ksninput_slted").length > 0) {
                        var v = "";
                        m.find(".fw_ksninput_slted").each(function () {
                            var b = a.parseJSON(decodeURIComponent(a(this).attr("f-data").replace(/undefined/g, !1))), c = b.ureadonly ? b.ureadonly : !1, d = '<img src="' + b.headimg + '" class="sbox-usr-img"/>';
                            "grp" == b.datatype ? d = '<span class="ksn-org-grp-ico ksn-grp-pos"></span>' : "org" == b.datatype && (d = '<span class="ksn-org-grp-ico ksn-org-pos"></span>'), v += '<span class="item_slted" tagid="' + b.uid + '" tagname="' + b.uname + '" tagtype="' + b.datatype + '" u-readonly="' + c + '" f-data="' + a(this).attr("f-data") + '">' + d + "<em>" + b.uname + "</em>" + (b.ureadonly ? "" : "<a></a>") + "</span>"
                        }), a("#con_selectorItemList", s).append(v), a("#bccr_selectedItem_container").mCustomScrollbar({
                            theme: "dark-3",
                            axis: "y"
                        })
                    }
                    a(".btn_submit_select", l).click(function () {
                        var f = a(".bccr_selectedItem .item_slted", s);
                        if (0 == f.length)return void alert("未任何项选择！");
                        for (var h = "", j = [], k = 0; k < f.length; k++) {
                            var m = a(f[k]), n = "";
                            "user" == m.attr("tagtype") || ("org" == m.attr("tagtype") ? n = "[组织]" : "grp" == m.attr("tagtype") && (n = "[群组]"));
                            var o = m.attr("tagname");
                            -1 == o.indexOf(n) && (o = n + o);
                            var p = {
                                id: m.attr("tagid"),
                                type: m.attr("tagtype"),
                                name: m.attr("tagname"),
                                readonly: "true" == m.attr("u-readonly")
                            };
                            h += '<span class="fw_ksninput_slted" u-readonly="' + p.readonly + '" data-uid="' + p.id + '" data-type="' + p.type + '" f-data="' + m.attr("f-data") + '" title="' + p.name + '"><em>' + d(p.name) + "</em>" + (p.readonly ? "" : "<a></a>") + "</span>", j.push(p)
                        }
                        return a(".fw_ksninput_slted", e).remove(), e.find("input").before(h), e.find(".fw_ksnplaceholder").hide(), e.find("input").width(10), l.remove(), 1 == g ? (i.hide(), e.find("input").hide(), b.css("border", "solid 1px transparent"), c.selectCallback && c.selectCallback(f.attr("tagid"), f.attr("tagname"), f.attr("email"), f.attr("tagtype"), e.find("input")[0])) : c.selectCallback && c.selectCallback(j), !1
                    }), a(".btn_cancel_select", l).click(function () {
                        return l.remove(), c.cancelCbk && c.cancelCbk(), !1
                    });
                    var w = function () {
                        a.get("/webajax/i8plugins/selector/GetDefaultOrgTree", {}, function (b) {
                            if (b.Result) {
                                var d = {};
                                _.each(b.ReturnObject, function (a) {
                                    d[a.OrgID] = a
                                });
                                var e = [];
                                c.selecteditems = e;
                                var f = [];
                                a("#con_selectorItemList").find(".item_slted").each(function (b, c) {
                                    var d = a(c), g = d.attr("tagid");
                                    "true" == d.attr("u-readonly") && f.push(g), e.push({
                                        ID: d.attr("tagid"),
                                        OrgID: d.attr("tagid"),
                                        name: d.attr("tagname"),
                                        nodeType: d.attr("tagtype"),
                                        email: "",
                                        readonly: d.attr("u-readonly"),
                                        headimg: d.find("img").attr("src")
                                    })
                                });
                                var g, h = "," + f.join(",") + ",", i = j(d, h), k = {
                                    view: {
                                        selectedMulti: !1,
                                        txtSelectedEnable: !0,
                                        showIcon: C,
                                        fontCss: A
                                    }, check: {enable: 2 == c.model}, callback: {
                                        onExpand: function (a, b, c) {
                                            D(a, b, c, h)
                                        }, beforeClick: x, onClick: z, beforeCheck: y, onCheck: function () {
                                            return !1
                                        }
                                    }
                                };
                                g = a.fn.zTree.init(a("#cropOrgTree"), k, i), a("#tbls_org_box").attr("dataload", "1"), a("#tbls_org_box").mCustomScrollbar({
                                    theme: "dark-3",
                                    axis: "y"
                                }), a("#cropOrgTree_1_switch").trigger("click")
                            }
                        }, "json")
                    }, x = function (a, b) {
                        return 2 == c.model ? !1 : "无成员" == b.name ? !1 : b.isParent && f.org ? !0 : !b.isParent && f.user ? !0 : !1
                    }, y = function (b, d) {
                        function e(a) {
                            var b = a.getParentNode();
                            b && (f.checkNode(b, !1), e(b))
                        }

                        var f = a.fn.zTree.getZTreeObj(b);
                        if (c.selectPSNode) {
                            var g = f.getNodesByParam("nodeType", "org", d);
                            if (_.each(g, function (a) {
                                    f.checkNode(a, !d.checked)
                                }), d.checked)e(d); else {
                                var h = d.getParentNode();
                                if (h) {
                                    var i = f.getNodesByParam("nodeType", "org", h), j = _.where(i, {checked: !1});
                                    1 == j.length && (h.checked = !0), console.log(i)
                                }
                            }
                            return f.checkNode(d, !d.checked), c.selecteditems = f.getSelectedNodes(), z(b, d), !1
                        }
                        f.checkNode(d, !d.checked);
                        var k = "user" == d.nodeType ? d.ID : d.OrgID, l = c.selecteditems.getIndex(k);
                        return d.checked ? -1 == l && c.selecteditems.push(d) : c.selecteditems.splice(l, 1), z(b, d), !1
                    }, z = function () {
                        var b = a("#btn_addselecteditemforls", s), d = a.fn.zTree.getZTreeObj("cropOrgTree"), e = 2 == c.model ? d.getCheckedNodes() : d.getSelectedNodes();
                        e.length > 0 ? (b.removeClass("disable_add"), b.data()) : (b.addClass("disable_add"), b.removeData())
                    }, A = function (a, b) {
                        return "无成员" == b.name ? {color: "#ccc"} : void 0 != b.isManager && b.isManager ? {color: "#cc0000"} : void 0
                    }, B = function () {
                        a.get("/webajax/i8plugins/selector/myGroupAndPublicParam?pageIndex=1&pageSize=0&queryType=1", {rad: Math.random()}, function (b) {
                            if (b.Result) {
                                var c = b.List;
                                if (c.length > 0) {
                                    var d = a('<ul id="ul_cropGroupList" class="crop_grouplist"></ul>');
                                    for (var e in c) {
                                        var f = c[e].Item1;
                                        if (f && f.ID && f.Name) {
                                            var g = a('<li><div class="crop_grp_ico"><img src="' + f.Icon + '?imageView2/1/w/30/h/30" /></div><div class="crop_text"><span class="crop_grp_name_txt" headimg="' + f.Icon + '" dataid="' + f.ID + '">' + f.Name + "</span></div></li>").click(function () {
                                                if (a(this).attr("class"))a(this).removeClass("liselected"), a("#btn_addselecteditemforls").addClass("disable_add").removeData(); else {
                                                    a(this).parent().find("li").removeClass("liselected"), a(this).addClass("liselected"), a("#btn_addselecteditemforls").removeClass("disable_add");
                                                    var b = {
                                                        ID: a(".crop_grp_name_txt", this).attr("dataid"),
                                                        headimg: a.trim(a(".crop_grp_name_txt", this).attr("headimg")),
                                                        name: a.trim(a(".crop_grp_name_txt", this).text()),
                                                        nodeType: "grp"
                                                    };
                                                    a("#btn_addselecteditemforls").data(b)
                                                }
                                            });
                                            d.append(g)
                                        }
                                    }
                                    a("#tbls_grp_box").empty().append(d), a("#ul_cropGroupList").height() > 190 && a("#tbls_grp_box").mCustomScrollbar({
                                        theme: "dark-3",
                                        axis: "y"
                                    }), a("#ul_cropGroupList").attr("dataload", "1")
                                }
                            }
                        }, "json")
                    }, C = function (a, b) {
                        return !b.noIco
                    };
                    Array.prototype.removeNodeByKeyValue = function (a, b) {
                        for (var c = [], d = 0; d < this.length; d++) {
                            var e = this[d];
                            e[a] != b && c.push(e)
                        }
                        return c
                    };
                    var D = function (b, d, e, f) {
                        if (!e.isExpand && r.user)a.post("/webajax/i8plugins/selector/GetOrgPersonsInfo", {
                            orgID: e.OrgID,
                            isOnlyContract: !1,
                            includeLowerOrgUser: !1,
                            pageSize: 1e3
                        }, function (b) {
                            if (b.Result) {
                                var d = a.fn.zTree.getZTreeObj("cropOrgTree"), g = _.pluck(b.ReturnObject.Result, "Item1");
                                if (h || (g = g.removeNodeByKeyValue("Status", "1")), 0 == g.length) {
                                    var i = [{name: "无成员", nodeType: "none", noIco: !0, nocheck: !0}];
                                    d.addNodes(e, i)
                                } else {
                                    for (var j = g, k = [], l = 0; l < j.length; l++) {
                                        var m = j[l];
                                        k.push({
                                            name: m.Name + (1 == m.Status ? "(已离职)" : ""),
                                            department: m.OrgName,
                                            ID: m.PassportID,
                                            headimg: m.HeadImage,
                                            nodeType: "user",
                                            isManager: !1,
                                            email: m.Email,
                                            checked: c.selecteditems.getIndex(m.PassportID) >= 0,
                                            chkDisabled: f.search("," + m.PassportID + ",") >= 0
                                        })
                                    }
                                    d.addNodes(e, k)
                                }
                                e.isExpand = !0
                            }
                        }, "json"); else if (!r.user)for (var g = a.fn.zTree.getZTreeObj("cropOrgTree"), i = 0; i < e.children.length; i++)0 == e.children[i].children.length && g.expandNode(e.children[i], !0, !0, !0)
                    };
                    a("#btn_addselecteditemforls", s).click(function () {
                        if (!(a(this).attr("class").indexOf("disable_add") > -1)) {
                            2 == c.model && a("#con_selectorItemList").find(".item_slted[tagtype=user]:not([u-readonly=true]),.item_slted[tagtype=org]:not([u-readonly=true])").remove();
                            var b = a.fn.zTree.getZTreeObj("cropOrgTree"), d = c.selecteditems.getUniqueList(1 == c.model ? b.getSelectedNodes() || [] : b.getCheckedNodes() || []);
                            if (c.selectPSNode) {
                                var e = _.where(d, {nodeType: "org"});
                                e = _.sortBy(e, "level");
                                for (var f = 0; f < e.length; f++) {
                                    var g = e[e.length - 1 - f], h = g.parentTId, i = _.where(e, {tId: h});
                                    g.deprecated = i.length > 0 ? !0 : !1
                                }
                                d = _.where(e, {deprecated: !1})
                            }
                            var j = a(this).data();
                            if (j.name && j.nodeType && j.ID && d.push({
                                    name: j.name,
                                    nodeType: j.nodeType,
                                    ID: j.ID,
                                    headimg: j.headimg,
                                    department: j.department
                                }), d.length > 0) {
                                b && b.cancelSelectedNode(), a("#ul_cropGroupList .liselected").length > 0 && a("#ul_cropGroupList li").removeClass("liselected");
                                var l = a("#con_selectorItemList span").length + d.length;
                                if (l > c.maxSelected)return void alert("已到达最大可选数了");
                                if (c.convertUser) {
                                    var m = [], n = [], o = [];
                                    _.map(d, function (a) {
                                        "org" == a.nodeType ? n.push(a.OrgID) : "grp" == a.nodeType ? m.push(a.ID) : o.push(a)
                                    }), m.length > 0 || n.length > 0 ? a.get("/webajax/i8plugins/selector/getMultiGroupsPersons", {
                                        isQuit: c.isShowQuit,
                                        pindex: 0,
                                        psize: 0,
                                        grpIDs: m.join(";")
                                    }, function (a) {
                                        a.Result && _.each(a.List, function (a) {
                                            d.push({
                                                ID: a.PassportID,
                                                OrgID: "",
                                                department: a.department,
                                                email: a.Email,
                                                headimg: a.HeadImage,
                                                name: a.Name,
                                                nodeType: "user",
                                                readonly: "false"
                                            })
                                        })
                                    }, "json").then(function () {
                                        a.get("/webajax/i8plugins/selector/getMultiOrgPersons", {
                                            orgs: n.join(";"),
                                            index: 0,
                                            size: 0
                                        }, function (a) {
                                            a.Result && _.each(a.List, function (a) {
                                                d.push({
                                                    ID: a.PassportID,
                                                    OrgID: "",
                                                    department: a.department,
                                                    email: a.Email,
                                                    headimg: a.HeadImage,
                                                    name: a.Name,
                                                    nodeType: "user",
                                                    readonly: "false"
                                                })
                                            }), d = _.where(d, {nodeType: "user"}), d = d.concat(o), d = _.uniq(d, !0, function (a) {
                                                return a.ID
                                            }), k(d)
                                        }, "json")
                                    }) : k(o)
                                } else k(d);
                                u()
                            }
                        }
                    }), a(".bccr_selectedItem", s).bind("click", function (b) {
                        if ("A" == a(b.target)[0].tagName) {
                            var d = a.fn.zTree.getZTreeObj("cropOrgTree"), e = a(b.target).parents(".item_slted"), f = e.attr("tagid");
                            c.selecteditems.splice(c.selecteditems.getIndex(f), 1);
                            var g = "org" == e.attr("tagtype") ? d.getNodesByParam("OrgID", f, null) : d.getNodesByParam("ID", f, null);
                            g && g.length > 0 && d.checkNode(g[0], !1), e.remove(), u()
                        }
                    });
                    var E = a(".list_tab span", l)[0];
                    E.className = "activetab", "tab_span_org_select" == E.id ? (a("#tbls_org_box").show(), w()) : "tab_span_grp_select" == E.id ? (a("#tbls_grp_box").show(), B()) : (E.id = "tab_span_clg_select") && a("#tbls_clg_box").show(), a(".list_tab span", l).click(function () {
                        a(this).attr("class") || (a(".list_tab span", l).removeClass("activetab"), a(this).addClass("activetab"), a(".tb_refence_box", l).hide(), "tab_span_org_select" == a(this).attr("id") ? (a("#tbls_org_box").show(), "1" != a("#tbls_org_box").attr("dataload") && w()) : "tab_span_grp_select" == a(this).attr("id") ? (a("#tbls_grp_box").show(), "1" != a("#tbls_grp_box").attr("dataload") && B()) : "tab_span_clg_select" == a(this).attr("id") && (a("#tbls_clg_box").show(), "1" != a("#tbls_clg_box").attr("dataload")))
                    }), a(".span_act_search", l).click(function () {
                        var b = a(".searchkeyword", l).val();
                        b.length > 0 ? (a(".span_act_search", l).hide(), a(".span_act_delete", l).show()) : alert("输入搜索关键词!")
                    }), a(".span_act_delete", l).click(function () {
                        a(".searchkeyword", l).val(""), a(this).hide(), a(".span_act_search", l).show()
                    }), a(".searchkeyword", l).change(function () {
                        a.trim(a(this).val().length > 0)
                    })
                }), b.append(i)
            }
        })
    }(jQuery), c.prototype = {
        getCursor: function () {
            var a = {start: 0, end: 0, text: ""};
            if ("number" == typeof this.elem.selectionStart)a.start = this.elem.selectionStart, a.end = this.elem.selectionEnd, a.text = this.elem.value.substring(0, this.elem.selectionStart); else if (document.selection) {
                var b = document.selection.createRange(), c = document.body.createTextRange();
                for (c.moveToElementText(this.elem), a.text = b.text, a.bookmark = b.getBookmark(), i = 0; c.compareEndPoints("StartToStart", b) < 0 && 0 !== b.moveStart("character", -1); i++)"\r" == this.elem.value.charAt(i) && i++;
                a.start = i, a.end = a.text.length + a.start, a.text = this.elem.value.substring(0, i)
            }
            return a
        }, setCursor: function (a, b, c) {
            if (this.elem.setSelectionRange)this.elem.setSelectionRange(b, c); else if (this.elem.createRange) {
                var d = this.elem.createRange();
                this.elem.value.length == rangeData.start ? (d.collapse(!1), d.select()) : (d.moveToBookmark(rangeData.bookmark), d.select())
            }
        }, add: function (a, b, c, d, e, f, g) {
            $(this.elem).is(":hidden") || $(this.elem).attr("disabled") || this.elem.focus();
            var h;
            if (null != this.seletedCallback && this.seletedCallback(e, b, f, g), this.elem.setSelectionRange) {
                _tValue = this.elem.value;
                var i = c - d, j = i + b.length, k = _tValue.substring(0, i) + b + " " + _tValue.substring(c, this.elem.value.length);
                this.elem.value = k, this.setCursor(this.elem, j + 1, j + 1)
            } else this.elem.createTextRange && (h = document.selection.createRange(), h.moveStart("character", -d), h.text = b + " ")
        }, getAt: function (a) {
            var b = this.getCursor(), c = this, d = _value = b.text.replace(/\r/g, ""), e = /@[^@\s]{0,20}$/g;
            if (_value.indexOf("@") >= 0 && _value.match(e)) {
                {
                    var f = b.start, g = _value.match(e)[0];
                    new RegExp("^" + g + ".*$", "m")
                }
                _value = _value.slice(0, f), /^@[a-zA-Z0-9\u4e00-\u9fa5_]*$/.test(g) && !/\s/.test(g) ? (this.at.m = g = g.slice(1), this.at.l = _value.slice(0, -g.length - 1), this.at.r = d.slice(f - g.length, d.length), this.at.pos = f, this.at.len = g.length, c.showTip(a)) : this.hiddenTip()
            } else this.hiddenTip()
        }, uniqAtList: function () {
            var a = /@[^@\s]{0,20}/g, b = $(this.elem).val(), c = b.match(a);
            return c = c.concat(c).uniq()
        }, getExitsGuids: function () {
            for (var a = "1", b = this, c = b.uniqAtList().toString(), d = c.split(","), e = 0; e < d.length; e++) {
                var f = "@" == d[e] ? "" : b.getGuidByName(d[e]);
                null != f && void 0 != f && f.indexOf("@") > 10 && (a += "|" + b.getGuidByName(d[e]).split("@")[0])
            }
            return a
        }, selectedGuidAdd: function (a) {
            $(this.elem).attr("data-guids", a)
        }, getGuidByName: function (a) {
            if (this.selectedGuid.length > 0)for (var b = 0; b < this.selectedGuid.length; b++)if (this.selectedGuid[b].indexOf(a) > -1)return this.selectedGuid[b]
        }, format: function (a) {
            var b = {
                "<": "&lt;",
                ">": "&gt;",
                '"': "&quot;",
                "\\": "&#92;",
                "&": "&amp;",
                "'": "&#039;",
                "\r": "",
                "\n": "<br>",
                " ": "&nbsp;"
            }, c = /<|>|\'|\"|&|\\|\r\n|\n| /gi;
            return a.replace(c, function (a) {
                return b[a]
            })
        }, strSub: function (a, b) {
            if (!a || !b)return "";
            var c = 0, d = 0, e = "";
            for (d = 0; d < a.length; d++) {
                if (a.charCodeAt(d) > 255 ? c += 2 : c++, c > b)return e;
                e += a.charAt(d)
            }
            return a
        }, init: function () {
            var a = $("body");
            $(".ksnsugctl").remove();
            var b = $("<div id='" + this.tWarp + "' class='ksnsugctl'></div>"), c = $('<div id="' + this.sugListID + "\" style='display:none' class='fw_agtlist ksnsugctl'></div>");
            a.append(b), a.append(c);
            var d = $(this.elem).offset().left + "px", e = $(this.elem).offset().top + "px", f = $(this.elem).outerWidth() + "px", g = $(this.elem).outerHeight() + "px", h = $(this.elem).css("line-height"), i = "position:absolute;overflow:hidden;z-index:-9999;line-height:" + h + ";width:" + f + ";height:" + g + ";left:" + d + ";top:" + e;
            b.attr("style", i), this.inset()
        }, showTip: function (a) {
            var b = this, c = this.sugListID, d = b.getExitsGuids();
            a = a || event;
            var e = a.keyCode;
            (0 == b.timeout || 13 == e) && (b.timeout = 1, $.ajax({
                async: !0,
                url: b.url + "&k=" + encodeURIComponent(b.at.m) + "&g=" + d + "&t=" + b.sType + "&s=1",
                type: "get",
                dataType: "json",
                data: {},
                success: function (a) {
                    if (b.timeout = 0, a.Result) {
                        for (var d = _.union(a.ReturnObject.user, a.ReturnObject.grp, a.ReturnObject.org), e = "", f = 0; f < d.length; f++)void 0 != b.ddtemplate(d[f]) && (e += b.ddtemplate(d[f]));
                        e.length > 0 ? ($("#" + c).show().html("<dl><dt>" + b.tipword + "</dt>" + e + "</dl>"), b.searched = b.at.m, b.buidTip()) : b.hiddenTip()
                    } else b.hiddenTip()
                }
            }))
        }, buidTip: function () {
            var a = this, b = this.sugListID;
            $("#" + this.tWarp).empty();
            var c = "<span>" + this.format(this.at.l) + "</span><cite>@</cite><span>" + this.format(this.at.r) + "</span>";
            $("#" + this.tWarp).html(c);
            var d = $("#" + this.tWarp + " cite").offset().left + "px", e = $("#" + this.tWarp + " cite").offset().top + parseInt($("#" + this.tWarp).css("line-height")) + "px";
            parseInt(e) > parseInt($("#" + this.tWarp).offset().top + $("#" + this.tWarp).height()) && (e = $("#" + this.tWarp).offset().top + $("#" + this.tWarp).height() + "px"), $("#" + b).css({
                left: d,
                top: e,
                display: "block"
            }), $("#" + b + " dd").eq(0).addClass("on").siblings().removeClass("on"), a.hover(b), $(a.elem).unbind("keyup").unbind("keydown").bind("keydown", function (c) {
                return a.keyMove(b, c)
            }), document.onclick = function () {
                a.hiddenTip()
            }
        }, inset: function () {
            var a = this;
            $("#" + this.sugListID).delegate("dd", "click", function () {
                if (0 == $(this).index())return a.elem.focus(), !1;
                var b = "", c = $(this).attr("data-type");
                "user" == c ? b = $(this).find(".fw_agtlist_sname").text() : "grp" == c ? b = $(this).find(".sgt_groupname").text() : "org" == c && (b = $(this).find(".sgt_orgname").text());
                var d = $(this).attr("data-uid"), e = $(this).attr("data-type"), f = $(this).find(".fw_agtlist_semail").text();
                a.add(a.elem, b, a.at.pos, a.at.len, d, f, e), a.hiddenTip()
            })
        }, hiddenTip: function () {
            $("#" + this.sugListID + " dd").unbind("click,mouseover"), $("#" + this.sugListID).css("display", "none")
        }, keyMove: function (a, b) {
            var c = this, d = b.keyCode, e = $("#" + a + " dd").length;
            switch (d) {
                case 40:
                    return c.index++, c.index > e - 1 && (c.index = 0), c.keyMoveTo(a, c.index), !1;
                case 38:
                    return c.index--, c.index < 0 && (c.index = e - 1), c.keyMoveTo(a, c.index), !1;
                case 13:
                    if (0 == this.model) {
                        var f = "", g = $("#" + a).find(".on"), h = g.attr("data-type");
                        "user" == h ? f = $("#" + a).find(".on").find(".fw_agtlist_sname").text() : "grp" == h ? f = $(".sgt_groupname", g).text() : "org" == h && (f = $(".sgt_orgname", g).text());
                        var i = $("#" + a).find(".on").attr("data-uid");
                        c.add(c.elem, f, c.at.pos, c.at.len, i, "", h)
                    } else {
                        var g = $("#" + a).find(".on"), h = g.attr("data-type");
                        if ("user" == h) {
                            var f = g.find(".fw_agtlist_sname").text(), j = g.find(".fw_agtlist_semail").text(), i = g.attr("data-uid"), k = g.attr("data-headimg"), l = {
                                uname: f,
                                email: j,
                                uid: i,
                                headimg: k,
                                datatype: h
                            };
                            c.addin(l, "SELECT_ADD"), c.KIhidden()
                        } else if ("grp" == h) {
                            var m = $(".sgt_groupname", g).text(), n = g.attr("data-uid"), l = {
                                uname: m,
                                uid: n,
                                datatype: h
                            };
                            c.addin(l, "SELECT_ADD"), c.KIhidden()
                        } else if ("org" == h) {
                            var o = $(".sgt_orgname", g).text(), p = g.attr("data-uid"), l = {
                                uname: o,
                                uid: p,
                                datatype: h
                            };
                            c.addin(l, "SELECT_ADD"), c.KIhidden()
                        }
                    }
                    return c.keyHandler(), !1
            }
            c.keyHandler()
        }, keyHandler: function () {
            var a = this;
            a.index = 0, 0 == this.model ? $(a.elem).unbind("keydown").bind("keyup", function (b) {
                a.getAt(b)
            }) : $(a.elem).unbind("keydown").bind("keyup", _.debounce(function (b) {
                a.KIshow(b)
            }, 200))
        }, keyMoveTo: function (a, b) {
            $("#" + a + " dd").removeClass("on").eq(b).addClass("on")
        }, hover: function (a) {
            var b = this;
            $("#" + a + " dd:not(:first)").hover(function () {
                b.index = $(this).index(), $(this).addClass("hover").siblings().removeClass("on hover")
            }, function () {
                $(this).removeClass("hover")
            })
        }, ddtemplate: function (a, b) {
            if (a = jQuery.extend({
                    guid: "00000000-0000-0000-0000-000000000000",
                    headimg: "",
                    name: "匿名",
                    department: "未知部门",
                    passport: "xx@abc.com",
                    datatype: "user"
                }, a), null != a.name) {
                var c = "", e = 0 == b ? 'class="agt_cate_line"' : "";
                return "user" == a.datatype ? (c = '<dd data-uid="' + a.guid + '" data-type="' + a.datatype + '" ' + e + ' data-headimg="' + a.headimg + '" data-name="' + a.name + '">', c += '<div class="fw_agtlist_ddleft">', c += '<img src="' + a.headimg + '" alt=""/>', c += "</div>", c += '<div class="fw_agtlist_ddright"><span class="fw_agtlist_sname">' + a.name + '</span><span class="fw_agtlist_sdepartment">' + this.strSub(a.department, 12) + '</span><span class="fw_agtlist_semail">' + a.passport + "</span></div>", c += "</dd>") : "org" == a.datatype ? (c = '<dd data-uid="' + a.guid + '" data-type="' + a.datatype + '" ' + e + ">", c += '<div class="fw_agtlist_ddleft">', c += '<div class="fw_agtlist_orgico"></div>', c += "</div>", c += '<div class="fw_agtlist_ddright"><span class="sgt_gtname">部门</span><span class="sgt_orgname" full-name="' + a.name + '">' + d(a.name) + "</span></div>", c += "</dd>") : (a.datatype = "grp") && (c = '<dd data-uid="' + a.guid + '" data-type="' + a.datatype + '" ' + e + ">", c += '<div class="fw_agtlist_ddleft">', c += '<div class="fw_agtlist_grpico"></div>', c += "</div>", c += '<div class="fw_agtlist_ddright"><span class="sgt_gtname">群组</span><span class="sgt_groupname">' + a.name + "</span></div>", c += "</dd>"), c
            }
        }, KISetStyle: function (a) {
            {
                var b = $(this.elem).offset().left + "px", c = $(this.elem).offset().top + 22 + "px";
                $(this.elem).outerWidth() + "px", $(this.elem).outerHeight() + "px"
            }
            a.css({position: "absolute", "z-index": "9999", left: b, top: c, display: "block"})
        }, KIInit: function () {
            var a = $("body");
            $("#" + this.sugListID).remove(), $("#ksnselector_tempcontainer").remove();
            var b = $("<div id='" + this.sugListID + "' style='display:none' class='fw_agtlist'></div>"), c = $('<span id="ksnselector_tempcontainer" style="display:none;"></span>');
            a.append(b).append(c);
            var d = this, e = $(this.elem).parent();
            this.isEnable || ($(this.elem).attr("disabled", !0), e.parents(".fw_ksntxtbox").find(".fw_sboxer").hide()), this.readonly && e.parents(".fw_ksntxtbox").find(".fw_sboxer").hide(), e.click(function () {
                var a = $(this).find("input");
                a.attr("disabled") || a.focus()
            }), e.bind("click", function (a) {
                return d.deleteItemBefore && d.deleteItemBefore($(a.target).parent()[0]) ? !1 : ("A" == $(a.target)[0].tagName && ($(a.target).parents(".fw_ksninput_slted").remove(), $(".fw_boxerContainer").remove(), 1 == d.model && ($(this).find("input").show(), $(this).parents(".fw_ksntxtbox").find(".fw_sboxer").show(), $(this).parents(".fw_ksntxtbox").css("border", "solid 1px #E2E5E7")), d.deleteItemCallBack && d.deleteItemCallBack($(a.target).parent()[0]), d.KInputReset()), !1)
            }), d.KIEventBind()
        }, KIshow: function (a) {
            var b = this, c = $.trim($(this.elem).val()), d = this.sugListID, e = b.KIExitGuid();
            if (c.length > 0)$("#ksnselector_tempcontainer").text(c), $(this.elem).width($("#ksnselector_tempcontainer").width() + 3), $.ajax({
                url: this.url + "&k=" + encodeURIComponent(c) + "&g=" + e + "&t=" + b.sType,
                type: "get",
                dataType: "json",
                data: {},
                success: function (a) {
                    if (a.Result) {
                        var c = a.ReturnObject, e = b.sType, f = "";
                        if (e.indexOf("user") > -1) {
                            var g = c.user;
                            if (g.length > 0)for (var h = 0; h < g.length; h++)f += b.ddtemplate(g[h], h)
                        }
                        if (!b.convertUser) {
                            if (e.indexOf("grp") > -1) {
                                var i = c.grp;
                                if (i.length > 0)for (var h = 0; h < i.length; h++)f += b.ddtemplate(i[h], h)
                            }
                            if (e.indexOf("org") > -1) {
                                var j = c.org;
                                if (j.length > 0)for (var h = 0; h < j.length; h++)b.showp && (j[h].name = j[h].pname), f += b.ddtemplate(j[h], h)
                            }
                        }
                        f.length > 0 ? ($("#" + d).html("<dl><dt>同事姓名、拼音、邮箱可检索</dt>" + f + "</dl>"), b.KISetStyle($("#" + d)), $("#" + d + " dd").eq(0).addClass("on").siblings().removeClass("on"), $(b.elem).unbind("keyup").unbind("keydown").bind("keydown", function (a) {
                            return $(".fw_boxerContainer").remove(), b.keyMove(d, a)
                        }), document.onclick = function () {
                            b.KIhidden()
                        }) : b.KIhidden()
                    } else b.KIhidden()
                }
            }); else if (b.KIhidden(), a = a || window.event, 0 == c.length && 8 == a.keyCode) {
                var f = $("#ksnselector_tempcontainer").text().length;
                if (1 == f)$("#ksnselector_tempcontainer").text(""); else {
                    var g = $(this.elem).prev(".fw_ksninput_slted");
                    ("false" == g.attr("u-readonly") || "undefined" == g.attr("u-readonly")) && g.remove()
                }
            }
        }, KIExitGuid: function () {
            var a = "";
            if ($(this.elem).parent().find(".fw_ksninput_slted").each(function () {
                    a += "|" + $(this).attr("data-uid")
                }), this.selectorExitsGuid.length > 0)for (var b = 0; b < this.selectorExitsGuid.length; b++)a += "|" + this.selectorExitsGuid[b];
            return a
        }, KIEventBind: function () {
            var a = this;
            $("#" + this.sugListID).delegate("dd", "click", function () {
                var b = $(this);
                if (0 == b.index())return a.elem.focus(), !1;
                var c = b.attr("data-type");
                if ("user" == c) {
                    var d = b.find(".fw_agtlist_sname").text(), e = b.find(".fw_agtlist_semail").text(), f = b.attr("data-uid"), g = b.attr("data-headimg"), h = b.find(".fw_agtlist_sdepartment").text(), i = {
                        uname: d,
                        uid: f,
                        email: e,
                        headimg: g,
                        department: h,
                        datatype: c
                    };
                    a.addin(i, "SELECT_ADD"), a.KIhidden()
                } else if ("grp" == c) {
                    var j = $(".sgt_groupname", b).text(), k = b.attr("data-uid"), i = {
                        uname: j,
                        uid: k,
                        headimg: "",
                        datatype: c
                    };
                    a.addin(i, "SELECT_ADD"), a.KIhidden()
                } else if ("org" == c) {
                    var l = $(".sgt_orgname").attr("full-name") || $(".sgt_orgname", b).text(), m = b.attr("data-uid"), i = {
                        uname: l,
                        uid: m,
                        headimg: "",
                        datatype: c
                    };
                    a.addin(i, "SELECT_ADD"), a.KIhidden()
                }
            })
        }, addin: function (a, b) {
            var c = a.datatype, e = a.uname, f = a.uid, g = a.email, h = a.ureadonly, i = encodeURIComponent($.JSONString(a)), j = this, k = !0, l = $(this.elem), m = l.parent().find(".fw_ksninput_slted").length;
            m + 1 > this.maxSelected && (alert("已到达最大可选数了"), l.attr("disabled") || l.focus(), k = !1, this.elem.value = "");
            var n = "";
            "org" == c ? (n = "[组织]", this.showp && (e = a.pname || e)) : "grp" == c && (n = "[群组]"), 2 == this.model && k ? ($(this.elem).is(":hidden") || $(this.elem).attr("disabled") || this.elem.focus(), l.val(""), l.before('<span class="fw_ksninput_slted" title="' + e + '" data-uid="' + f + '" data-type="' + c + '" f-data="' + i + '" u-readonly="' + (j.readonly || h) + '"><em>' + n + d(e) + "</em>" + (j.readonly || h ? "" : "<a></a>") + "</span>"), j.KInputReset()) : 1 == this.model && k && (l.hide(), l.val(""), l.parent().parent().css("border", "solid 1px transparent"), l.parents(".fw_ksntxtbox").find(".fw_sboxer").hide(), l.before('<span class="fw_ksninput_slted" title="' + e + '" data-uid="' + f + '" data-type="' + c + '" f-data="' + i + '" u-readonly="' + (j.readonly || h) + '"><em>' + n + d(e) + "</em>" + (j.readonly || h ? "" : "<a></a>") + "</span>")), j.KIhidden(), $(this.elem).parents(".fw_ksntxtbox").find(".fw_ksnplaceholder").hide(), null != j.seletedCallback && "SELECT_ADD" == b && "cancel" == j.seletedCallback(f, e, g, c, j.elem) && (k = !1)
        }, KIhidden: function () {
            $("#" + this.sugListID).css("display", "none"),
                $("#" + this.sugListID + " dd").unbind("click,mouseover")
        }, KInputReset: function () {
            if ($.trim($(this.elem).parent().find("span").text()).length > 0) {
                {
                    $(this.elem).parent().find("span").last(), $(this.elem).parent()
                }
                $(this.elem).width(10), $("#ksnselector_tempcontainer").text("")
            }
        }, KIClearData: function () {
            $(this.elem).parent().find("span a").click()
        }, KIDataLoaded: function (a) {
            if (a.length > 0)for (var b = this, c = 0; c < a.length; c++)b.addin({
                uname: a[c].uname,
                uid: a[c].uid,
                headimg: a[c].headimg || "",
                datatype: a[c].datatype || "user"
            }, "LOAD_ADD")
        }, KISetDataLoad: function (a, b) {
            for (var c = [], d = 0; d < a.length; d++)c.push(_.isObject(a[d]) ? {
                type: "user",
                id: a[d].id,
                ureadonly: a[d].ureadonly
            } : {type: "user", id: a[d]});
            this.KISetSelectedData(c, b)
        }, KISetSelectedData: function (a, b) {
            var c = this;
            if (a && a.length > 0) {
                var d = $.JSONString(a);
                $.post("/webajax/i8plugins/selector/getpers?", {data: d}, function (d) {
                    if (d && d.Result) {
                        for (var e = d.ReturnObject, f = 0; f < e.length; f++) {
                            var g = _.findWhere(a, {id: e[f].id.toString()}) && _.findWhere(a, {id: e[f].id.toString()}).ureadonly || !1;
                            c.addin({
                                uname: e[f].name,
                                uid: e[f].id,
                                headimg: e[f].img,
                                datatype: e[f].type,
                                pname: e[f].display_name,
                                ureadonly: g
                            }, "LOAD_ADD")
                        }
                        b && b()
                    }
                }, "json")
            }
        }, KIGetAllSelectedData: function () {
            var a = [], b = this.elem.parentNode.childNodes;
            if (b.length > 0)for (var c = 0; c < b.length; c++)if ("SPAN" == b[c].tagName) {
                var d = b[c].attributes.getNamedItem("data-uid").nodeValue, e = b[c].attributes.getNamedItem("data-type").nodeValue, f = b[c].innerText || b[c].textContent;
                a.push({type: e, id: d, name: f})
            }
            return a
        }, KISelectedData: function () {
            var a = "", b = $(this.elem).parent().children("span");
            if (b.length > 0)for (var c = 0; c < b.length; c++) {
                var d = b[c].attributes.getNamedItem("data-uid").nodeValue;
                "" != d && (a = "" != a ? a + ";" + d : d)
            }
            return a
        }
    }, Array.prototype.remove = function (a) {
        if (isNaN(a) || a > this.length)return !1;
        for (var b = 0, c = 0; b < this.length; b++)this[b] != this[a] && (this[c++] = this[b]);
        this.length -= 1
    }, Array.prototype.uniq = function () {
        for (var a = {}, b = this.length, c = 0; b > c; c++)"undefined" == typeof a[this[c]] && (a[this[c]] = 1);
        this.length = 0, b = 0;
        for (var c in a)this[b++] = c;
        return this
    }, b.KSNSelector = e
}), define("default/javascripts/plugins/qiniu_uploader/qiniu_i8uploader", ["./ui", "./qiniu", "./i8fastuploader/i8uploader"], function (a, b) {
    function c(a) {
        function b(a, b) {
            if (b = b.replace(/\{|\(|\)|\}|-/g, ""), b = b.toLowerCase(), 32 != b.length || -1 != b.search(/[^0-9,a-f]/i))d(a); else for (var c = 0; c < b.length; c++)a.push(b[c])
        }

        function d(a) {
            for (var b = 32; b--;)a.push("0")
        }

        function e(a, b) {
            switch (b) {
                case"N":
                    return a.toString().replace(/,/g, "");
                case"D":
                    var d = a.slice(0, 8) + "-" + a.slice(8, 12) + "-" + a.slice(12, 16) + "-" + a.slice(16, 20) + "-" + a.slice(20, 32);
                    return d = d.replace(/,/g, "");
                case"B":
                    var d = e(a, "D");
                    return d = "{" + d + "}";
                case"P":
                    var d = e(a, "D");
                    return d = "(" + d + ")";
                default:
                    return new c
            }
        }

        var f = new Array;
        "string" == typeof a ? b(f, a) : d(f), this.Equals = function (a) {
            return a && a.IsGuid ? this.ToString() == a.ToString() : !1
        }, this.IsGuid = function () {
        }, this.ToString = function (a) {
            return "string" == typeof a && ("N" == a || "D" == a || "B" == a || "P" == a) ? e(f, a) : e(f, "D")
        }
    }

    var d = a("./ui").FileProgress, e = a("./qiniu").Qiniu;
    c.Empty = new c, c.NewGuid = function () {
        for (var a = "", b = 32; b--;)a += Math.floor(16 * Math.random()).toString(16);
        return new c(a)
    };
    var f = a("./i8fastuploader/i8uploader");
    b.i8uploader = function (a) {
        function b(a) {
            if ("array" == $.type(a) && a.length > 0) {
                for (var b = 0, c = a.length; c > b; b++) {
                    var d = $('<li class="state-exist" fileid="' + a[b].ID + '"><p class="imgWrap"></p><p class="title" title="' + a[b].FileName + '">' + a[b].FileName + '</p><p class="progress progressName-exist"><span></span></p></li>');
                    $btns = $('<div class="file-panel"><span class="cancel" filepath="' + a[b].FilePath + '">删除</span></div><span class="success"></span>').on("click", "span.cancel", function () {
                        var a = $(this);
                        "function" == typeof t && t(a), a.parents("li").remove()
                    }).appendTo(d), d.find(".imgWrap").append(/(gif|jpg|jpeg|png|GIF|JPG|PNG)$/.test(a[b].Extension) ? '<img src="' + (a[b].ImageSmall || a[b].FilePath + "?imageView2/1/w/100/h/100") + '" style="max-width:120px;max-height:120px"  />' : '<span class="i8files-ico-' + a[b].Extension + '"></span>'), d.find(".progressName-exist").data({
                        DocID: a[b].DocID || a[b].ID,
                        fileid: a[b].DocID || a[b].ID,
                        name: a[b].FileName
                    }), $("#" + j).append(d)
                }
                $("#" + j).show()
            }
        }

        var a = a || {}, g = a.button || "pickfiles", h = a.tokenUrl || "/community/platform/uptoken", i = "/default/javascripts/plugins/qiniu_uploader/plupload/Moxie.swf", j = a.fileContainerId || "fsUploadProgress", k = a.btnContainerId || "container", l = a.beforeUpload || function () {
            }, m = a.uploadComplete || function () {
            }, n = a.allFileUploaded || function () {
            }, o = a.deleteUpload || function () {
            }, p = a.fileUploaded || function () {
            }, q = a.uploadProgress || function () {
            }, r = a.filesAdded || function () {
            }, s = a.optionChanged || function () {
            }, t = a.onExistDelete || function () {
            }, u = (a.isImUploader || !1, a.maxFiles || 5), v = a.maxSize || 31457280, w = (a.extensions || "doc,docx,xls,xlsx,ppt,pptx,pdf,zip,rar,txt,png,jpg,jpeg,gif").toLocaleLowerCase(), x = a.attachmentlist, y = a.domain || "https://dn-i8buffer.qbox.me/";
        v.toString().indexOf("kb") > -1 ? v = 1024 * parseFloat(v.toString()) : v.toString().indexOf("mb") > -1 && (v = 1024 * parseFloat(v.toString()) * 1024);
        var z = !0, A = !0, B = (function () {
            var a = parseFloat(((i8_session || {}).platform || {}).storagelimit || "0", 10), b = parseFloat((i8_session || {}).storenum || "0", 10);
            b >= a && a && 0 != a && (A = !1)
        }(), function (a) {
            var b = $("#" + j).find("li").find(".success:visible").length, c = a.total.queued;
            if (b + c > u)return alert("超过最大上传个数" + u + "个的限制！"), !1;
            for (var d = 0, e = a.files.length; e > d; d++)if (a.files[d].size > v)return !1;
            return !0
        }), C = function () {
            var b = {
                UploadFile: function () {
                    A || alert("存储空间超过限制！")
                }, FilesAdded: function (a, b) {
                    return z && A ? ($("#" + j).show(), plupload.each(b, function (a) {
                        var b = new d(a, j);
                        b.setStatus("等待...")
                    }), void("function" == typeof r && r(a, b))) : (a.stop(), a.splice(), !1)
                }, BeforeUpload: function (a, b) {
                    if (z = B(a), z && A) {
                        var c = new d(b, j), e = plupload.parseSize(this.getOption("chunk_size"));
                        "html5" === a.runtime && e && c.setChunkProgess(e), "function" == typeof l && l(b)
                    }
                }, UploadProgress: function (a, b) {
                    if (z && A) {
                        var c = new d(b, j), e = plupload.parseSize(this.getOption("chunk_size"));
                        c.setProgress(b.percent + "%", a.total.bytesPerSec, e), "function" == typeof l && q(b)
                    }
                }, UploadComplete: function (a, b, c) {
                    "function" == typeof m && m(a, b, c)
                }, FileUploaded: function (a, b, c) {
                    var e = new d(b, j);
                    e.setComplete(a, b, c), "function" == typeof p && p(a, b, c), D.files.length == $("#" + j).find(".complete").length && n(a, b, c), $("#" + j).show()
                }, OptionChanged: function (a, b, c) {
                    "function" == typeof s && s(a, b, c)
                }, Error: function (a, b) {
                    if (-600 == b.code)z = !1, alert("超过最大上传大小" + v / 1024 / 1024 + "MB的限制！"); else if (-601 == b.code)z = !1, alert("不支持上传的文件格式！只支持(" + w + ")"); else if (-602 == b.code)z = !1, alert("不能上传重复文件！"); else {
                        z = !1;
                        var c = window.global_qiniu_obj;
                        if ("object" == typeof c)return void alert(c.errorMsg ? c.errorMsg : b.message);
                        alert("上传失败")
                    }
                }, CancelUpload: function () {
                }, Key: function (a, b) {
                    var d = (b.name || "").lastIndexOf(".") || 0, e = (b.name || "").substr(d), f = c.NewGuid().ToString(), g = "", h = "";
                    return "undefined" != typeof i8_session && (h = i8_session.aid || ""), h && (g = g + h + "/"), g + f + e
                }
            }, o = !1;
            try {
                o = i8_session.fastDFS.enable
            } catch (t) {
            }
            return o ? (a.cbInit = b, f.fileUploader.uploader(a)) : e.uploader({
                runtimes: "html5,flash,silverlight,html4",
                browse_button: g,
                container: k,
                drop_element: k,
                max_file_size: v,
                prevent_duplicates: !1,
                flash_swf_url: i,
                dragdrop: !0,
                chunk_size: "5mb",
                filters: [{title: "All files", extensions: w}],
                uptoken_url: h,
                domain: y,
                auto_start: !0,
                init: b
            })
        }, D = C();
        return setTimeout(function () {
            $(".moxie-shim-flash").removeAttr("style")
        }, 300), D.bind("FileUploaded", function () {
            $("#" + j).show()
        }), $("#" + k).on("dragenter", function (a) {
            a.preventDefault(), $("#" + k).addClass("draging"), a.stopPropagation()
        }).on("drop", function (a) {
            a.preventDefault(), $("#" + k).removeClass("draging"), a.stopPropagation()
        }).on("dragleave", function (a) {
            a.preventDefault(), $("#" + k).removeClass("draging"), a.stopPropagation()
        }).on("dragover", function (a) {
            a.preventDefault(), $("#" + k).addClass("draging"), a.stopPropagation()
        }), D.fns = {addAttachList: b}, b(x), $(document).on("click", "#" + j + " .cancel", function () {
            var a = $(this).parents("li.progressContainer");
            D.removeFile(a.attr("id")), a.remove(), "function" == typeof o && o(), 0 == $("#" + j).find("li").length && $("#" + j).hide()
        }), $("#" + j).on("click", ".imgWrap span", function () {
            $(this).parents("li.progressContainer").find("a.tag-file-name").trigger("click")
        }), $("#" + j).on("click", "a.tag-file-name", function () {
            var a = $.parseJSON($(this).attr("f-data")), b = {
                Extension: a.ext.replace(/\./g, ""),
                FileName: a.name,
                FilePath: "https://dn-i8buffer.qbox.me/" + a.key
            }, c = {ckindex: 0, imgs: [b]};
            window.viewFiles(c)
        }), new function () {
            this.getUploadFiles = function (a) {
                var b = a || $("#" + j).find("p.progressName"), c = [], d = null, e = "", f = null, g = "", h = "", i = 0;
                return b.each(function () {
                    e = $(this).data("qiniudata");
                    try {
                        d = $.parseJSON(e)
                    } catch (a) {
                    }
                    if ($.isPlainObject(d)) {
                        h = d.key || "", i = h.lastIndexOf("/") || -1, g = h.substr(i + 1);
                        var b = d.key.substr(d.key.lastIndexOf(".")).toLocaleLowerCase();
                        f = {
                            originalname: g,
                            name: d.name,
                            mimetype: d.mimeType,
                            path: h,
                            extension: (d.ext || b || "").substr(1),
                            size: d.size,
                            fileid: d.uuid
                        }, c.push(f)
                    }
                }), c
            }, this.uploaderReset = function () {
                for (var a = D.files, b = 0; b < a.length;)D.removeFile(a[b].id);
                console.log(D.files), $("#" + j).find(".multbtn").length ? $("#" + j).children().not(".multbtn").remove() : $("#" + j).empty().hide()
            }, this.setOption = function (a, b) {
                D.setOption(a, b)
            }, this.removeFile = function (a) {
                D.removeFile(a), $("#" + j).find("[uuid=" + a + "],[fileid=" + a + "]").remove()
            }, this.uploaderStop = function () {
                console.log(D), window.uploader = D
            }, this.addAttachList = function (a) {
                b(a)
            }, this.getExistFiles = function () {
                var a = [];
                return $("#" + j).find("p.progressName-exist").each(function () {
                    a.push($(this).data())
                }), a
            }, this.getUploader = function () {
                return D
            }, this.getSingleFile = function (a) {
                var b = a;
                if ($.isPlainObject(b)) {
                    fullFileInfo = b.key || "", fileLastIndex = fullFileInfo.lastIndexOf("/") || -1, filename = fullFileInfo.substr(fileLastIndex + 1);
                    var c = b.key.substr(b.key.lastIndexOf(".")).toLocaleLowerCase();
                    pushData = {
                        originalname: filename,
                        name: b.name,
                        mimetype: b.mimeType,
                        path: fullFileInfo,
                        extension: (b.ext || c || "").substr(1),
                        size: b.size,
                        fileid: b.uuid
                    }
                }
                return pushData
            }, this.getFile = function (a) {
                var b = null, c = "", d = "", e = 0, f = a;
                if ($.isPlainObject(f)) {
                    d = f.key || "", e = d.lastIndexOf("/") || -1, c = d.substr(e + 1);
                    var g = f.key.substr(f.key.lastIndexOf(".")).toLocaleLowerCase();
                    b = {
                        originalname: c,
                        name: f.name,
                        mimetype: f.mimeType,
                        path: d,
                        extension: (f.ext || g || "").substr(1),
                        size: f.size,
                        fileid: f.uuid
                    }
                }
                return b
            }
        }
    }
}), define("default/javascripts/plugins/qiniu_uploader/qiniu", [], function (a, b) {
    function c() {
        this.detectIEVersion = function () {
            for (var a = 4, b = document.createElement("div"), c = b.getElementsByTagName("i"); b.innerHTML = "<!--[if gt IE " + a + "]><i></i><![endif]-->", c[0];)a++;
            return a > 4 ? a : !1
        }, this.isImage = function (a) {
            var b, c = "", d = ["png", "jpg", "jpeg", "gif", "bmp"], e = /\.([a-zA-Z0-9]+)(\?|\@|$)/;
            if (!a || !e.test(a))return !1;
            b = e.exec(a), c = b[1].toLowerCase();
            for (var f = 0, g = d.length; g > f; f++)if (c === d[f])return !0;
            return !1
        }, this.getFileExtension = function (a) {
            var b, c = a.split(".");
            return b = 1 === c.length || "" === c[0] && 2 === c.length ? "" : c.pop().toLowerCase()
        }, this.utf8_encode = function (a) {
            if (null === a || "undefined" == typeof a)return "";
            var b, c, d = a + "", e = "", f = 0;
            b = c = 0, f = d.length;
            for (var g = 0; f > g; g++) {
                var h = d.charCodeAt(g), i = null;
                if (128 > h)c++; else if (h > 127 && 2048 > h)i = String.fromCharCode(h >> 6 | 192, 63 & h | 128); else if (63488 & h ^ !0)i = String.fromCharCode(h >> 12 | 224, h >> 6 & 63 | 128, 63 & h | 128); else {
                    if (64512 & h ^ !0)throw new RangeError("Unmatched trail surrogate at " + g);
                    var j = d.charCodeAt(++g);
                    if (64512 & j ^ !0)throw new RangeError("Unmatched lead surrogate at " + (g - 1));
                    h = ((1023 & h) << 10) + (1023 & j) + 65536, i = String.fromCharCode(h >> 18 | 240, h >> 12 & 63 | 128, h >> 6 & 63 | 128, 63 & h | 128)
                }
                null !== i && (c > b && (e += d.slice(b, c)), e += i, b = c = g + 1)
            }
            return c > b && (e += d.slice(b, f)), e
        }, this.base64_encode = function (a) {
            var b, c, d, e, f, g, h, i, j = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=", k = 0, l = 0, m = "", n = [];
            if (!a)return a;
            a = this.utf8_encode(a + "");
            do b = a.charCodeAt(k++), c = a.charCodeAt(k++), d = a.charCodeAt(k++), i = b << 16 | c << 8 | d, e = i >> 18 & 63, f = i >> 12 & 63, g = i >> 6 & 63, h = 63 & i, n[l++] = j.charAt(e) + j.charAt(f) + j.charAt(g) + j.charAt(h); while (k < a.length);
            switch (m = n.join(""), a.length % 3) {
                case 1:
                    m = m.slice(0, -2) + "==";
                    break;
                case 2:
                    m = m.slice(0, -1) + "="
            }
            return m
        }, this.URLSafeBase64Encode = function (a) {
            return a = this.base64_encode(a), a.replace(/\//g, "_").replace(/\+/g, "-")
        }, this.createAjax = function () {
            var a = {};
            return a = window.XMLHttpRequest ? new XMLHttpRequest : new ActiveXObject("Microsoft.XMLHTTP")
        }, this.parseJSON = function (a) {
            return window.JSON && window.JSON.parse ? window.JSON.parse(a) : null === a ? a : "string" == typeof a && (a = this.trim(a), a && /^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g, "@").replace(/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g, "]").replace(/(?:^|:|,)(?:\s*\[)+/g, ""))) ? function () {
                return a
            }() : void 0
        }, this.trim = function (a) {
            return null === a ? "" : $.trim(a)
        };
        var a = this;
        this.uploader = function (b) {
            if (!b.domain)throw"uptoken_url or domain is required!";
            if (!b.browse_button)throw"browse_button is required!";
            var c = {}, d = b.init && b.init.Error, e = b.init && b.init.FileUploaded;
            b.init.Error = function () {
            }, b.init.FileUploaded = function () {
            }, a.uptoken_url = b.uptoken_url, a.token = "", a.key_handler = "function" == typeof b.init.Key ? b.init.Key : "", this.domain = b.domain;
            var f = "", g = function () {
                var c, d, e, f = a.detectIEVersion(), g = "Safari" === mOxie.Env.browser && mOxie.Env.version <= 5 && "Windows" === mOxie.Env.os && "7" === mOxie.Env.osVersion || "Safari" === mOxie.Env.browser && "iOS" === mOxie.Env.os && "7" === mOxie.Env.osVersion;
                f && 9 >= f && b.chunk_size && b.runtimes.indexOf("flash") >= 0 ? b.chunk_size = 0 : g ? b.chunk_size = 0 : (c = 20, d = 4 << c, e = plupload.parseSize(b.chunk_size), e > d && (b.chunk_size = d))
            };
            g();
            var h = function () {
                if (b.uptoken)a.token = b.uptoken; else {
                    var c = a.createAjax();
                    c.open("GET", a.uptoken_url, !0), c.setRequestHeader("If-Modified-Since", "0"), c.onreadystatechange = function () {
                        if (4 === c.readyState && 200 === c.status) {
                            {
                                var b = a.parseJSON(c.responseText), d = b.result;
                                b.msg
                            }
                            window.global_qiniu_obj = b, a.token = d ? b.uptoken : ""
                        }
                    }, c.send()
                }
            }, i = function (c, d, e) {
                var f = "", g = !1;
                if (!b.save_key)if (g = c.getOption && c.getOption("unique_names"), g = g || c.settings && c.settings.unique_names) {
                    var h = a.getFileExtension(d.name);
                    f = h ? d.id + "." + h : d.id
                } else f = "function" == typeof e ? e(c, d) : d.name;
                return f
            };
            plupload.extend(c, b, {url: "http://up.qiniu.com", multipart_params: {token: ""}});
            var j = new plupload.Uploader(c);
            return j.bind("Init", function () {
                h()
            }), j.init(), j.bind("FilesAdded", function (a, b) {
                var c = a.getOption && a.getOption("auto_start");
                c = c || a.settings && a.settings.auto_start, c && plupload.each(b, function () {
                    a.start()
                }), a.refresh()
            }), j.bind("BeforeUpload", function (c, d) {
                f = "";
                var e = function (c, d, e) {
                    var f;
                    f = b.save_key ? {token: a.token} : {key: i(c, d, e), token: a.token};
                    var g = b.x_vars;
                    if (void 0 !== g && "object" == typeof g)for (var h in g)g.hasOwnProperty(h) && ("function" == typeof g[h] ? f["x:" + h] = g[h](c, d) : "object" != typeof g[h] && (f["x:" + h] = g[h]));
                    c.setOption({url: "https://up.qbox.me/", multipart: !0, chunk_size: void 0, multipart_params: f})
                }, g = c.getOption && c.getOption("chunk_size");
                if (g = g || c.settings && c.settings.chunk_size, "html5" === j.runtime && g)if (d.size < g)e(c, d, a.key_handler); else {
                    var h = localStorage.getItem(d.name), k = g;
                    if (h) {
                        h = JSON.parse(h);
                        var l = (new Date).getTime(), m = h.time || 0, n = 864e5;
                        n > l - m && 100 !== h.percent && d.size === localStorage.total ? (d.percent = h.percent, d.loaded = h.offset, f = h.ctx, h.offset + k > d.size && (k = d.size - h.offset)) : localStorage.removeItem(d.name)
                    }
                    c.setOption({
                        url: "https://up.qbox.me/mkblk/" + k,
                        multipart: !1,
                        chunk_size: g,
                        required_features: "chunks",
                        headers: {Authorization: "UpToken " + a.token},
                        multipart_params: {}
                    })
                } else e(c, d, a.key_handler)
            }), j.bind("ChunkUploaded", function (b, c, d) {
                var e = a.parseJSON(d.response);
                f = f ? f + "," + e.ctx : e.ctx;
                var g = d.total - d.offset, h = b.getOption && b.getOption("chunk_size");
                h = h || b.settings && b.settings.chunk_size, h > g && b.setOption({url: "https://up.qbox.me/mkblk/" + g}), localStorage.setItem(c.name, JSON.stringify({
                    ctx: f,
                    percent: c.percent,
                    total: d.total,
                    offset: d.offset,
                    time: (new Date).getTime()
                }))
            }), j.bind("Error", function (b) {
                return function (c, d) {
                    var e = "", f = d.file;
                    if (f) {
                        switch (d.code) {
                            case plupload.FAILED:
                                e = "上传失败。请稍后再试。";
                                break;
                            case plupload.FILE_SIZE_ERROR:
                                var g = c.getOption && c.getOption("max_file_size");
                                g = g || c.settings && c.settings.max_file_size, e = "浏览器最大可上传" + g + "。更大文件请使用命令行工具。";
                                break;
                            case plupload.FILE_EXTENSION_ERROR:
                                e = "文件验证失败。请稍后重试。";
                                break;
                            case plupload.HTTP_ERROR:
                                var h = a.parseJSON(d.response), i = h.error;
                                switch (d.status) {
                                    case 400:
                                        e = "请求报文格式错误。";
                                        break;
                                    case 401:
                                        e = "客户端认证授权失败。请重试或提交反馈。";
                                        break;
                                    case 405:
                                        e = "客户端请求错误。请重试或提交反馈。";
                                        break;
                                    case 579:
                                        e = "资源上传成功，但回调失败。";
                                        break;
                                    case 599:
                                        e = "网络连接异常。请重试或提交反馈。";
                                        break;
                                    case 614:
                                        e = "文件已存在。";
                                        try {
                                            h = a.parseJSON(h.error), i = h.error || "file exists"
                                        } catch (k) {
                                            i = h.error || "file exists"
                                        }
                                        break;
                                    case 631:
                                        e = "指定空间不存在。";
                                        break;
                                    case 701:
                                        e = "上传数据块校验出错。请重试或提交反馈。";
                                        break;
                                    default:
                                        e = "未知错误。"
                                }
                                e = e + "(" + d.status + "：" + i + ")";
                                break;
                            case plupload.SECURITY_ERROR:
                                e = "安全配置错误。请联系网站管理员。";
                                break;
                            case plupload.GENERIC_ERROR:
                                e = "上传失败。请稍后再试。";
                                break;
                            case plupload.IO_ERROR:
                                e = "上传失败。请稍后再试。";
                                break;
                            case plupload.INIT_ERROR:
                                e = "网站配置错误。请联系网站管理员。", j.destroy();
                                break;
                            default:
                                e = d.message + d.details
                        }
                        b && b(c, d, e)
                    }
                    c.refresh()
                }
            }(d)), j.bind("FileUploaded", function (c) {
                return function (d, e, g) {
                    var h = function (d, e, f) {
                        if (b.downtoken_url) {
                            var g = a.createAjax();
                            g.open("POST", b.downtoken_url, !0), g.setRequestHeader("Content-type", "application/x-www-form-urlencoded"), g.onreadystatechange = function () {
                                if (4 === g.readyState)if (200 === g.status) {
                                    var b;
                                    try {
                                        b = a.parseJSON(g.responseText)
                                    } catch (h) {
                                        throw"invalid json format"
                                    }
                                    var i = {};
                                    plupload.extend(i, a.parseJSON(f), b), c && c(d, e, JSON.stringify(i))
                                } else j.trigger("Error", {
                                    status: g.status,
                                    response: g.responseText,
                                    file: e,
                                    code: plupload.HTTP_ERROR
                                })
                            }, g.send("key=" + a.parseJSON(f).key + "&domain=" + b.domain)
                        } else c && c(d, e, f)
                    }, k = a.parseJSON(g.response);
                    if (f = f ? f : k.ctx) {
                        var l = "";
                        b.save_key || (l = i(d, e, a.key_handler), l = l ? "/key/" + a.URLSafeBase64Encode(l) : "");
                        var m = b.x_vars, n = "", o = "";
                        if (void 0 !== m && "object" == typeof m)for (var p in m)m.hasOwnProperty(p) && ("function" == typeof m[p] ? n = a.URLSafeBase64Encode(m[p](d, e)) : "object" != typeof m[p] && (n = a.URLSafeBase64Encode(m[p])), o += "/x:" + p + "/" + n);
                        var q = "https://up.qbox.me/mkfile/" + e.size + l + o, r = a.createAjax();
                        r.open("POST", q, !0), r.setRequestHeader("Content-Type", "text/plain;charset=UTF-8"), r.setRequestHeader("Authorization", "UpToken " + a.token), r.onreadystatechange = function () {
                            if (4 === r.readyState)if (localStorage.removeItem(e.name), 200 === r.status) {
                                var a = r.responseText;
                                h(d, e, a)
                            } else j.trigger("Error", {status: r.status, response: r.responseText, file: e, code: -200})
                        }, r.send(f)
                    } else h(d, e, g.response)
                }
            }(e)), j
        }, this.getUrl = function (a) {
            if (!a)return !1;
            a = encodeURI(a);
            var b = this.domain;
            return "/" !== b.slice(b.length - 1) && (b += "/"), b + a
        }, this.imageView2 = function (a, b) {
            var c = a.mode || "", d = a.w || "", e = a.h || "", f = a.quality || "", g = a.format || "";
            if (!c)return !1;
            if (!d && !e)return !1;
            var h = "imageView2/" + c;
            return h += d ? "/w/" + d : "", h += e ? "/h/" + e : "", h += f ? "/q/" + f : "", h += g ? "/format/" + g : "", b && (h = this.getUrl(b) + "?" + h), h
        }, this.imageMogr2 = function (a, b) {
            var c = a["auto-orient"] || "", d = a.thumbnail || "", e = a.strip || "", f = a.gravity || "", g = a.crop || "", h = a.quality || "", i = a.rotate || "", j = a.format || "", k = a.blur || "", l = "imageMogr2";
            return l += c ? "/auto-orient" : "", l += d ? "/thumbnail/" + d : "", l += e ? "/strip" : "", l += f ? "/gravity/" + f : "", l += h ? "/quality/" + h : "", l += g ? "/crop/" + g : "", l += i ? "/rotate/" + i : "", l += j ? "/format/" + j : "", l += k ? "/blur/" + k : "", b && (l = this.getUrl(b) + "?" + l), l
        }, this.watermark = function (a, b) {
            var c = a.mode;
            if (!c)return !1;
            var d = "watermark/" + c;
            if (1 === c) {
                var e = a.image || "";
                if (!e)return !1;
                d += e ? "/image/" + this.URLSafeBase64Encode(e) : ""
            } else {
                if (2 !== c)return !1;
                var f = a.text ? a.text : "", g = a.font ? a.font : "", h = a.fontsize ? a.fontsize : "", i = a.fill ? a.fill : "";
                if (!f)return !1;
                d += f ? "/text/" + this.URLSafeBase64Encode(f) : "", d += g ? "/font/" + this.URLSafeBase64Encode(g) : "", d += h ? "/fontsize/" + h : "", d += i ? "/fill/" + this.URLSafeBase64Encode(i) : ""
            }
            var j = a.dissolve || "", k = a.gravity || "", l = a.dx || "", m = a.dy || "";
            return d += j ? "/dissolve/" + j : "", d += k ? "/gravity/" + k : "", d += l ? "/dx/" + l : "", d += m ? "/dy/" + m : "", b && (d = this.getUrl(b) + "?" + d), d
        }, this.imageInfo = function (a) {
            if (!a)return !1;
            var b, c = this.getUrl(a) + "?imageInfo", d = this.createAjax(), e = this;
            return d.open("GET", c, !1), d.onreadystatechange = function () {
                4 === d.readyState && 200 === d.status && (b = e.parseJSON(d.responseText))
            }, d.send(), b
        }, this.exif = function (a) {
            if (!a)return !1;
            var b, c = this.getUrl(a) + "?exif", d = this.createAjax(), e = this;
            return d.open("GET", c, !1), d.onreadystatechange = function () {
                4 === d.readyState && 200 === d.status && (b = e.parseJSON(d.responseText))
            }, d.send(), b
        }, this.get = function (a, b) {
            return b && a ? "exif" === a ? this.exif(b) : "imageInfo" === a ? this.imageInfo(b) : !1 : !1
        }, this.pipeline = function (a, b) {
            var c, d, e = "[object Array]" === Object.prototype.toString.call(a), f = "";
            if (e) {
                for (var g = 0, h = a.length; h > g; g++) {
                    if (c = a[g], !c.fop)return !1;
                    switch (c.fop) {
                        case"watermark":
                            f += this.watermark(c) + "|";
                            break;
                        case"imageView2":
                            f += this.imageView2(c) + "|";
                            break;
                        case"imageMogr2":
                            f += this.imageMogr2(c) + "|";
                            break;
                        default:
                            d = !0
                    }
                    if (d)return !1
                }
                if (b) {
                    f = this.getUrl(b) + "?" + f;
                    var i = f.length;
                    "|" === f.slice(i - 1) && (f = f.slice(0, i - 1))
                }
                return f
            }
            return !1
        }
    }

    var d = new c;
    b.Qiniu = d
}), define("default/javascripts/plugins/qiniu_uploader/ui", [], function (a, b) {
    function c(a, b) {
        if (this.fileProgressID = a.id, this.file = a, this.opacity = 100, this.height = 0, this.fileProgressWrapper = $("#" + this.fileProgressID), this.fileProgressWrapper.length)this.reset(); else {
            this.fileProgressWrapper = $("<li></li>");
            var c = this.fileProgressWrapper;
            c.attr("id", this.fileProgressID).addClass("progressContainer");
            var d = (plupload.formatSize(a.size).toUpperCase(), $("<p/>"));
            d.addClass("imgWrap").addClass("progressName");
            var e = $("<p/>");
            e.addClass("title").html($('<a class="tag-file-name">' + a.name + "</a>")).attr("title", a.name);
            var f = $('<span class="success" style="display: none;">完成</span>'), g = $("<div/>");
            g.addClass("file-panel"), g.append('<span class="cancel">删除</span>');
            var h = $("<div/>");
            h.addClass("info");
            var i = $("<div/>");
            i.addClass("progress progress-striped");
            var j = $('<div class="loading"><span class="loadingText">0%</span></div>'), k = $("<a href=# />");
            k.hide().addClass("progressCancel").text(""), i.append(j), h.append(i), h.append(k);
            var l = $('<div class="status text-center"/>');
            h.append(l), c.append(d), c.append(e), c.append(g), c.append(f), c.append(j), $("#" + b).append(c)
        }
        this.height = this.fileProgressWrapper.offset().top, this.setTimer(null)
    }

    c.prototype.setTimer = function (a) {
        this.fileProgressWrapper.FP_TIMER = a
    }, c.prototype.getTimer = function () {
        return this.fileProgressWrapper.FP_TIMER || null
    }, c.prototype.reset = function () {
        this.fileProgressWrapper.attr("class", "progressContainer"), this.fileProgressWrapper.find("td .progress .progress-bar-info").attr("aria-valuenow", 0).width("0%").find("span").text(""), this.appear()
    }, c.prototype.setChunkProgess = function (a) {
        var b = Math.ceil(this.file.size / a);
        if (1 === b)return !1;
        for (var c = $('<button class="btn btn-default">查看分块上传进度</button>'), d = $('<tr class="chunk-status-tr"><td colspan=3></td></tr>'), e = $("<div/>"), f = 1; b >= f; f++) {
            var g = $('<div class="col-md-2"/>'), h = $('<div class="progress progress-striped"></div'), i = $("<div/>");
            i.addClass("progress-bar progress-bar-info text-left").attr("role", "progressbar").attr("aria-valuemax", 100).attr("aria-valuenow", 0).attr("aria-valuein", 0).width("0%").attr("id", this.file.id + "_" + f).text("");
            var j = $("<span/>");
            j.addClass("chunk-status").text(), h.append(i), h.append(j), g.append(h), e.append(g)
        }
        this.fileProgressWrapper.find("td>div").append(c), d.hide().find("td").append(e), d.insertAfter(this.fileProgressWrapper)
    }, c.prototype.setProgress = function (a, b, c) {
        this.fileProgressWrapper.attr("class", "progressContainer green");
        {
            var d = this.file, e = d.loaded;
            plupload.formatSize(e).toUpperCase(), plupload.formatSize(b).toUpperCase()
        }
        if (this.fileProgressWrapper.find(".loadingText").text(a), a = parseInt(a, 10), d.status !== plupload.DONE && 100 === a && (a = 99), c) {
            var f = Math.ceil(d.size / c);
            if (1 === f)return !1;
            for (var g, h, i = Math.ceil(e / c), j = 0; i > j; j++)g = $("#" + d.id + "_" + j), g.width("100%").removeClass().addClass("alert-success").attr("aria-valuenow", 100), h = "块" + j + "上传进度100%", g.next().html(h);
            var k, l = $("#" + d.id + "_" + i);
            if (f > i)e % c ? k = (e % c / c * 100).toFixed(2) : (k = 100, l.removeClass().addClass("alert-success")); else {
                var m = d.size - c * (f - 1), n = d.size - e;
                n % m ? k = (e % c / m * 100).toFixed(2) : (k = 100, l.removeClass().addClass("alert-success"))
            }
            l.width(k + "%"), l.attr("aria-valuenow", k), h = "块" + i + "上传进度" + k + "%", l.next().html(h)
        }
        this.appear()
    }, c.prototype.setComplete = function (a, b, c) {
        var d = this.fileProgressWrapper.find("td:eq(2) .progress"), e = $.parseJSON(c);
        this.fileProgressWrapper.attr("uuid", e.uuid), e.name || (e.ext = b.name.substr(b.name.lastIndexOf(".")).toLowerCase()), e.name = e.name || b.name, this.fileProgressWrapper.find("a.tag-file-name").attr("f-data", c);
        var f;
        if (e.url)f = e.url, str = "<div><strong>Link:</strong><a href=" + e.url + " target='_blank' > " + e.url + "</a></div><div class=hash><strong>Hash:</strong>" + e.hash + "</div>"; else {
            var g = a.getOption("domain");
            f = g + encodeURI(e.key);
            var h = g + e.key;
            str = "<div><strong>Link:</strong><a href=" + f + " target='_blank' > " + h + "</a></div><div class=hash><strong>Hash:</strong>" + e.hash + "</div>"
        }
        d.html(str).removeClass().next().next(".status").hide();
        var i = this.fileProgressWrapper.find(".progressName"), j = this.fileProgressWrapper.find(".success");
        j.show();
        var k = "?imageView2/1/w/100/h/100", l = function (a) {
            var b, c = "", d = ["png", "jpg", "jpeg", "gif", "bmp"], e = /\.([a-zA-Z0-9]+)(\?|\@|$)/;
            if (!a || !e.test(a))return !1;
            b = e.exec(a), c = b[1].toLowerCase();
            for (var f = 0, g = d.length; g > f; f++)if (c === d[f])return !0;
            return !1
        }, m = l(f);
        i.data("qiniudata", JSON.stringify(e));
        var n = $('<div class="Wrapper"/>'), o = $('<div class="imgWrapper col-md-3"/>'), p = $('<a class="linkWrapper" target="_blank"/>');
        if (this.fileProgressWrapper.find(".loading").hide(), m) {
            var q = $('<img style="width:64px;height:64px; vertical-align:middle;" src="' + i8_session.resHost + 'default/images/64loading_white.gif"/>');
            i.append(q), o.append(p), n.append(o);
            var r = new Image;
            /imageView/.test(f) || (f += k), $(r).attr("src", f);
            var s = 340;
            $(r).on("load", function () {
                function a(a, b, c) {
                    $("#myModal-img").modal();
                    var d = $("#myModal-img").find(".modal-body");
                    300 >= c && $("#myModal-img").find(".text-warning").show();
                    var e = new Image;
                    d.find("img").attr("src", "loading.gif"), e.onload = function () {
                        d.find("img").attr("src", a).data("key", b).data("h", c), d.find(".modal-body-wrapper").find("a").attr("href", a)
                    }, e.src = a
                }

                q.attr("src", f).removeAttr("style"), p.attr("href", f).attr("title", "查看原图");
                var b = $('<div class="infoWrapper col-md-6"></div>'), c = $('<a class="fopLink"/>');
                c.attr("data-key", e.key).text("查看处理效果"), b.append(c), c.on("click", function () {
                    var b = $(this).data("key"), c = parseInt($(this).parents(".Wrapper").find(".origin-height").text(), 10);
                    c = c > $(window).height() - s ? parseInt($(window).height() - s, 10) : parseInt(c, 10) || 300;
                    var d = [];
                    d.push({fop: "imageView2", mode: 3, h: c, q: 100, format: "png"}), d.push({
                        fop: "watermark",
                        mode: 1,
                        dissolve: 100,
                        gravity: "SouthEast",
                        dx: 100,
                        dy: 100
                    });
                    var e = Qiniu.pipeline(d, b);
                    return $("#myModal-img").on("hide.bs.modal", function () {
                        $("#myModal-img").find(".btn-default").removeClass("disabled"), $("#myModal-img").find(".text-warning").hide()
                    }).on("show.bs.modal", function () {
                        $("#myModal-img").find(".imageView").find("a:eq(0)").addClass("disabled"), $("#myModal-img").find(".watermark").find("a:eq(3)").addClass("disabled"), $("#myModal-img").find(".text-warning").hide()
                    }), a(e, b, c), !1
                }), n.append(b)
            }).on("error", function () {
                q.attr("src", "default.png"), n.addClass("default")
            })
        } else {
            var t = (e || {}).key || "", u = t.lastIndexOf(".") || 0, v = t.substr(u + 1);
            i.append('<span class="i8files-ico-' + v + '"></span>')
        }
    }, c.prototype.setError = function () {
        this.fileProgressWrapper.find("td:eq(2)").attr("class", "text-warning"), this.fileProgressWrapper.find("td:eq(2) .progress").css("width", 0).hide(), this.fileProgressWrapper.find("button").hide(), this.fileProgressWrapper.next(".chunk-status-tr").hide()
    }, c.prototype.setCancelled = function (a) {
        var b = "progressContainer";
        a || (b += " red"), this.fileProgressWrapper.attr("class", b), this.fileProgressWrapper.find("td .progress .progress-bar-info").css("width", 0)
    }, c.prototype.setStatus = function (a, b) {
        b || this.fileProgressWrapper.find(".status").text(a).attr("class", "status text-left")
    }, c.prototype.appear = function () {
        if (null !== this.getTimer() && (clearTimeout(this.getTimer()), this.setTimer(null)), this.fileProgressWrapper[0].filters)try {
            this.fileProgressWrapper[0].filters.item("DXImageTransform.Microsoft.Alpha").opacity = 100
        } catch (a) {
            this.fileProgressWrapper.css("filter", "progid:DXImageTransform.Microsoft.Alpha(opacity=100)")
        } else this.fileProgressWrapper.css("opacity", 1);
        this.fileProgressWrapper.css("height", ""), this.fileProgressWrapper.addClass("complete"), this.height = this.fileProgressWrapper.offset().top, this.opacity = 100, this.fileProgressWrapper.show()
    }, b.FileProgress = c
}), define("default/javascripts/plugins/qiniu_uploader/i8fastuploader/i8uploader", [], function (a, b) {
    function c() {
        this.uploader = function (a) {
            var b = (a.cbInit && a.cbInit.Error, a.cbInit && a.cbInit.FileUploaded);
            a.cbInit.Error = function () {
            }, a.cbInit.FileUploaded = function () {
            };
            var c = new plupload.Uploader({
                runtimes: "html5,flash,silverlight,html4",
                browse_button: document.getElementById(a.button),
                container: document.getElementById(a.fileContainerId),
                url: i8_session.fastDFS.upDomain,
                flash_swf_url: "/default/javascripts/plugins/qiniu_uploader/plupload/Moxie.swf",
                filters: {
                    max_file_size: "100mb",
                    mime_types: [{title: "Image files", extensions: "jpg,gif,png"}, {
                        title: "Zip files",
                        extensions: "zip"
                    }]
                },
                domain: i8_session.fastDFS.bufDomain,
                auto_start: !0,
                init: a.cbInit
            });
            return c.init(), c.bind("FilesAdded", function (a, b) {
                var c = a.getOption && a.getOption("auto_start");
                c = c || a.settings && a.settings.auto_start, c && plupload.each(b, function () {
                    a.start()
                }), a.refresh()
            }), c.bind("FileUploaded", function (a) {
                return function (b, c, d) {
                    a(b, c, d.response)
                }
            }(b)), c
        }
    }

    b.fileUploader = new c
}), define("default/javascripts/common/seefile", ["./i8ui", "./util", "../document/common", "../plugins/qiniu_uploader/qiniu_i8uploader", "../plugins/qiniu_uploader/ui", "../plugins/qiniu_uploader/qiniu", "../plugins/qiniu_uploader/i8fastuploader/i8uploader", "./fw_pagination", "../plugins/i8selector/fw_selector", "../../template/document/add_power_item.tpl", "../../template/task/error_role.tpl", "../../template/document/center-doc-list.tpl", "../../template/document/my-center-doc-list.tpl", "../../template/document/quick-link-folder.tpl", "../../template/document/doc_upload.tpl", "../../template/document/doc_upload_batch.tpl", "../../template/document/doc_upload_item.tpl", "../../template/document/file_edit.tpl", "../../template/document/parent_power_item.tpl", "../../template/document/admin-new-folder.tpl"], function (a, b) {
    var c = a("./i8ui"), d = a("./util");
    window.powerIndex = window.powerIndex || 1;
    var e = {
        fjId: "js_fj_id",
        panlId: "js_sf_panl",
        closeId: "js_sf_close",
        fullScreenId: "js_sf_fullScreen",
        showleftId: "js_showimg_div",
        ckImgId: "js_showimg_id",
        bigckImgId: "js_showbigimg_id",
        ckFileId: "js_sf_id",
        imgsPanlId: "js_imgsall_Id",
        prevImg: i8_session.resHost + "default/images/fjsee/pic_prev.cur",
        nextImg: i8_session.resHost + "default/images/fjsee/pic_next.cur",
        datas: {},
        fileBgUrl: i8_session.resHost + "default/images/fjsee/",
        protocol: window.location.protocol,
        iframeUrl: "",
        iframePath: "",
        viewUrl: location.protocol + "//wopi.i8oa.com/Home/ViewFile?filePath=",
        getDownUrl: function (a) {
            var b = i8_session.subdomain + location.host.replace(/\w+./, "."), c = location.protocol + "//" + b + i8_session.baseHost + "platform/get-file?imgurl=" + encodeURIComponent(a.FilePath) + "&attname=" + encodeURIComponent(a.FileName), d = a.Extension.toLocaleLowerCase();
            return ("jpg" == d || "gif" == d || "png" == d || "jpeg" == d || "bmp" == d) && (c = -1 == a.FilePath.indexOf("?") ? a.FilePath + "?attname=" + a.FileName : a.FilePath + "&attname=" + a.FileName), c
        },
        getViewUrl: function (a) {
            var b = "", c = i8_session.subdomain + location.host.replace(/\w+./, "."), d = a.Extension.toLocaleLowerCase();
            return b = "txt" == d ? location.protocol + "//" + c + i8_session.baseHost + "platform/view-txt?imgurl=" + encodeURIComponent(a.FilePath) : location.protocol + "//" + c + i8_session.baseHost + "platform/view-file?imgurl=" + encodeURIComponent(a.FilePath), a.onlyShow ? a.FilePath : b
        },
        footheight: 135,
        imgMaxW: 1024,
        imgMaxH: 550,
        fileW: 860,
        fileH: $(window).height() - 170,
        getSmallimg: function (a) {
            return a + "?imageView2/0/w/60/h/50"
        },
        getMiddleimg: function (a) {
            return a + "?imageView2/2/w/680"
        },
        getBigimg: function (a) {
            return a + "?imageView2/2/w/1024"
        },
        dg: function (a) {
            return $(top.location != location ? window.parent.document.getElementById(a) : document.getElementById(a))
        },
        getEment: function (a) {
            return document.getElementById(a) || window.parent.document.getElementById(a)
        },
        dcMent: function () {
            return top.location != location ? window.parent.document : document;

        },
        getClientHeight: function () {
            return top.location != location ? window.parent.document.documentElement.clientHeight : document.documentElement.clientHeight
        },
        begin: function (a) {
            e.datas = a;
            var b = e.getDownUrl(a.imgs[a.ckindex]), c = ['<div id="' + e.fjId + '" class="fj_panl">', '<span id="' + e.closeId + '" class="fj_close"></span>', '<span id="' + e.fullScreenId + '" class="js_sf_fullScreen"></span>', '<div id="' + e.showleftId + '" class="tcenter" onselectstart="return false;">', '<span id="js_loading" class="fj_loading" style=""></span>', "</div>", '<div id="' + e.imgsPanlId + '" class="fj_smalls">', '<div class="fj_small_cont">', '<div id="fj_img_editdiv" class="fj_links_div hide">', '<a class="upimg_angle fj1">向左转</a>', '<a class="upimg_angle fj2">向右转</a>', '<a class="upimg_size fj3">放大</a>', '<a id="fj_file_guidang" gd-in-dielog="true" class="fj_file_guidang fj5 hide">归档到企业文档</a>', '<a class="down_link fj4" href="' + b + '" target="_blank">下载原图</a>', "</div>", '<div id="fj_file_editdiv" class="fj_links_div hide">', '<a gd-in-dielog="true" class="fj_file_guidang fj5 hide">归档到企业文档</a>', '<span class="down_file fj4" target="_blank">下载查看</span>', "</div>", "</div>", '<ul class="fj_small_ul oflow">', "</ul>", "</div>", "</div>"], d = c.join("");
            document.getElementById(e.fjId) && e.dg(e.fjId).remove(), top.location != location ? $(window.parent.document.body).append(d) : $("body").append(d), e.countSize()
        },
        beginByUrl: function (a) {
            e.datas = a, "img" != g.getTypestr(a.imgs[0].Extension) && "txt" != a.imgs[0].Extension && (e.datas.imgs[0].FilePath = e.viewUrl + a.imgs[0].FilePath), e.datas.imgs[0].onlyShow = !0;
            var b = ['<div id="' + e.fjId + '" class="fj_panl">', '<span id="' + e.closeId + '" class="fj_close"></span>', '<span id="' + e.fullScreenId + '" class="js_sf_fullScreen"></span>', '<div id="' + e.showleftId + '" class="tcenter" onselectstart="return false;">', '<span id="js_loading" class="fj_loading" style=""></span>', "</div>", '<div id="' + e.imgsPanlId + '" class="fj_smalls">', '<div class="fj_small_cont">', '<div id="fj_img_editdiv" class="fj_links_div hide">', '<a class="upimg_angle fj1">向左转</a>', '<a class="upimg_angle fj2">向右转</a>', '<a class="upimg_size fj3">放大</a>', "</div>", '<div id="fj_file_editdiv" class="fj_links_div hide">', "</div>", "</div>", '<ul class="fj_small_ul oflow">', "</ul>", "</div>", "</div>"], c = b.join("");
            document.getElementById(e.fjId) && e.dg(e.fjId).remove(), top.location != location ? $(window.parent.document.body).append(c) : $("body").append(c), e.countSize()
        },
        getWidth: function () {
            return top.location != location ? $(window.parent.document).width() : void $(document).width()
        },
        getHeight: function () {
            return top.location != location ? $(window.parent.document).height() : void $(document).height()
        },
        countSize: function () {
            top.location == location ? $(document.body).css("overflow", "hidden") : $(window.parent.document.body).css("overflow", "hidden");
            {
                var a = e.dg(e.fjId), b = e.dg(e.panlId), c = e.dg(e.showleftId), d = e.getWidth();
                e.getHeight() - 50
            }
            b.width(d), e.getEment("js_mask_zhezhao_div") ? $("#js_mask_zhezhao_div").show() : (top.location != location && $(window.parent.document.body).append('<div id="js_mask_zhezhao_div" class="fw_mask" style="display:block;"></div>'), $(document.body).append('<div id="js_mask_zhezhao_div" class="fw_mask" style="display:block;z-index:1000;"></div>')), a.css({
                width: d,
                height: e.getHeight()
            }).show(), e.imgMaxH = e.getClientHeight() - e.footheight, c.css({
                height: e.imgMaxH + "px",
                "line-height": e.imgMaxH + "px"
            }), e.dg(e.imgsPanlId).width(d), e.loadAllimgs();
            var f = e.datas.imgs[e.datas.ckindex];
            e.loadChecked(f)
        },
        checkImg: function (a) {
            $("#js_sf_fullScreen").hide(), e.dg("js_no_see_file").remove();
            var b = e.getEment(e.ckImgId), c = e.getDownUrl(a);
            e.getEment(e.ckFileId) && e.dg(e.ckFileId).hide(), e.dg("js_loading").show(), e.dg("fj_file_editdiv").hide(), e.dg("fj_img_editdiv").show();
            var d = e.getMiddleimg(a.FilePath), f = e.getBigimg(a.FilePath);
            if (b) {
                e.narrowImg(), b.style.display = "none", b.src = d;
                var g = e.getEment(e.bigckImgId).src;
                e.getEment(e.bigckImgId).src = e.getBigimg(a.FilePath), $(b).attr("rotation", "0").attr("angle", "0").css({
                    "max-height": e.imgMaxH,
                    "max-width": e.imgMaxW
                })
            } else {
                var h = '<span><img id="' + e.ckImgId + '" src="' + d + '" rotation="0" angle="0" style="max-height:' + e.imgMaxH + "px;max-width:" + e.imgMaxW + 'px;" class="fj_show_img hide" /><img id="' + e.bigckImgId + '" src="' + f + '" style="max-width:' + e.imgMaxW + 'px; display: none;" class="fj_show_img" /></span>', i = e.dg(e.showleftId);
                i.append(h), b = e.getEment(e.ckImgId)
            }
            e.dg(e.imgsPanlId).find(".down_link").attr("href", c), g && g.indexOf(f) >= 0 && (e.dg("js_loading").hide(), b.style.display = "inline-block"), b.onload = function () {
                b.style.display = "inline-block", e.dg("js_loading").hide()
            }, a.CreaterID == i8_session.uid && 0 == a.DocTreeID ? e.dg(e.imgsPanlId).find(".fj_file_guidang").show().text("归档到企业文档").attr("docname", a.FileName).attr("docid", a.ID) : a.CreaterID == i8_session.uid && 0 != a.DocTreeID ? e.dg(e.imgsPanlId).find(".fj_file_guidang").show().text("已归档").attr("docname", a.FileName).attr("docid", a.ID) : e.dg(e.imgsPanlId).find(".fj_file_guidang").hide()
        },
        checkFile: function (a) {
            $("#js_sf_fullScreen").show();
            var b = e.getDownUrl(a), c = e.getEment(e.ckFileId);
            e.getEment(e.ckImgId) && (e.dg(e.ckImgId).hide(), e.dg(e.bigckImgId).hide());
            var d = e.dg("js_loading");
            d.hide(), e.dg("fj_img_editdiv").hide(), e.dg("fj_file_editdiv").show(), e.dg(e.imgsPanlId).find(".down_link").attr("href", b);
            var f = RegExp("rar|zip");
            if (f.test(a.Extension))return e.dg("js_loading").hide(), e.dg(e.ckFileId).hide(), e.getEment("js_no_see_file") || (e.dg(e.showleftId).append("<div id='js_no_see_file' style='background:#fff; font-size:14px; color: red;'>该文件不支持在线阅读，<span class='down_file' target='_blank' >请下载查看</span></div>"), e.dg(e.imgsPanlId).find(".down_file").attr("href", b)), e.dg(e.imgsPanlId).find(".down_file").attr("href", b), a.CreaterID == i8_session.uid && 0 == a.DocTreeID ? e.dg(e.imgsPanlId).find(".fj_file_guidang").show().text("归档到企业文档").attr("docname", a.FileName).attr("docid", a.ID) : a.CreaterID == i8_session.uid && 0 != a.DocTreeID ? e.dg(e.imgsPanlId).find(".fj_file_guidang").show().text("已归档").attr("docname", a.FileName).attr("docid", a.ID) : e.dg(e.imgsPanlId).find(".fj_file_guidang").hide(), !1;
            e.dg("js_no_see_file").remove();
            var g = a.FilePath;
            if (g = e.getViewUrl(a), c)e.dg(e.ckFileId).hide(), e.getEment(e.ckFileId).src = g; else {
                var h = e.dg(e.showleftId), i = (h.height() > 450 ? h.height() : 450, '<iframe id="' + e.ckFileId + '" class="hide" style=" margin:15px auto;background-color:#fff" frameborder="0" src="' + g + '" width="' + e.fileW + '" height="' + e.fileH + '"></iframe>');
                h.append(i), c = e.getEment(e.ckFileId)
            }
            c.style.display = "block", e.dg(e.imgsPanlId).find(".down_file").attr("href", b), a.CreaterID == i8_session.uid && 0 == a.DocTreeID ? e.dg(e.imgsPanlId).find(".fj_file_guidang").show().text("归档到企业文档").attr("docname", a.FileName).attr("docid", a.ID) : a.CreaterID == i8_session.uid && 0 != a.DocTreeID ? e.dg(e.imgsPanlId).find(".fj_file_guidang").show().text("已归档").attr("docname", a.FileName).attr("docid", a.ID) : e.dg(e.imgsPanlId).find(".fj_file_guidang").hide()
        },
        loadToDiv: function (a, b, c) {
            var c = c || e.ckFileId;
            if (a.type = g.getTypestr(a.Extension), "img" == a.type)return $(b).addClass("isnot-doc"), '<img src="' + a.FilePath + "&imageView2/2/w/" + $(b).width() + '">';
            var d = a.FilePath;
            d = e.getViewUrl(a);
            var f = "", h = (e.getDownUrl(a), RegExp("rar|zip"));
            return h.test(a.Extension.toLowerCase()) ? ($(b).addClass("isnot-doc"), f = '<ul class="filelist" style="background:#fff; display: block;width: 180px;margin: 0 auto; font-size:14px; color: red;"><li style="width: 180px; margin-left: 0px;"><p class="imgWrap" style="margin-left: 30px;"><span class="i8files-ico-' + a.Extension.toLowerCase() + '"></span></p><p class="ft14 m-t20 blue bold">' + a.FileName + '</p><p class="black ft12 bold m-t10">此格式不支持预览</p></li></ul>') : ($(b).removeClass("isnot-doc"), f = '<iframe id="' + c + '"  style=" margin:15px auto;background-color:#fff" frameborder="0" src="' + d + '" width="' + $(b).width() + '" height="' + $(b).height() + '"></iframe>'), f
        },
        loadChecked: function (a) {
            e.datas.imgs.length <= 0 && e.close(), "img" == g.getTypestr(a.Extension) ? e.checkImg(a) : e.checkFile(a);
            var b = e.dg(e.imgsPanlId).find("li.fj_small_li");
            b.removeClass("current"), $(b[e.datas.ckindex]).addClass("current")
        },
        loadAllimgs: function () {
            var a = e.dg(e.imgsPanlId), b = a.find("ul"), c = "";
            if (e.datas.imgs) {
                for (var d = 0; d < e.datas.imgs.length; d++) {
                    var f = e.datas.imgs[d], h = "", i = e.getSmallimg(f.FilePath);
                    "file" == g.getTypestr(f.Extension) && (i = e.fileBgUrl + f.Extension.replace(".", "") + ".png"), e.datas.ckindex == d && (h = "current"), c += '<li class="fj_small_li ' + h + '"><a style="line-height:0px"><img src="' + i + '"></a></li>'
                }
                b.html(c).width(90 * e.datas.imgs.length), a.animate({bottom: 0}, 500)
            }
            e.bindImgclick()
        },
        guidang: function (b) {
            var c = b;
            if ("已归档" == c.text())return !1;
            var d = e.datas.imgs[e.datas.ckindex], f = a("../document/common"), g = c.attr("docid"), h = c.attr("docname");
            h = h.substr(0, h.lastIndexOf(".")), f.page.btn_guidang_ev_file(null, null, h, g, function () {
                var a = $("[docid=" + d.ID + "]").parents(".kk_files_panl");
                0 == a.length && (a = $("#" + d.ID).parents(".kk_files_panl")), e.updateData(g, a), c.text("已归档"), $(".btn-place-on-file[docid=" + g + "]").replaceWith('<a class="btn-has-place-on-file" href="javascript:void(0)">已归档</a>')
            })
        },
        updateData: function (a, b) {
            if (b && 0 == b.length)return !1;
            var c = b.attr("data-arrs");
            c = $.parseJSON(c);
            for (var e in c)c[e].ID == a && (c[e].DocTreeID = 999999999999);
            c = d.toJsonString(c), b.attr("data-arrs", c)
        },
        setAngle: function (a, b, c) {
            var d = navigator.appName, f = navigator.appVersion, g = f.split(";"), h = g[1] ? g[1].replace(/[ ]/g, "") : g[0].replace(/[ ]/g, ""), i = e.imgMaxW, j = e.imgMaxH;
            if (e.dg(e.bigckImgId).hide(), e.dg(e.ckImgId).show(), "Microsoft Internet Explorer" != d || "MSIE7.0" != h && "MSIE7.0" != h) {
                var k = parseInt(a.attr("angle")) + b;
                (k / 90 % 2 == 1 || k / 90 % 2 == -1) && (i = e.imgMaxH, j = e.imgMaxW);
                var l = "0.5s";
                e.dg(e.panlId).css("overflow", "hidden"), a.css({
                    transform: "rotate(" + k + "deg)",
                    "-ms-transform": "rotate(" + k + "deg)",
                    "-webkit-transform": "rotate(" + k + "deg)",
                    "-o-transform": "rotate(" + k + "deg)",
                    "-moz-transform": "rotate(" + k + "deg)",
                    transition: "transform " + l,
                    "-ms-transition": "-ms-transform " + l,
                    "-webkit-transition": "-webkit-transform " + l,
                    "-o-transition": "-o-transform " + l,
                    "-moz-transition": "-moz-transform " + l,
                    "max-width": i,
                    "max-height": j
                }).attr("angle", k)
            } else {
                var m = parseInt(a.attr("rotation")) + c;
                m > 3 && (m = 0), 0 > m && (m = 3), (m % 2 == 1 || m % 2 == -1) && (i = e.imgMaxH, j = e.imgMaxW), a[0].style.filter = "progid:DXImageTransform.Microsoft.BasicImage(rotation=" + m + ")", a.attr("rotation", m).css({
                    "max-width": i,
                    "max-height": j
                })
            }
        },
        narrowImg: function () {
            e.getEment(e.ckImgId).style.filter && (e.getEment(e.ckImgId).style.filter = "progid:DXImageTransform.Microsoft.BasicImage(rotation=0)");
            var a = 0, b = "0.5s";
            e.dg(e.panlId).css("overflow", "hidden"), e.dg(e.ckImgId).css({
                transform: "rotate(" + a + "deg)",
                "-ms-transform": "rotate(" + a + "deg)",
                "-webkit-transform": "rotate(" + a + "deg)",
                "-o-transform": "rotate(" + a + "deg)",
                "-moz-transform": "rotate(" + a + "deg)",
                transition: "transform " + b,
                "-ms-transition": "-ms-transform " + b,
                "-webkit-transition": "-webkit-transform " + b,
                "-o-transition": "-o-transform " + b,
                "-moz-transition": "-moz-transform " + b,
                "max-width": e.imgMaxW,
                "max-height": e.imgMaxH
            }).attr("angle", a), e.dg(e.bigckImgId).hide(), e.dg(e.ckImgId).attr("angle", "0").attr("rotation", "0"), e.dg(e.showleftId).css("overflow", "hidden"), e.dg(e.imgsPanlId).find("a.upimg_size").removeClass("fj3_1").html("放大")
        },
        bindImgclick: function () {
            e.dg(e.showleftId).unbind().mousemove(function (a) {
                var b = $(this), c = b.offset().left, d = (b.offset().top, b.outerWidth()), a = a || window.event, f = a.clientX || a.pageX;
                f - c > d / 2 ? e.datas.ckindex >= e.datas.imgs.length - 1 ? b.css("cursor", "default") : b.css("cursor", "url(" + e.nextImg + "),auto") : 0 == e.datas.ckindex ? b.css("cursor", "default") : b.css("cursor", "url(" + e.prevImg + "),auto")
            }), e.dg(e.showleftId).click(function (a) {
                var b = $(this), c = b.offset().left, d = (b.offset().top, b.outerWidth()), f = window.event || a || window.parent.event, g = f.clientX || f.pageX;
                return g - c > d / 2 ? e.datas.ckindex++ : e.datas.ckindex--, e.datas.ckindex < 0 ? (e.datas.ckindex = 0, !1) : e.datas.ckindex >= e.datas.imgs.length ? void(e.datas.ckindex = e.datas.imgs.length - 1) : void e.loadChecked(e.datas.imgs[e.datas.ckindex])
            }), e.dg(e.closeId).click(function () {
                e.close()
            }), e.dg(e.fullScreenId).click(function () {
                e.fullScreen()
            }), e.dg(e.imgsPanlId).delegate("ul", "click", function () {
                return !1
            }), e.dg(e.imgsPanlId).delegate(".upimg_size", "click", function () {
                var a = $.trim($(this).text());
                "放大" == a && (e.dg(e.ckImgId).hide(), e.dg(e.bigckImgId).show(), e.dg(e.showleftId).css("overflow", "auto"), $(this).html("缩小").addClass("fj3_1")), "缩小" == a && (e.dg(e.bigckImgId).hide(), e.dg(e.ckImgId).show(), e.dg(e.showleftId).css("overflow", "hidden"), $(this).html("放大").removeClass("fj3_1"))
            }), e.dg(e.imgsPanlId).delegate(".upimg_angle", "click", function () {
                "none" == e.getEment(e.ckImgId).style.display && e.narrowImg(), "向右转" == $(this).text() ? e.setAngle(e.dg(e.ckImgId), 90, 1) : e.setAngle(e.dg(e.ckImgId), -90, -1)
            }), e.dg(e.imgsPanlId).delegate("li.fj_small_li", "click", function () {
                var a = e.dg(e.imgsPanlId).find("li.fj_small_li"), b = a.index($(this));
                e.datas.ckindex = b, e.loadChecked(e.datas.imgs[b])
            }), e.dg(e.imgsPanlId).find(".fj_file_guidang").click(function () {
                var a = $(this);
                return e.guidang(a), !1
            }), e.dg(e.fjId).delegate(".down_file", "click", function () {
                window.open($(this).attr("href"))
            }), e.dg(e.fjId).delegate(".del_file", "click", function () {
                var a = e.dg(e.imgsPanlId).find(".current"), b = a.index();
                e.datas.imgs.splice(b, 1);
                var c = e.datas.imgs[e.datas.ckindex];
                a.remove(), e.loadChecked(c)
            })
        },
        close: function () {
            e.dg(e.fjId).remove(), e.dg(e.fullScreenId).remove(), e.dg("js_mask_zhezhao_div").hide(), top.location == location ? $(document.body).css("overflow", "auto") : ($(window.parent.document.body).css("overflow", "auto"), $("#js_mask_zhezhao_div").hide())
        },
        fullScreen: function () {
            e.dg("js_sf_id").toggleClass("full_iframe"), e.dg(e.fullScreenId).toggleClass("full")
        }
    }, f = {
        sortFiles: function (a) {
            var b = [];
            a = a || [];
            for (var c = 0; c < a.length; c++) {
                var d = a[c];
                "img" == g.getTypestr(d.Extension) && b.push(d)
            }
            for (var c = 0; c < a.length; c++) {
                var d = a[c];
                "file" == g.getTypestr(d.Extension) && b.push(d)
            }
            for (var c = 0; c < a.length; c++) {
                var d = a[c];
                "amr" == g.getTypestr(d.Extension) && b.push(d)
            }
            return b
        }
    }, g = {
        className: "kk_files_panl", get80x80Img: function (a, b, c, d) {
            if (!a)return "";
            var e = a.split("?")[0];
            return e + "?imageView2/" + (d || 1) + "/w/" + b + "/h/" + c
        }, getQiniuImg: function (a, b) {
            if (!a)return "";
            var c = a.split("?")[0];
            return c + "?imageMogr2/thumbnail/355/crop/!355x215a0a" + (b || 0)
        }, getCementImgLi: function (a, b, c, d) {
            return c % 2 == 1 && 0 == b ? '<li docid="' + a.ID + '" class="kks_option_li cememt-file-img doc-options big oflow" id="' + a.ID + '" zindex="' + b + '"><img src="' + g.get80x80Img(a.FilePath, 705, 400) + '" /></li>' : '<li docid="' + a.ID + '" class="kks_option_li cememt-file-img doc-options oflow" id="' + a.ID + '" zindex="' + b + '"><img src="' + g.getQiniuImg(a.FilePath, d) + '" /></li>'
        }, bindImgClick: function (b, d, f) {
            var g = b;
            g.on("click", ".doc-options", function () {
                var a = $(this), b = a.parents("li"), c = b.attr("isload"), d = a.parents(".kks_op_ulimgs").length > 0;
                if (!f || c || d) {
                    var g = {};
                    g.ckindex = $(this).attr("zindex");
                    var h = $(this).parents(".kk_files_panl");
                    g.imgs = $.parseJSON(h.attr("data-arrs")), g.Dom = h, e.begin(g)
                } else f.getFile(b.attr("docid"), function (c) {
                    if ($.type(c) && c.ReturnObject) {
                        b.attr("isload", !0);
                        var d = c.ReturnObject, f = d.indexOf("?u"), g = d.substr(f, d.length - f), h = b.find(".kks-down-a"), i = h.attr("href"), j = i.indexOf("&attname=");
                        h.attr("href", i.substr(0, j) + encodeURIComponent(g) + i.substr(j, i.length));
                        var k = {};
                        k.ckindex = a.attr("zindex");
                        var l = a.parents(".kk_files_panl"), m = l.attr("data-arrs"), m = m.replace(/FilePath(([\S\s]+?))\"\,/gim, function (a) {
                            return a.indexOf("?u") >= 0 ? a : a.substr(0, a.length - 2) + g + '",'
                        });
                        l.attr("data-arrs", m), k.imgs = $.parseJSON(m), k.Dom = l, e.begin(k)
                    }
                });
                return !1
            }), g.on("click", ".kks-down-a", function () {
                var a = $(this), b = a.parents("li"), c = b.attr("isload"), d = a.parents(".kks_op_ulimgs").length > 0;
                return !f || c || d ? window.open(this.getAttribute("href")) : f.getFile(b.attr("docid"), function (c) {
                    if ($.type(c) && c.ReturnObject) {
                        b.attr("isload", !0);
                        var d = c.ReturnObject, e = d.indexOf("?u"), f = d.substr(e, d.length - e), g = b.find(".kks-down-a"), h = g.attr("href"), i = h.indexOf("&attname="), j = a.parents(".kk_files_panl"), k = j.attr("data-arrs"), k = k.replace(/FilePath(([\S\s]+?))\"\,/gim, function (a) {
                            return a.indexOf("?u") >= 0 ? a : a.substr(0, a.length - 2) + f + '",'
                        });
                        j.attr("data-arrs", k);
                        var h = h.substr(0, i) + encodeURIComponent(f) + h.substr(i, h.length);
                        g.attr("href", h), window.open(h)
                    }
                }), !1
            }), g.on("click", ".btn-place-on-file", function () {
                var b = $(this), c = b.parents(".kk_files_panl"), d = a("../document/common"), f = b.attr("docid"), g = b.attr("docname");
                return g = g.substr(0, g.lastIndexOf(".")), 0 == $(".new-folder-cont").length && d.page.btn_guidang_ev_file(null, null, g, f, function () {
                    b.replaceWith('<a class="btn-has-place-on-file" href="javascript:void(0)">已归档</a>'), e.updateData(f, c)
                }), !1
            }), d && g.delegate(".del-down-a", "click", function () {
                var a = $(this).parents(".file-li"), b = $(this);
                return c.confirm({title: "确定要删除吗？", btnDom: b}, function () {
                    var b = a.attr("id");
                    d(b), a.remove()
                }), !1
            })
        }, bindDetialClick: function (a, b) {
            var c = a;
            c.on("click", ".detial-big-img,.doc-options", function () {
                var a = {};
                a.ckindex = $(this).attr("zindex");
                var b = $(this).parents(".kk_files_panl");
                return a.imgs = $.parseJSON(b.attr("data-arrs")), a.Dom = b, e.begin(a), !1
            }), c.on("click", ".detial-file-img", function () {
                var a = $(this), b = a.parent().find("li.detial-big-img");
                b.attr("zindex", a.attr("zindex")), b.attr("id", a.attr("sid"));
                var c = a.find("img").attr("src");
                return a.parent().find("li").removeClass("current"), a.addClass("current"), b.find("img").attr("src", g.get80x80Img(c, 690, 350)), !1
            }), c.delegate(".kks-down-a", "click", function () {
                return window.open(this.getAttribute("href")), !1
            }), b && c.delegate(".del-down-a", "click", function () {
                $(this).parents(".kks_option_li"), $(this);
                return !1
            })
        }, getTypestr: function (a) {
            a = a.toLocaleLowerCase();
            var b = RegExp(/(jpg)|(png)|(gif)|(jpeg)/), c = RegExp(/(doc)|(docx)|(txt)|(xls)|(xlsx)|(pdf)|(pdfx)|(rar)|(zip)|(ppt)|(pptx)/), d = RegExp(/(amr)|(mp3)|(\.amr)/);
            return b.test(a) ? "img" : c.test(a) ? "file" : d.test(a) ? "amr" : ""
        }, getHtml: function (a, b, c, f) {
            var c = c || 290, g = '<ul class="att_ulfile">';
            if (!a)return "";
            for (var h = 0; h < a.length; h++) {
                var i = a[h], j = "none", k = h % 3 == 0 ? " margin-left:0 " : "", l = e.getDownUrl(i);
                console.log(i), (i.Creator == i8_session.uid && b || i.CreaterID == i8_session.uid && b) && (j = "inline-block");
                var m = "", n = "", o = "20px";
                i.CreaterID == i8_session.uid && 0 != i.DocTreeID ? m = '<a class="btn-has-place-on-file" href="javascript:void(0)">已归档</a>' : i.CreaterID == i8_session.uid && 0 == i.DocTreeID && (m = '<a class="btn-place-on-file" docname="' + i.FileName + '" docid="' + i.ID + '" href="javascript:void(0)">归档</a>'), f && (n = '<span class="create-info">' + new Date(i.CreateTime.replace(/-/g, "/")).format("yyyy/MM/dd hh:mm") + " " + i.CreaterName + "</span>", o = "160px"), g += '<li style="' + k + ";padding-right:" + o + ';" docid="' + i.ID + '" class="file-li oflow" id="' + i.ID + '">                            <span style="max-width:' + c + 'px;" docid="' + i.ID + '" title="' + i.FileName + '" class="filename-span doc-options m-l10" zindex="' + h + '">' + i.FileName + '</span>                                <div class="rt m-r10"><a class="doc-options" zindex="' + h + '" href="javascript:void(0)">查看</a>                                <a class="kks-down-a attfile-down" href="' + l + '">下载</a>                            <a class="del-down-a" style="display: ' + j + ';">删除</a>' + m + "</div>" + n + "                            </li>"
            }
            g += "</ul>";
            var p = d.toJsonString(a);
            return '<div class="' + this.className + "\" data-arrs='" + p + "'>" + g + "</div>"
        }, getHtmlFW: function (a, b, c) {
            for (var c = c || 320, f = '<ul class="att_ulfile">', g = 0; g < a.length; g++) {
                var h = a[g], i = "none", j = g % 3 == 0 ? " margin-left:0 " : "", k = e.getDownUrl(h);
                h.Creator == i8_session.uid && b && (i = "inline");
                var l = "";
                h.CreaterID == i8_session.uid && 0 != h.DocTreeID ? l = '<a class="btn-has-place-on-file" href="javascript:void(0)">已归档</a>' : h.CreaterID == i8_session.uid && 0 == h.DocTreeID && (l = '<a class="btn-place-on-file" docname="' + h.FileName + '" docid="' + h.ID + '" href="javascript:void(0)">归档</a>'), f += '<li style="' + j + ' ;padding-right:0px;" docid="' + h.ID + '" class=" oflow" id="' + h.ID + '">                            <span style="max-width:' + c + 'px;" docid="' + h.ID + '" title="' + h.FileName + '" class="filename-span kks_option_li m-l10" zindex="' + g + '">' + h.FileName + '</span>                                <div class="rt m-r10">                                <span class="" style="vertical-align: -2px;margin-right: 20px;">' + h.CreaterName + " " + new Date(h.CreateTime.replace(/-/g, "/")).format("yyyy/MM/dd hh:mm") + '</span>                                <a class="doc-options" style="float: none;" zindex="' + g + '" href="javascript:void(0)">查看</a>                                <a class="kks-down-a attfile-down" href="' + k + '">下载</a>' + l + '</div>                            <a class="del-down-a" style="margin-left:10px; display: ' + i + ';"></a>                            </li>'
            }
            f += "</ul>";
            var m = d.toJsonString(a);
            return '<div class="' + this.className + "\" data-arrs='" + m + "'>" + f + "</div>"
        }, getHtmlKK: function (a, b, c) {
            var h = '<ul class="kks_op_ulimgs">', i = '<ul class="kks_op_ulfiles">', j = "";
            a = f.sortFiles(a);
            for (var k = 0; k < a.length; k++) {
                var l = a[k], m = "none", n = k % 3 == 0 ? " margin-left:0 " : "", o = e.getDownUrl(l);
                if (l.Creator == i8_session.uid && b && (m = "inline"), "img" == g.getTypestr(l.Extension) && (h += c ? g.getCementImgLi(l, k, a.length) : '<li docid="' + l.ID + '" class="kks_option_li see-img-li doc-options oflow" id="' + l.ID + '" zindex="' + k + '"><img style="width:80px;height:80px;" src="' + g.get80x80Img(l.FilePath, 80, 80) + '" /></li>'), "file" == g.getTypestr(l.Extension)) {
                    var p = "";
                    l.CreaterID == i8_session.uid && 0 != l.DocTreeID ? p = '<a class="btn-has-place-on-file" href="javascript:void(0)">已归档</a>' : l.CreaterID == i8_session.uid && 0 == l.DocTreeID && (p = '<a class="btn-place-on-file" docname="' + l.FileName + '" docid="' + l.ID + '" href="javascript:void(0)">归档</a>'), i += '<li style="' + n + '" docid="' + l.ID + '" class="kks_option_li oflow" id="' + l.ID + '"><span class="kks_op_file_bg filesicons doc-options i8files-ico-' + l.Extension + '" zindex="' + k + '"></span><div class="kks_op_file_info"><p class="attfile-name doc-options" title="' + l.FileName + '" zindex="' + k + '">' + l.FileName + '</p><div><a href="users/' + l.CreaterID + '" style="color:#999;">' + (l.CreatorName || l.CreaterName) + '</a></div><div><span style="color:#999;">' + l.CreateTime + '</span></div><p><a class="doc-options" zindex="' + k + '" href="javascript:void(0)">查看</a><a class="kks-down-a attfile-down" href="' + o + '">下载</a>' + p + '<a class="del-down-a" style="margin-left:10px; display: ' + m + ';"></a></p></div></li>'
                }
            }
            h += "</ul>", i += "</ul>";
            var q = d.toJsonString(a);
            return '<div class="' + this.className + "\" data-arrs='" + q + "'>" + h + i + j + "</div>"
        }, getHtmlIM: function (a, b, c) {
            var h = '<ul class="kks_op_ulimgs">', i = '<ul class="kks_op_ulfiles">', j = "";
            a = f.sortFiles(a);
            for (var k = 0; k < a.length; k++) {
                var l = a[k], m = "none", n = k % 3 == 0 ? " margin-left:0 " : "", o = e.getDownUrl(l);
                if (l.Creator == i8_session.uid && b && (m = "inline"), "img" == g.getTypestr(l.Extension) && (h += c ? g.getCementImgLi(l, k, a.length) : '<li docid="' + l.ID + '" class="kks_option_li see-img-li doc-options oflow" id="' + l.ID + '" zindex="' + k + '"><img style="width:80px;height:80px;" src="' + g.get80x80Img(l.FilePath, 80, 80) + '" /></li>'), "file" == g.getTypestr(l.Extension)) {
                    var p = "";
                    i += '<li style="' + n + '" docid="' + l.ID + '" class="kks_option_li oflow" id="' + l.ID + '"><span class="kks_op_file_bg filesicons doc-options i8files-ico-' + l.Extension + '" zindex="' + k + '"></span><div class="kks_op_file_info"><p class="attfile-name doc-options" title="' + l.FileName + '" zindex="' + k + '">' + l.FileName + '</p><div><a href="users/' + l.CreaterID + '" style="color:#999;">' + (l.CreatorName || l.CreaterName) + '</a></div><div><span style="color:#999;">' + l.DateTime + '</span></div><p><a class="doc-options" zindex="' + k + '" href="javascript:void(0)">查看</a><a class="kks-down-a attfile-down" href="' + o + '">下载</a>' + p + '<a class="del-down-a" style="margin-left:10px; display: ' + m + ';"></a></p></div></li>'
                }
            }
            h += "</ul>", i += "</ul>";
            var q = d.toJsonString(a);
            return '<div class="' + this.className + "\" data-arrs='" + q + "'>" + h + i + j + "</div>"
        }, getSimpleHtml: function (a) {
            var b = "", c = "", h = "";
            a = f.sortFiles(a);
            for (var i = 0; i < a.length; i++) {
                {
                    var j = a[i];
                    e.getDownUrl(j)
                }
                if ("img" == g.getTypestr(j.Extension) && (b += '<span docid="' + j.ID + '" class="doc-options oflow m-l10" id="' + j.ID + '" zindex="' + i + '">' + j.FileName + "</span>"), "file" == g.getTypestr(j.Extension)) {
                    c += '<span docid="' + j.ID + '" class="doc-options m-l10" zindex="' + i + '">' + j.FileName + "</span>"
                }
            }
            var k = d.toJsonString(a);
            return '<span class="' + this.className + " blue\" data-arrs='" + k + "'>" + b + c + h + "</span>"
        }, getCementHtml: function (a, b) {
            var c = '<ul class="kks_op_ulimgs">', h = '<ul class="att_ulfile">', i = "", j = 0, k = "", l = "", m = "20px", n = n || 290;
            a = f.sortFiles(a);
            for (var o = 0; o < a.length; o++) {
                var p = a[o], q = "none", r = o % 3 == 0 ? " margin-left:0 " : "", s = e.getDownUrl(p);
                if (p.Creator == i8_session.uid && isDel && (q = "inline"), "img" == g.getTypestr(p.Extension) && (c += g.getCementImgLi(p, o, j, b[p.ID])), "file" == g.getTypestr(p.Extension)) {
                    var k = "";
                    p.CreaterID == i8_session.uid && 0 != p.DocTreeID ? k = '<a class="btn-has-place-on-file" href="javascript:void(0)">已归档</a>' : p.CreaterID == i8_session.uid && 0 == p.DocTreeID && (k = '<a class="btn-place-on-file" docname="' + p.FileName + '" docid="' + p.ID + '" href="javascript:void(0)">归档</a>'), h += '<li style="' + r + ";padding-right:" + m + ';" docid="' + p.ID + '" class="file-li oflow" id="' + p.ID + '">                            <span style="max-width:' + n + 'px;" docid="' + p.ID + '" title="' + p.FileName + '" class="filename-span doc-options m-l10" zindex="' + o + '">' + p.FileName + '</span>                                <a class="doc-options" zindex="' + o + '" href="javascript:void(0)">查看</a>                                <a class="kks-down-a attfile-down" href="' + s + '">下载</a>                            ' + k + l + "                            </li>"
                }
            }
            c += "</ul>", h += "</ul>";
            var t = d.toJsonString(a);
            return '<div class="' + this.className + "\" data-arrs='" + t + "'>" + c + h + i + "</div>"
        }, getDetialHtml: function (a) {
            var b = '<ul class="kks_op_ulimgs">', c = '<ul class="kks_op_ulfiles">', h = "";
            a = f.sortFiles(a);
            for (var i = 0; i < a.length; i++) {
                var j = a[i], k = "none", l = i % 3 == 0 ? " margin-left:0 " : "", m = e.getDownUrl(j);
                if (j.Creator == i8_session.uid && isDel && (k = "inline"), "img" == g.getTypestr(j.Extension)) {
                    var n = "";
                    0 == i && (n = "current", b += '<li docid="' + j.ID + '" class="kks_option_li detial-big-img oflow" id="' + j.ID + '" zindex="' + i + '"><span><img src="' + g.get80x80Img(j.FilePath, 690, 350) + '" /></span>'), b += '<li docid="' + j.ID + '" docid="' + j.ID + '" class="kks_option_li detial-file-img oflow ' + n + '" sid="' + j.ID + '" zindex="' + i + '"><img src="' + g.get80x80Img(j.FilePath, 100, 100) + '" />'
                }
                "file" == g.getTypestr(j.Extension) && (c += '<li style="' + l + '" class="kks_option_li oflow" id="' + j.ID + '" zindex="' + i + '"><span class="kks_op_file_bg filesicons i8files-ico-' + j.Extension + '"></span><div class="kks_op_file_info"><p class="attfile-name">' + j.FileName + '</p><div><span style="color:#999;">' + (j.CreatorName || j.CreaterName) + '</span></div><div><span style="color:#999;">' + j.CreateTime + '</span></div><p><a class="doc-options" zindex="' + i + '">查看</a><a class="kks-down-a attfile-down" href="' + m + '">下载</a><a class="del-down-a" style="margin-left:10px; display: ' + k + ';"></a></p></div></li>')
            }
            b += "</ul>", c += "</ul>";
            var o = d.toJsonString(a);
            return '<div class="' + this.className + "\" data-arrs='" + o + "'>" + b + c + h + "</div>"
        }, getDocHtml: function (a) {
            var b = '<ul class="kks_op_ulimgs">', c = '<ul class="kks_op_ulfiles">', h = "";
            a = f.sortFiles(a);
            for (var i = 0; i < a.length; i++) {
                var j = a[i], k = "none", l = i % 3 == 0 ? " margin-left:0 " : "", m = "", n = e.getDownUrl(j);
                j.showDel && (k = "inline-block"), j.CreaterID == i8_session.uid && 0 != j.DocTreeID ? m = '<a class="btn-has-place-on-file" href="javascript:void(0)">已归档</a>' : j.CreaterID == i8_session.uid && 0 == j.DocTreeID && (m = '<a class="btn-place-on-file" docname="' + j.FileName + '" docid="' + j.ID + '" href="javascript:void(0)">归档</a>'), "img" == g.getTypestr(j.Extension) && (c += '<li docid="' + j.ID + '" style="' + l + '" class="kks_option_li oflow" id="' + j.ID + '"><img class="lt filesicons doc-options" style="margin:10px;margin-top:13px;height:75px;width:75px;" src="' + g.get80x80Img(j.FilePath, 75, 75) + '" zindex="' + i + '" /><div class="kks_op_file_info"><p class="attfile-name doc-options" title="' + j.FileName + '" zindex="' + i + '">' + j.FileName + '</p><div><a class="createname" href="users/' + j.CreaterID + '" style="color:#999;">' + (j.CreatorName || j.CreaterName) + '</a></div><div><span class="createtime" style="color:#999;">' + j.CreateTime + '</span></div><p><a class="doc-options options-line" zindex="' + i + '" href="javascript:void(0)">查看</a><a class="kks-down-a attfile-down" href="' + n + '">下载</a><a class="del-down-a" style="margin-left:10px; display: ' + k + ';">删除</a>' + m + "</p></div></li>"), "file" == g.getTypestr(j.Extension) && (c += '<li docid="' + j.ID + '" style="' + l + '" class="kks_option_li oflow" id="' + j.ID + '"><span class="kks_op_file_bg filesicons doc-options i8files-ico-' + j.Extension + '" zindex="' + i + '"></span><div class="kks_op_file_info"><p class="attfile-name doc-options" title="' + j.FileName + '" zindex="' + i + '">' + j.FileName + '</p><div><a class="createname" href="users/' + j.CreaterID + '" style="color:#999;">' + (j.CreatorName || j.CreaterName) + '</a></div><div><span class="createtime" style="color:#999;">' + j.CreateTime + '</span></div><p><a class="doc-options options-line" zindex="' + i + '" href="javascript:void(0)">查看</a><a class="kks-down-a attfile-down" href="' + n + '">下载</a><a class="del-down-a" style="margin-left:10px; display: ' + k + ';">删除</a>' + m + "</p></div></li>")
            }
            b += "</ul>", c += "</ul>";
            var o = d.toJsonString(a);
            return '<div class="' + this.className + "\" data-arrs='" + o + "'>" + b + c + h + "</div>"
        }
    };
    window.viewFiles = function (a) {
        e.beginByUrl(a)
    }, b.sf = e, b.ks = g
}), define("default/javascripts/common/fw_pagination", [], function (a, b) {
    $.PaginationCalculator = function (a, b) {
        this.maxentries = a, this.opts = b
    }, $.extend($.PaginationCalculator.prototype, {
        numPages: function () {
            return Math.ceil(this.maxentries / this.opts.items_per_page)
        }, getInterval: function (a) {
            var b = Math.floor(this.opts.num_display_entries / 2), c = this.numPages(), d = c - this.opts.num_display_entries, e = a > b ? Math.max(Math.min(a - b, d), 0) : 0, f = a > b ? Math.min(a + b + this.opts.num_display_entries % 2, c) : Math.min(this.opts.num_display_entries, c);
            return {start: e, end: f}
        }
    }), $.PaginationRenderers = {}, $.PaginationRenderers.defaultRenderer = function (a, b) {
        this.maxentries = a, this.opts = b, this.pc = new $.PaginationCalculator(a, b)
    }, $.extend($.PaginationRenderers.defaultRenderer.prototype, {
        createLink: function (a, b, c) {
            var d, e = this.pc.numPages();
            return a = 0 > a ? 0 : e > a ? a : e - 1, c = $.extend({
                text: a + 1,
                classes: ""
            }, c || {}), d = a == b ? $("<a isend='" + (c.end || !1) + "' class='" + (c.current_cls || "selected") + "'>" + c.text + "</a>") : $("<a isend='" + (c.end || !1) + "'>" + c.text + "</a>").attr("href", this.opts.link_to.replace(/__id__/, a)), c.classes && d.addClass(c.classes), d.data("page_id", a), d
        }, appendRange: function (a, b, c, d, e) {
            var f;
            for (f = c; d > f; f++) {
                var e = $.extend(e, {end: f == d - 1});
                this.createLink(f, b, e).appendTo(a)
            }
        }, getLinks: function (a, b, c) {
            var d, e, f = this.pc.getInterval(a), g = this.pc.numPages(), h = $("<div class='" + (c || "pagination") + "'></div>");
            return this.opts.prev_text && (a > 0 || this.opts.prev_show_always) && h.append(this.createLink(a - 1, a, {
                text: this.opts.prev_text,
                classes: "prev",
                current_cls: this.opts.prev_current_cls
            })), f.start > 0 && this.opts.num_edge_entries > 0 && (e = Math.min(this.opts.num_edge_entries, f.start), this.appendRange(h, a, 0, e, {classes: "sp"}), this.opts.num_edge_entries < f.start && this.opts.ellipse_text && jQuery("<span>" + this.opts.ellipse_text + "</span>").appendTo(h)), this.appendRange(h, a, f.start, f.end), f.end < g && this.opts.num_edge_entries > 0 && (g - this.opts.num_edge_entries > f.end && this.opts.ellipse_text && jQuery("<span>" + this.opts.ellipse_text + "</span>").appendTo(h), d = Math.max(g - this.opts.num_edge_entries, f.end), this.appendRange(h, a, d, g, {classes: "ep"})), this.opts.next_text && (g - 1 > a || this.opts.next_show_always) && h.append(this.createLink(a + 1, a, {
                text: this.opts.next_text,
                classes: "next",
                current_cls: this.opts.next_current_cls
            })), this.opts.jump && (this.opts.jump.text = this.opts.jump.text || "go", jQuery('<input type="text" class="jumpnum" /><a class="jumpbtn">' + this.opts.jump.text + "</a>").appendTo(h)), $("a", h).click(b), h
        }
    }), $.fn.pagination = function (a, b) {
        function c(a) {
            var b = $(a.target), c = b.data("page_id");
            if (isNaN(c) && (c = b.prev("input").val() - 1), c >= 0 && i - 1 >= c) {
                var e = d(c);
                return e || a.stopPropagation(), e
            }
        }

        function d(a) {
            h.data("current_page", a), f = e.getLinks(a, c, b.cls), h.empty(), f.appendTo(h);
            var d = b.callback(a + 1, h);
            return d
        }

        b = jQuery.extend({
            items_per_page: 10,
            num_display_entries: 11,
            current_page: 1,
            num_edge_entries: 0,
            link_to: "javascript:void(0)",
            prev_text: "prev",
            next_text: "next",
            ellipse_text: "...",
            prev_show_always: !0,
            next_show_always: !0,
            renderer: "defaultRenderer",
            cls: "pagination",
            callback: function () {
                return !1
            }
        }, b || {}), --b.current_page;
        var e, f, g, h = this, i = Math.ceil(a / b.items_per_page);
        if (g = b.current_page, h.data("current_page", g), a = !a || 0 > a ? 1 : a, b.items_per_page = !b.items_per_page || b.items_per_page < 0 ? 1 : b.items_per_page, !$.PaginationRenderers[b.renderer])throw new ReferenceError("Pagination renderer '" + b.renderer + "' was not found in jQuery.PaginationRenderers object.");
        e = new $.PaginationRenderers[b.renderer](a, b);
        var j = new $.PaginationCalculator(a, b), k = j.numPages();
        h.bind("setPage", {numPages: k}, function (a, b) {
            return b >= 0 && b < a.data.numPages ? (d(b), !1) : void 0
        }), h.bind("prevPage", function () {
            var a = $(this).data("current_page");
            return a > 0 && d(a - 1), !1
        }), h.bind("nextPage", {numPages: k}, function (a) {
            var b = $(this).data("current_page");
            return b < a.data.numPages - 1 && d(b + 1), !1
        }), f = e.getLinks(g, c, b.cls), h.empty(), f.appendTo(h)
    }, b.pagination = function (a) {
        return a && a.totalPageCount && a.pageSize ? void(a.totalPageCount > a.pageSize ? jQuery(a.ctr).pagination(a.totalPageCount, {
            callback: a.fun,
            prev_text: "<",
            next_text: ">",
            items_per_page: a.pageSize,
            num_display_entries: a.num_edge_entries || 3,
            current_page: a.current,
            num_edge_entries: 1,
            cls: "cutepage",
            prev_current_cls: "disabled",
            next_current_cls: "disabled",
            jump: a.jump || !1
        }) : $(a.ctr).html("")) : !1
    }
});
var $dp, WdatePicker;
!function () {
    function a() {
        try {
            o[v], o.$dp = o.$dp || {}
        } catch (a) {
            o = t, $dp = $dp || {}
        }
        var c = {
            win: t, $: function (a) {
                return "string" == typeof a ? t[v].getElementById(a) : a
            }, $D: function (a, b) {
                return this.$DV(this.$(a).value, b)
            }, $DV: function (a, b) {
                if ("" != a) {
                    if (this.dt = $dp.cal.splitDate(a, $dp.cal.dateFmt), b)for (var c in b)if (void 0 === this.dt[c])this.errMsg = "invalid property:" + c; else if (this.dt[c] += b[c], "M" == c) {
                        var d = b.M > 0 ? 1 : 0, e = new Date(this.dt.y, this.dt.M, 0).getDate();
                        this.dt.d = Math.min(e + d, this.dt.d)
                    }
                    if (this.dt.refresh())return this.dt
                }
                return ""
            }, show: function () {
                for (var a = o[v].getElementsByTagName("div"), b = 1e5, c = 0; c < a.length; c++) {
                    var d = parseInt(a[c].style.zIndex);
                    d > b && (b = d)
                }
                this.dd.style.zIndex = b + 2, l(this.dd, "block")
            }, hide: function () {
                l(this.dd, "none")
            }, attachEvent: b
        };
        for (var d in c)o.$dp[d] = c[d];
        $dp = o.$dp
    }

    function b(a, b, c) {
        if (q)a.attachEvent(b, c); else if (c) {
            var d = b.replace(/on/, "");
            c._ieEmuEventHandler = function (a) {
                return c(a)
            }, a.addEventListener(d, c._ieEmuEventHandler, !1)
        }
    }

    function c() {
        for (var a, b, c = t[v][x]("script"), d = 0; d < c.length && (a = c[d].getAttribute("src") || "", a = a.substr(0, a.toLowerCase().indexOf("wdatepicker.js")), b = a.lastIndexOf("/"), b > 0 && (a = a.substring(0, b + 1)), !a); d++);
        return a
    }

    function d(a) {
        a = a || o;
        for (var b = 0, c = 0; a != o;) {
            for (var d = a.parent[v][x]("iframe"), f = 0; f < d.length; f++)try {
                if (d[f].contentWindow == a) {
                    var g = e(d[f]);
                    b += g.left, c += g.top;
                    break
                }
            } catch (h) {
            }
            a = a.parent
        }
        return {leftM: b, topM: c}
    }

    function e(a) {
        if (a.getBoundingClientRect)return a.getBoundingClientRect();
        var b = {
            ROOT_TAG: /^body|html$/i,
            OP_SCROLL: /^(?:inline|table-row)$/i
        }, c = !1, d = null, e = a.offsetTop, f = a.offsetLeft, h = a.offsetWidth, i = a.offsetHeight, j = a.offsetParent;
        if (j != a)for (; j;)f += j.offsetLeft, e += j.offsetTop, "fixed" == k(j, "position").toLowerCase() ? c = !0 : "body" == j.tagName.toLowerCase() && (d = j.ownerDocument.defaultView), j = j.offsetParent;
        for (j = a.parentNode; j.tagName && !b.ROOT_TAG.test(j.tagName);)(j.scrollTop || j.scrollLeft) && (b.OP_SCROLL.test(l(j)) || s && "visible" === j.style.overflow || (f -= j.scrollLeft, e -= j.scrollTop)), j = j.parentNode;
        if (!c) {
            var m = g(d);
            f -= m.left, e -= m.top
        }
        return h += f, i += e, {left: f, top: e, right: h, bottom: i}
    }

    function f(a) {
        a = a || o;
        var b = a[v], c = a.innerWidth ? a.innerWidth : b[w] && b[w].clientWidth ? b[w].clientWidth : b.body.offsetWidth, d = a.innerHeight ? a.innerHeight : b[w] && b[w].clientHeight ? b[w].clientHeight : b.body.offsetHeight;
        return {width: c, height: d}
    }

    function g(a) {
        a = a || o;
        var b = a[v], c = b[w], d = b.body;
        return b = c && null != c.scrollTop && (c.scrollTop > d.scrollTop || c.scrollLeft > d.scrollLeft) ? c : d, {
            top: b.scrollTop,
            left: b.scrollLeft
        }
    }

    function h(a) {
        try {
            var b = a ? a.srcElement || a.target : null;
            $dp.cal && !$dp.eCont && $dp.dd && b != $dp.el && "block" == $dp.dd.style.display && $dp.cal.close()
        } catch (a) {
        }
    }

    function i() {
        $dp.status = 2
    }

    function j(c, d) {
        function e() {
            return q && o != t && "complete" != o[v].readyState ? !1 : !0
        }

        function f() {
            if (r) {
                for (func = f.caller; null != func;) {
                    var a = func.arguments[0];
                    if (a && (a + "").indexOf("Event") >= 0)return a;
                    func = func.caller
                }
                return null
            }
            return event
        }

        if ($dp) {
            a(), c = c || {};
            for (var g in n)"$" != g.substring(0, 1) && void 0 === c[g] && (c[g] = n[g]);
            if (d) {
                if (!e())return void(A = A || setInterval(function () {
                        "complete" == o[v].readyState && clearInterval(A), j(null, !0)
                    }, 50));
                if (0 != $dp.status)return;
                $dp.status = 1, c.el = u, m(c, !0)
            } else if (c.eCont)c.eCont = $dp.$(c.eCont), c.el = u, c.autoPickDate = !0, c.qsEnabled = !1, m(c); else {
                if (n.$preLoad && 2 != $dp.status)return;
                var h = f();
                if ((t.event === h || h) && (c.srcEl = h.srcElement || h.target, h.cancelBubble = !0), c.el = c.el = $dp.$(c.el || c.srcEl), !c.el || c.el.My97Mark === !0 || c.el.disabled || $dp.dd && "none" != l($dp.dd) && "-970px" != $dp.dd.style.left) {
                    try {
                        c.el.My97Mark && (c.el.My97Mark = !1)
                    } catch (i) {
                    }
                    return
                }
                if (h && 1 == c.el.nodeType && void 0 === c.el.My97Mark) {
                    "focus" == h.type ? b(c.el, "onclick", function () {
                        j(c)
                    }) : b(c.el, "onfocus", function () {
                        j(c)
                    })
                }
                m(c)
            }
        }
    }

    function k(a, b) {
        return a.currentStyle ? a.currentStyle[b] : document.defaultView.getComputedStyle(a, !1)[b]
    }

    function l(a, b) {
        if (a) {
            if (null == b)return k(a, "display");
            a.style.display = b
        }
    }

    function m(a, b) {
        function c(a, b) {
            var c = t[v].domain, d = !1;
            a.innerHTML = '<iframe hideFocus=true width=9 height=7 frameborder=0 border=0 scrolling=no src="about:blank"></iframe>';
            var e, f = (n.$langList, n.$skinList);
            try {
                e = a.lastChild.contentWindow[v]
            } catch (g) {
                d = !0, a.lastChild.src = "javascript:void((function(){document.open();document.domain='" + c + "';})())", e = a.lastChild.contentWindow[v]
            }
            var j = b.getRealLang();
            a.lang = j.name, a.skin = b.skin;
            var k = ["<head><script>", "", "var $d, $dp, $cfg=document.cfg, $pdp = parent.$dp, $dt, $tdt, $sdt, $lastInput, $IE=$pdp.ie, $FF = $pdp.ff,$OPERA=$pdp.opera, $ny, $cMark = false;", "if($cfg.eCont){$dp = {};for(var p in $pdp)$dp[p]=$pdp[p];}else{$dp=$pdp;};for(var p in $cfg){$dp[p]=$cfg[p];}", "document.oncontextmenu=function(){try{$c._fillQS(!$dp.has.d,1);showB($d.qsDivSel);}catch(e){};return false;};", "</script><script src=", p, "", j.name, ".js charset=", j.charset, "></script>"];
            d && (k[1] = 'document.domain="' + c + '";');
            for (var l = 0; l < f.length; l++)f[l].name == b.skin && k.push('<link rel="stylesheet" type="text/css" href="' + p + '../../stylesheets/datepicker.css" charset="' + f[l].charset + '"/>');
            k.push('<script type="text/javascript" src="' + p + 'calendar.js?"+Math.random()+""></script>'), k.push('</head><body leftmargin="0" topmargin="0" tabindex=0></body></html>'), k.push("<script>var t;t=t||setInterval(function(){if(document.ready){new My97DP();$cfg.onload();$c.autoSize();$cfg.setPos($dp);clearInterval(t);}},20);</script>"), b.setPos = h, b.onload = i, e.write("<html>"), e.cfg = b, e.write(k.join("")), e.close()
        }

        function h(a) {
            var b = a.position.left, c = a.position.top, h = a.el;
            if (h != u) {
                h == a.srcEl || "none" != l(h) && "hidden" != h.type || (h = a.srcEl);
                var i = e(h), j = d(t), k = f(o), m = g(o), n = $dp.dd.offsetHeight, p = $dp.dd.offsetWidth;
                if (isNaN(c) && (c = 0), j.topM + i.bottom + n > k.height && j.topM + i.top - n > 0)c += m.top + j.topM + i.top - n - 2; else {
                    c += m.top + j.topM + i.bottom;
                    var r = c - m.top + n - k.height;
                    r > 0 && (c -= r)
                }
                isNaN(b) && (b = 0), b += m.left + Math.min(j.leftM + i.left, k.width - p - 5) - (q ? 2 : 0), a.dd.style.top = c + "px", a.dd.style.left = b + "px"
            }
        }

        var j = a.el ? a.el.nodeName : "INPUT";
        if (b || a.eCont || new RegExp(/input|textarea|div|span|p|a/gi).test(j)) {
            if (a.elProp = "INPUT" == j ? "value" : "innerHTML", "auto" == a.lang && (a.lang = q ? navigator.browserLanguage.toLowerCase() : navigator.language.toLowerCase()), !a.eCont)for (var k in a)$dp[k] = a[k];
            !$dp.dd || a.eCont || $dp.dd && (a.getRealLang().name != $dp.dd.lang || a.skin != $dp.dd.skin) ? a.eCont ? c(a.eCont, a) : ($dp.dd = o[v].createElement("DIV"), $dp.dd.style.cssText = "position:absolute", o[v].body.appendChild($dp.dd), c($dp.dd, a), b ? $dp.dd.style.left = $dp.dd.style.top = "-970px" : ($dp.show(), h($dp))) : $dp.cal && ($dp.show(), $dp.cal.init(), $dp.eCont || h($dp))
        }
    }

    var n = {
        $langList: [{name: "en", charset: "UTF-8"}, {name: "zh-cn", charset: "UTF-8"}, {
            name: "zh-tw",
            charset: "UTF-8"
        }],
        $skinList: [{name: "default", charset: "gb2312"}, {name: "whyGreen", charset: "gb2312"}, {
            name: "blue",
            charset: "gb2312"
        }, {name: "ext", charset: "gb2312"}, {name: "twoer", charset: "gb2312"}],
        $wdate: !0,
        $crossFrame: !0,
        $preLoad: !1,
        $dpPath: i8_session.resHost + "default/javascripts/common/",
        doubleCalendar: !1,
        enableKeyboard: !0,
        enableInputMask: !0,
        autoUpdateOnChanged: null,
        weekMethod: "ISO8601",
        position: {},
        lang: "zh-cn",
        skin: "default",
        dateFmt: "yyyy-MM-dd",
        realDateFmt: "yyyy-MM-dd",
        realTimeFmt: "HH:mm:ss",
        realFullFmt: "%Date %Time",
        minDate: "1900-01-01 00:00:00",
        maxDate: "2099-12-31 23:59:59",
        startDate: "",
        alwaysUseStartDate: !1,
        yearOffset: 1911,
        firstDayOfWeek: 0,
        isShowWeek: !1,
        highLineWeekDay: !0,
        isShowClear: !0,
        isShowToday: !0,
        isShowOK: !0,
        isShowOthers: !0,
        readOnly: !1,
        errDealMode: 0,
        autoPickDate: null,
        qsEnabled: !0,
        autoShowQS: !1,
        specialDates: null,
        specialDays: null,
        disabledDates: null,
        disabledDays: null,
        opposite: !1,
        onpicking: null,
        onpicked: null,
        onclearing: null,
        oncleared: null,
        ychanging: null,
        ychanged: null,
        Mchanging: null,
        Mchanged: null,
        dchanging: null,
        dchanged: null,
        Hchanging: null,
        Hchanged: null,
        mchanging: null,
        mchanged: null,
        schanging: null,
        schanged: null,
        eCont: null,
        vel: null,
        elProp: "",
        errMsg: "",
        quickSel: [],
        has: {},
        getRealLang: function () {
            for (var a = n.$langList, b = 0; b < a.length; b++)if (a[b].name == this.lang)return a[b];
            return a[0]
        }
    };
    WdatePicker = j;
    var o, p, q, r, s, t = window, u = {innerHTML: ""}, v = "document", w = "documentElement", x = "getElementsByTagName", y = navigator.appName;
    if ("Microsoft Internet Explorer" == y ? q = !0 : "Opera" == y ? s = !0 : r = !0, p = n.$dpPath || c(), n.$wdate, o = t, n.$crossFrame)try {
        for (; o.parent != o && 0 == o.parent[v][x]("frameset").length;)o = o.parent
    } catch (z) {
    }
    o.$dp || (o.$dp = {
        ff: r,
        ie: q,
        opera: s,
        status: 0,
        defMinDate: n.minDate,
        defMaxDate: n.maxDate
    }), a(), n.$preLoad && 0 == $dp.status && b(t, "onload", function () {
        j(null, !0)
    }), t[v].docMD || (b(t[v], "onmousedown", h), t[v].docMD = !0), o[v].docMD || (b(o[v], "onmousedown", h), o[v].docMD = !0), b(t, "onunload", function () {
        $dp.dd && l($dp.dd, "none")
    });
    var A
}(), "object" != typeof JSON && (JSON = {}), function () {
    function f(a) {
        return 10 > a ? "0" + a : a
    }

    function this_value() {
        return this.valueOf()
    }

    function quote(a) {
        return rx_escapable.lastIndex = 0, rx_escapable.test(a) ? '"' + a.replace(rx_escapable, function (a) {
            var b = meta[a];
            return "string" == typeof b ? b : "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4)
        }) + '"' : '"' + a + '"'
    }

    function str(a, b) {
        var c, d, e, f, g, h = gap, i = b[a];
        switch (i && "object" == typeof i && "function" == typeof i.toJSON && (i = i.toJSON(a)), "function" == typeof rep && (i = rep.call(b, a, i)), typeof i) {
            case"string":
                return quote(i);
            case"number":
                return isFinite(i) ? String(i) : "null";
            case"boolean":
            case"null":
                return String(i);
            case"object":
                if (!i)return "null";
                if (gap += indent, g = [], "[object Array]" === Object.prototype.toString.apply(i)) {
                    for (f = i.length, c = 0; f > c; c += 1)g[c] = str(c, i) || "null";
                    return e = 0 === g.length ? "[]" : gap ? "[\n" + gap + g.join(",\n" + gap) + "\n" + h + "]" : "[" + g.join(",") + "]", gap = h, e
                }
                if (rep && "object" == typeof rep)for (f = rep.length, c = 0; f > c; c += 1)"string" == typeof rep[c] && (d = rep[c], e = str(d, i), e && g.push(quote(d) + (gap ? ": " : ":") + e)); else for (d in i)Object.prototype.hasOwnProperty.call(i, d) && (e = str(d, i), e && g.push(quote(d) + (gap ? ": " : ":") + e));
                return e = 0 === g.length ? "{}" : gap ? "{\n" + gap + g.join(",\n" + gap) + "\n" + h + "}" : "{" + g.join(",") + "}", gap = h, e
        }
    }

    var rx_one = /^[\],:{}\s]*$/, rx_two = /\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, rx_three = /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, rx_four = /(?:^|:|,)(?:\s*\[)+/g, rx_escapable = /[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, rx_dangerous = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
    "function" != typeof Date.prototype.toJSON && (Date.prototype.toJSON = function () {
        return isFinite(this.valueOf()) ? this.getUTCFullYear() + "-" + f(this.getUTCMonth() + 1) + "-" + f(this.getUTCDate()) + "T" + f(this.getUTCHours()) + ":" + f(this.getUTCMinutes()) + ":" + f(this.getUTCSeconds()) + "Z" : null
    }, Boolean.prototype.toJSON = this_value, Number.prototype.toJSON = this_value, String.prototype.toJSON = this_value);
    var gap, indent, meta, rep;
    "function" != typeof JSON.stringify && (meta = {
        "\b": "\\b",
        "	": "\\t",
        "\n": "\\n",
        "\f": "\\f",
        "\r": "\\r",
        '"': '\\"',
        "\\": "\\\\"
    }, JSON.stringify = function (a, b, c) {
        var d;
        if (gap = "", indent = "", "number" == typeof c)for (d = 0; c > d; d += 1)indent += " "; else"string" == typeof c && (indent = c);
        if (rep = b, b && "function" != typeof b && ("object" != typeof b || "number" != typeof b.length))throw new Error("JSON.stringify");
        return str("", {"": a})
    }), "function" != typeof JSON.parse && (JSON.parse = function (text, reviver) {
        function walk(a, b) {
            var c, d, e = a[b];
            if (e && "object" == typeof e)for (c in e)Object.prototype.hasOwnProperty.call(e, c) && (d = walk(e, c), void 0 !== d ? e[c] = d : delete e[c]);
            return reviver.call(a, b, e)
        }

        var j;
        if (text = String(text), rx_dangerous.lastIndex = 0, rx_dangerous.test(text) && (text = text.replace(rx_dangerous, function (a) {
                return "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4)
            })), rx_one.test(text.replace(rx_two, "@").replace(rx_three, "]").replace(rx_four, "")))return j = eval("(" + text + ")"), "function" == typeof reviver ? walk({"": j}, "") : j;
        throw new SyntaxError("JSON.parse")
    })
}();